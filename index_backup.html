<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VHT Automation â€“ Arrivals &amp; Departures v5</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      background: #f5f5f8;
      color: #222;
    }
    .screen-only { display: block; }
    .print-only { display: none; }
    .app-header {
      padding: 18px 20px 20px;
      background: #ffffff;
      border-bottom: 1px solid #e0e0e0;
      color: #002b45;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
    }
    .top-toolbar {
      position: absolute;
      top: 18px;
      right: 20px;
    }
    .top-toolbar .btn {
      margin: 0;
    }
    .app-header small {
      font-size: 12px;
      opacity: 0.9;
    }
    .vht-header-logo {
      max-width: 180px;
      max-height: 90px;
      display: block;
      margin: 0 auto 8px auto;
    }

    .header-title {
      font-size: 24px;
      font-weight: 700;
      text-align: center;
      color: #002b45;
      margin: 0 0 4px 0;
      letter-spacing: 0.5px;
    }

    .header-subtitle {
      font-size: 15px;
      font-weight: 400;
      text-align: center;
      color: #444444;
      margin: 0 0 6px 0;
      letter-spacing: 0.4px;
    }
    .app-container {
      display: flex;
      height: calc(100vh - 52px);
    }
    .sidebar {
      width: 320px;
      border-right: 1px solid #ddd;
      background: #fff;
      padding: 14px;
      overflow-y: auto;
    }
    .sidebar h2 {
      font-size: 16px;
      margin: 0 0 8px;
    }
    .sidebar-section-title {
      font-size: 13px;
      font-weight: 600;
      margin: 14px 0 4px;
      color: #333;
    }
    .itinerary-selector-box {
      margin: 0 0 16px 0;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      background-color: #f8f9fa;
    }
    .itinerary-selector-box h3 {
      font-size: 14px;
      font-weight: 600;
      margin: 0 0 10px 0;
      color: #333;
    }
    .itinerary-selector-box label {
      font-size: 12px;
      font-weight: 500;
      margin-bottom: 4px;
      display: block;
      color: #555;
    }
    .itinerary-selector-box select {
      width: 100%;
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 13px;
      margin-bottom: 8px;
      background-color: #fff;
    }
    /* ================== ADMIN ITINERARY HELPER ================== */
    /* ================== ADMIN ITINERARY HELPER (VHT) ================== */
    #itinerary-helper-panel {
      max-width: 100%;
      margin: 16px 0;
      padding: 16px 18px;
      border-radius: 14px;
      background: #ffffff;
      box-shadow: 0 4px 16px rgba(0,0,0,0.06);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      border: 1px solid #e5e7eb;
    }
    #itinerary-helper-panel h2 {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 17px;
      margin-bottom: 8px;
    }
    #itinerary-helper-panel p.description {
      margin: 0 0 12px;
      color: #4b5563;
      font-size: 13px;
    }
    .itinerary-badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }
    .itinerary-badge {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: #eef2ff;
      color: #3730a3;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .helper-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 14px;
    }
    .helper-card {
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 12px 14px;
      background: #f9fafb;
    }
    .helper-card h3 {
      margin: 0 0 4px;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .helper-card small {
      display: block;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #6b7280;
      margin-bottom: 6px;
    }
    .helper-card ul {
      margin: 0;
      padding-left: 18px;
      font-size: 12px;
      color: #4b5563;
    }
    .helper-card li {
      margin-bottom: 3px;
    }
    .helper-inline-note {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 12px;
      background: #ecfdf5;
      font-size: 12px;
      color: #166534;
      display: flex;
      gap: 8px;
      align-items: flex-start;
    }
    .helper-inline-note strong {
      font-weight: 600;
    }
    .helper-footer {
      margin-top: 12px;
      padding-top: 10px;
      border-top: 1px dashed #e5e7eb;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: space-between;
      align-items: center;
    }
    .helper-footer p {
      margin: 0;
      font-size: 11px;
      color: #6b7280;
    }
    .helper-footer span.badge {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px dashed #9ca3af;
      font-size: 10px;
      color: #4b5563;
    }
    details.helper-details {
      margin-top: 10px;
      border-radius: 10px;
      background: #f3f4f6;
      padding: 6px 10px;
      font-size: 11px;
    }
    details.helper-details summary {
      cursor: pointer;
      list-style: none;
    }
    details.helper-details summary::-webkit-details-marker {
      display: none;
    }
    details.helper-details summary span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    details.helper-details div {
      margin-top: 6px;
      color: #4b5563;
    }
    .field {
      margin-bottom: 8px;
      display: flex;
      flex-direction: column;
      font-size: 13px;
    }
    .field label {
      margin-bottom: 2px;
      font-weight: 500;
    }
    .field input,
    .field select,
    .field textarea {
      border-radius: 6px;
      border: 1px solid #ccc;
      padding: 6px 8px;
      font-size: 13px;
    }
    .field textarea {
      resize: vertical;
      min-height: 50px;
    }
    .two-cols {
      display: flex;
      gap: 8px;
    }
    .two-cols .field {
      flex: 1;
    }
    .btn {
      display: inline-block;
      padding: 8px 12px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      cursor: pointer;
      font-weight: 600;
    }
    .btn-primary {
      background: linear-gradient(135deg, #1363df, #47b5ff);
      color: #fff;
    }
    .btn-secondary {
      background: #eeeeee;
      color: #333;
      border: 1px solid #cccccc;
    }
    .btn-block {
      width: 100%;
      text-align: center;
      margin-top: 10px;
    }
    .small-hint {
      font-size: 11px;
      color: #777;
      margin-top: 4px;
    }
    .upload-container {
      margin-top: 16px;
      padding-top: 10px;
      border-top: 1px dashed #ccc;
    }
    .upload-container label {
      font-size: 12px;
      font-weight: 500;
    }
    .upload-container input {
      margin-top: 4px;
      font-size: 11px;
    }
    .main-content {
      flex: 1;
      padding: 14px;
      overflow-y: auto;
    }
    .brand-header {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 16px;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid #e0e0e0;
    }
    .brand-header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .brand-logo {
      height: 40px;
      width: auto;
    }
    .brand-title-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .brand-title {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.03em;
    }
    .brand-subtitle {
      font-size: 13px;
      color: #666666;
    }
    .trip-meta-card {
      margin: 8px 0 16px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #e5e5e5;
      background-color: #fafafa;
      font-size: 13px;
      line-height: 1.5;
    }
    .trip-meta-card strong,
    .trip-meta-card b {
      font-weight: 600;
    }
    /* Optional: make the main itinerary title a bit stronger */
    .itinerary-title, .trip-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 6px;
    }
    /* Optional: nicer spacing for day blocks on screen */
    .day-card,
    .itinerary-day,
    .day-block {
      border-radius: 8px;
      border: 1px solid #f0f0f0;
      padding: 10px 12px;
      margin-bottom: 12px;
      background-color: #ffffff;
    }
    .day-card h3,
    .itinerary-day h3,
    .day-block h3 {
      margin-top: 0;
      margin-bottom: 6px;
      font-size: 15px;
      font-weight: 600;
    }
    .day-location {
      font-style: italic;
      font-size: 12px;
      color: #666666;
      margin-bottom: 4px;
    }
    .section-label {
      font-weight: 600;
      font-size: 12px;
      margin-top: 6px;
      margin-bottom: 2px;
    }
    .itinerary-header {
      background: #fff;
      border-radius: 12px;
      padding: 12px 14px;
      margin-bottom: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06);
      font-size: 13px;
    }
    .itinerary-header h2 {
      margin: 0 0 6px;
      font-size: 16px;
    }
    .itinerary-header-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      font-size: 12px;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      padding: 3px 8px;
      border-radius: 999px;
      background: #eef4ff;
      color: #234;
      font-size: 11px;
      margin-right: 4px;
      margin-top: 2px;
    }
    .badge span {
      font-weight: 600;
      margin-right: 4px;
    }
    .day-card {
      background: #fff;
      border-radius: 12px;
      padding: 0 0 10px;
      margin-bottom: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06);
      border: 1px solid #e4e4e4;
    }
    .day-banner {
      border-radius: 12px 12px 0 0;
      padding: 10px 14px;
      background: linear-gradient(120deg, #ff9f1c, #ff5d68);
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .day-banner-main {
      font-size: 15px;
      font-weight: 600;
    }
    .day-banner-sub {
      font-size: 11px;
      opacity: 0.95;
    }
    .day-banner-date {
      font-size: 12px;
      font-weight: 500;
    }
    .day-content {
      padding: 10px 14px;
      font-size: 13px;
    }
    .day-section-title {
      font-size: 12px;
      font-weight: 600;
      margin: 8px 0 4px;
      color: #333;
    }
    .day-hotel-row {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 4px;
    }
    .star-rating {
      font-size: 12px;
      margin-left: 4px;
      color: #f5b301;
      white-space: nowrap;
    }
    .day-hotel-row select,
    .day-hotel-row input {
      font-size: 12px;
      padding: 4px 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .day-activity-row {
      margin-bottom: 8px;
    }
    .day-activity-row select {
      font-size: 11px;
      padding: 3px 6px;
      border-radius: 999px;
      border: 1px solid #ddd;
      margin-bottom: 4px;
    }
    .day-activity-row textarea {
      width: 100%;
      min-height: 60px;
      resize: vertical;
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    .transfer-label {
      font-size: 12px;
      font-weight: 600;
      margin: 8px 0 4px;
      color: #1363df;
    }
    .transfer-box {
      background: #f3f7ff;
      border-radius: 8px;
      border: 1px solid #d0e2ff;
      padding: 6px 8px;
      margin-bottom: 6px;
    }
    .transfer-box textarea {
      width: 100%;
      border: none;
      background: transparent;
      resize: vertical;
      font-size: 12px;
      padding: 0;
      outline: none;
    }
    .picture-gallery-footer {
      margin-top: 16px;
      padding-top: 12px;
      border-top: 2px solid #e5e7eb;
    }
    .picture-gallery-container {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      min-height: 120px;
      padding: 12px;
      background: #f9fafb;
      border: 2px dashed #cbd5e1;
      border-radius: 8px;
      position: relative;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .picture-gallery-container:hover {
      background: #f3f4f6;
      border-color: #9ca3af;
    }
    .picture-gallery-container.drag-over {
      background: #eff6ff;
      border-color: #3b82f6;
      border-style: solid;
    }
    .picture-gallery-item {
      flex: 1;
      min-width: 0;
      position: relative;
      border-radius: 6px;
      overflow: hidden;
      background: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      max-width: calc(33.333% - 6px);
      min-height: 120px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    .picture-gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .picture-gallery-item .remove-btn {
      position: absolute;
      top: 4px;
      right: 4px;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.2s;
    }
    .picture-gallery-item:hover .remove-btn {
      opacity: 1;
    }
    .picture-gallery-placeholder {
      display: flex;
      align-items: center;
      justify-content: center;
      color: #9ca3af;
      font-size: 12px;
      text-align: center;
      padding: 20px;
      flex: 1;
    }
    .picture-gallery-placeholder span {
      pointer-events: none;
    }
    details.picture-placeholder {
      margin-top: 8px;
      font-size: 12px;
    }
    details.picture-placeholder summary {
      cursor: pointer;
      font-weight: 500;
    }
    details.picture-placeholder textarea {
      width: 100%;
      min-height: 40px;
      margin-top: 4px;
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px dashed #bbb;
      resize: vertical;
    }
    .internal-notes {
      background: #fff7e6;
      border-radius: 12px;
      padding: 10px 14px;
      font-size: 12px;
      border: 1px dashed #ffb347;
      margin-bottom: 16px;
    }
    .internal-notes h3 {
      margin-top: 0;
      font-size: 13px;
      margin-bottom: 6px;
    }
    .internal-notes textarea {
      width: 100%;
      min-height: 60px;
      border-radius: 8px;
      border: 1px solid #f0c27b;
      padding: 6px 8px;
      font-size: 12px;
      resize: vertical;
      background: #fffdf7;
    }
    .warning-list {
      margin: 0;
      padding-left: 18px;
      font-size: 11px;
    }
    @media print {
      body {
        background: #ffffff !important;
        color: #000000 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        font-size: 11pt;
        line-height: 1.4;
      }

      /* Hide sidebar / input controls */
      .sidebar,
      .left-panel,
      .input-panel,
      .filters-panel {
        display: none !important;
      }

      /* Hide explicit no-print elements and generic buttons/toolbars */
      .no-print,
      button,
      .top-toolbar,
      .controls,
      .footer {
        display: none !important;
      }

      /* Hide admin helper on print / PDF */
      #itinerary-helper-panel,
      #itinerary-sidebar-helper {
        display: none !important;
      }
    }

    /* ========== FLOATING SIDEBAR HELPER FOR DAYS SELECTION ========== */
    #itinerary-sidebar-helper {
      position: fixed;
      right: 20px;
      bottom: 20px;
      width: 260px;
      max-width: 80vw;
      background: #111827;
      color: #e5e7eb;
      border-radius: 18px;
      padding: 14px 16px;
      box-shadow: 0 18px 45px rgba(15,23,42,0.5);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      z-index: 9999;
      display: none;
    }
    #itinerary-sidebar-helper h4 {
      margin: 0 0 4px;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    #itinerary-sidebar-helper p {
      margin: 0;
      font-size: 12px;
      line-height: 1.4;
    }
    #itinerary-sidebar-helper .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 11px;
      margin-top: 6px;
      background: rgba(55,65,81,0.8);
    }
    #itinerary-sidebar-helper button.helper-close {
      position: absolute;
      top: 6px;
      right: 8px;
      border: none;
      background: transparent;
      color: #9ca3af;
      cursor: pointer;
      font-size: 13px;
    }
    #itinerary-sidebar-helper button.helper-close:hover {
      color: #f9fafb;
    }

    @media print {
      /* Hide internal notes meant only for Lona */
      .internal-notes {
        display: none !important;
      }

      /* Hide technical labels that don't look good in client PDF */
      .location-label {
        display: none !important;
      }

      /* Keep brand header visible and nicely spaced */
      .brand-header {
        display: flex !important;
        border-bottom: 1px solid #cccccc;
        margin-bottom: 8mm;
        padding-bottom: 3mm;
      }

      .brand-title {
        font-size: 16pt !important;
      }

      .brand-subtitle {
        font-size: 9pt !important;
      }

      /* Trip meta card prints as a soft, subtle card */
      .trip-meta-card {
        border: 1px solid #dddddd !important;
        background-color: #f9f9f9 !important;
        padding: 6mm 6mm 5mm;
        margin: 0 0 8mm 0;
        page-break-inside: avoid;
      }

      /* Make itinerary area full width with nice margins for A4 */
      .itinerary-container,
      .itinerary-output,
      .main-content,
      #itineraryArea {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 0 12mm !important;
        box-shadow: none !important;
        border-radius: 0 !important;
        background: #ffffff !important;
      }

      .app-container {
        display: block;
        height: auto;
      }

      /* Day blocks: light frame + spacing and avoid splitting mid-day when possible */
      .day-card,
      .itinerary-day,
      .day-block {
        page-break-inside: avoid;
        margin-bottom: 8mm;
        border: 1px solid #e0e0e0;
        padding: 4mm 4mm 5mm;
        border-radius: 4px;
        background-color: #ffffff !important;
      }

      .day-card h3,
      .itinerary-day h3,
      .day-block h3 {
        font-size: 13pt !important;
        margin-bottom: 2mm;
      }

      .day-location {
        font-size: 10pt !important;
        font-style: italic;
        margin-bottom: 2mm;
      }

      .itinerary-header h2 {
        font-size: 13pt !important;
        font-weight: 600;
        margin-bottom: 3mm;
      }

      /* Textareas and selects: show content cleanly without heavy UI chrome */
      textarea {
        border: none !important;
        box-shadow: none !important;
        resize: none !important;
        background: transparent !important;
      }

      select {
        border: none !important;
        background: transparent !important;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
      }

      /* Hide screen-only elements */
      .screen-only {
        display: none !important;
      }

      /* Show print-only elements */
      .print-only {
        display: block !important;
      }

      /* Hide picture placeholders and details */
      details.picture-placeholder {
        display: none !important;
      }
      
      /* Show picture gallery in print */
      .picture-gallery-footer {
        page-break-inside: avoid;
        margin-top: 12px;
        padding-top: 8px;
        border-top: 1px solid #ddd;
      }
      .picture-gallery-container {
        display: flex;
        gap: 6px;
        min-height: 100px;
        border: 1px solid #ddd;
        background: #f9fafb;
      }
      .picture-gallery-item {
        max-width: calc(33.333% - 4px);
      }
      .picture-gallery-item .remove-btn {
        display: none;
      }
      .picture-gallery-placeholder {
        display: none;
      }

      /* Clean up itinerary header for print */
      .itinerary-header {
        margin-bottom: 8mm;
        padding-bottom: 3mm;
        border-bottom: 1px solid #cccccc;
      }

      /* Ensure day cards print nicely */
      .day-banner {
        page-break-after: avoid;
      }

      /* Hide the app header (top navigation) */
      .app-header {
        display: none !important;
      }
    }

    /* ===== Print toolbar ===== */
    .print-toolbar {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 10px;
    }

    .print-toolbar button {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #111827;
      color: #f9fafb;
      font-size: 13px;
      cursor: pointer;
    }

    .print-toolbar button:hover {
      background: #1f2937;
    }

    /* Hide the toolbar on the printed PDF */
    @media print {
      .print-toolbar {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="app-header">
    <img src="vht_logo.png" alt="VHT Vietnam Holiday Tours" class="vht-header-logo" />
    <div class="header-title">Vietnam Holiday Tours</div>
    <div class="header-subtitle">Itinerary proposal</div>
    <div class="top-toolbar no-print">
      <button id="printItineraryBtn" class="btn btn-primary">
        Print / Save as PDF
      </button>
    </div>
  </div>

  <div class="app-container">
    <div class="sidebar">
      <h2>Traveller Input</h2>

      <!-- BRIEF & FULL ITINERARY SELECTORS -->
      <div class="itinerary-selector-box">
        <h3>Select Pre-Defined Itinerary</h3>

        <label for="brief-itinerary-select">Brief Itineraries:</label>
        <select id="brief-itinerary-select">
          <option value="">Select brief itineraryâ€¦</option>
          <option value="4">4 Days</option>
          <option value="6">6 Days</option>
          <option value="8">8 Days</option>
          <option value="10">10 Days</option>
          <option value="12">12 Days</option>
          <option value="14">14 Days</option>
          <option value="16">16 Days</option>
          <option value="18">18 Days</option>
          <option value="20">20 Days</option>
          <option value="21">21 Days</option>
          <option value="22">22 Days</option>
          <option value="24">24 Days</option>
          <option value="26">26 Days</option>
          <option value="28">28 Days</option>
          <option value="30">30 Days</option>
        </select>

        <br><br>

        <label for="detailed-itinerary-select">Detailed Itineraries:</label>
        <select id="detailed-itinerary-select">
          <option value="">Select full detailed itineraryâ€¦</option>
          <option value="4">4 Days</option>
          <option value="6">6 Days</option>
          <option value="8">8 Days</option>
          <option value="10">10 Days</option>
          <option value="12">12 Days</option>
          <option value="14">14 Days</option>
          <option value="16">16 Days</option>
          <option value="18">18 Days</option>
          <option value="20">20 Days</option>
          <option value="21">21 Days</option>
          <option value="22">22 Days</option>
          <option value="24">24 Days</option>
          <option value="26">26 Days</option>
          <option value="28">28 Days</option>
          <option value="30">30 Days</option>
        </select>
      </div>

      <!-- ================== ADMIN ITINERARY HELPER ================== -->
      <section id="itinerary-helper-panel" class="no-print">
        <h2>ðŸ§­ Admin Guide â€“ Itinerary Length Helper</h2>
        <p class="description">
          Internal only â€“ helps you quickly choose the right tour length & template according to the
          number of days, pace and style. This section is not printed for clients.
        </p>

        <div class="itinerary-badges">
          <span class="itinerary-badge">4â€“14 days Â· Short / Medium</span>
          <span class="itinerary-badge">15â€“20 days Â· Extended</span>
          <span class="itinerary-badge">21â€“30 days Â· Full Vietnam</span>
        </div>

        <div class="helper-grid">
          <!-- Short & Medium -->
          <div class="helper-card">
            <small>4â€“14 days</small>
            <h3>ðŸŸ© Short & Medium Programs</h3>
            <ul>
              <li>Quick vacations & family trips</li>
              <li>Classic highlights (North / Central / South)</li>
              <li>Light adventure, simple logistics</li>
              <li>Few or no internal flights</li>
            </ul>
          </div>

          <!-- Extended -->
          <div class="helper-card">
            <small>15â€“20 days</small>
            <h3>ðŸŸ§ Extended Journeys</h3>
            <ul>
              <li>Deeper Vietnam experience without rush</li>
              <li>Balanced mix: cities, culture, nature</li>
              <li>Includes internal flights & longer transfers</li>
              <li>Great for first-time but curious travellers</li>
            </ul>
          </div>

          <!-- Long-haul -->
          <div class="helper-card">
            <small>21â€“30 days</small>
            <h3>ðŸŸ¦ Long-Haul / Full Vietnam</h3>
            <ul>
              <li>Full Vietnam South â‡„ North panorama</li>
              <li>Add Sapa / Ha Giang, Mai Chau, etc.</li>
              <li>Overnight cruise + mountains + Mekong</li>
              <li>Use your 21-day & 30-day master templates</li>
            </ul>
          </div>
        </div>

        <div class="helper-inline-note">
          <span>âœ…</span>
          <div>
            <strong>Workflow tip:</strong>  
            Generate the brief or detailed itinerary, then adjust hotels, transfers, and pace
            before sending PDF to the client. Long drives and early wake-ups should always be double-checked.
          </div>
        </div>

        <details class="helper-details">
          <summary>
            <span>ðŸ‡»ðŸ‡³ Xem tÃ³m táº¯t hÆ°á»›ng dáº«n nÃ y báº±ng tiáº¿ng Viá»‡t</span>
          </summary>
          <div>
            - 4â€“14 ngÃ y: chÆ°Æ¡ng trÃ¬nh ngáº¯n & trung bÃ¬nh, linh hoáº¡t, dá»… chá»‰nh.<br>
            - 15â€“20 ngÃ y: hÃ nh trÃ¬nh má»Ÿ rá»™ng, tráº£i nghiá»‡m sÃ¢u hÆ¡n nhÆ°ng váº«n thoáº£i mÃ¡i.<br>
            - 21â€“30 ngÃ y: tour dÃ i "xem gáº§n nhÆ° táº¥t cáº£" â€“ dÃ¹ng template 21 & 30 ngÃ y Ä‘á»ƒ chá»‰nh theo yÃªu cáº§u khÃ¡ch.
          </div>
        </details>

        <div class="helper-footer">
          <p>For Lona: use this as a quick compass before choosing the template.</p>
          <span class="badge">Admin only Â· Hidden on print / PDF</span>
        </div>
      </section>
      <!-- ================== END ADMIN ITINERARY HELPER ================== -->

      <div class="field">
        <label for="groupName">Name of travellers / group</label>
        <input id="groupName" type="text" placeholder="e.g. Cohen Family â€“ 4 pax" />
      </div>

      <div class="field">
        <label for="nationality">Nationality</label>
        <select id="nationality">
          <option value="">Selectâ€¦</option>
          <option>Israeli</option>
          <option>French</option>
          <option>American</option>
          <option>Canadian</option>
          <option>European (Mixed)</option>
          <option>Other</option>
        </select>
      </div>

      <div class="field">
        <label for="ageGroup">Age group</label>
        <select id="ageGroup">
          <option value="">Selectâ€¦</option>
          <option>Young adults (18â€“30)</option>
          <option>Mixed adults (30â€“55)</option>
          <option>Seniors (55+)</option>
          <option>Family with kids</option>
          <option>Multi-generation</option>
        </select>
      </div>

      <div class="two-cols">
        <div class="field">
          <label for="numDays">Number of days</label>
          <select id="numDays">
            <option value="1">1</option><option value="2">2</option><option value="3">3</option>
            <option value="4">4</option><option value="5">5</option><option value="6">6</option>
            <option value="7" selected>7</option><option value="8">8</option><option value="9">9</option>
            <option value="10">10</option><option value="11">11</option><option value="12">12</option>
            <option value="13">13</option><option value="14">14</option><option value="15">15</option>
            <option value="16">16</option><option value="17">17</option><option value="18">18</option>
          </select>
        </div>

        <div class="field">
          <label for="area">Area</label>
          <select id="area">
            <option value="">Selectâ€¦</option>
            <option>North Vietnam</option>
            <option>Central Vietnam</option>
            <option>South Vietnam</option>
            <option>Vietnam â€“ Country-wide</option>
            <option>Vietnam &amp; Cambodia</option>
          </select>
        </div>
      </div>

      <!-- Dates & times -->
      <div class="two-cols">
        <div class="field">
          <label for="startDate">Start date</label>
          <input id="startDate" type="date" />
          <label for="arrivalTime" style="margin-top:6px;">Arrival time</label>
          <input id="arrivalTime" type="time" />
          <div class="small-hint">Or write in Special requests, e.g. "Arrival 14:30".</div>
        </div>

        <div class="field">
          <label for="endDate">End date (auto)</label>
          <input id="endDate" type="date" disabled />
          <label for="departureTime" style="margin-top:6px;">Departure time</label>
          <input id="departureTime" type="time" />
          <div class="small-hint">Or write in Special requests, e.g. "Departure 23:55".</div>
        </div>
      </div>

      <div class="two-cols">
        <div class="field">
          <label for="startCity">Start city</label>
          <select id="startCity">
            <option>Ho Chi Minh City</option>
            <option>Hanoi</option>
            <option>Da Nang</option>
            <option>Hoi An</option>
            <option>Hue</option>
            <option>Ha Long Bay</option>
            <option>Ninh Binh</option>
            <option>Sapa</option>
            <option>Can Tho</option>
            <option>Phu Quoc</option>
            <option>Nha Trang</option>
            <option>Da Lat</option>
            <option>Mui Ne</option>
          </select>
        </div>
        <div class="field">
          <label for="endCity">End city</label>
          <select id="endCity">
            <option value="">Same as start</option>
            <option>Ho Chi Minh City</option>
            <option>Hanoi</option>
            <option>Da Nang</option>
            <option>Hoi An</option>
            <option>Hue</option>
            <option>Ha Long Bay</option>
            <option>Ninh Binh</option>
            <option>Sapa</option>
            <option>Can Tho</option>
            <option>Phu Quoc</option>
            <option>Nha Trang</option>
            <option>Da Lat</option>
            <option>Mui Ne</option>
          </select>
        </div>
      </div>

      <div class="field">
        <label for="tourType">Type of tour</label>
        <select id="tourType">
          <option value="">Selectâ€¦</option>
          <option>Private</option>
          <option>Backpacker</option>
          <option>Small group</option>
          <option>Large group</option>
          <option>Combined (group + private)</option>
        </select>
      </div>

      <div class="field">
        <label for="tourLevel">Level</label>
        <select id="tourLevel">
          <option value="">Selectâ€¦</option>
          <option>Easy</option>
          <option>Moderate</option>
          <option>Intensive</option>
          <option>Adventurous</option>
        </select>
      </div>

      <div class="field">
        <label for="hotelRating">Hotel rating</label>
        <select id="hotelRating">
          <option value="">Selectâ€¦</option>
          <option>Homestay</option>
          <option>3â˜…</option>
          <option>4â˜…</option>
          <option>5â˜…</option>
          <option>Luxury / Boutique</option>
          <option>Mixed (3â€“4â˜…)</option>
        </select>
      </div>

      <div class="field">
        <label for="foodPref">Food preferences</label>
        <select id="foodPref">
          <option value="">Selectâ€¦</option>
          <option>Everything â€“ standard local &amp; international</option>
          <option>Vegetarian</option>
          <option>Vegan</option>
          <option>Halal</option>
          <option>Kosher style (no pork/seafood, separate pans)</option>
        </select>
      </div>

      <div class="field">
        <label for="specialRequests">Special requests (shown to client)</label>
        <textarea id="specialRequests" placeholder='e.g. "Arrival 14:30, Departure 23:55", anniversary, mobility, must-see spotsâ€¦'></textarea>
      </div>

      <div class="sidebar-section-title">Additional internal info (for Lona only)</div>

      <div class="field">
        <label for="budgetHint">Budget level (rough)</label>
        <select id="budgetHint">
          <option value="">Optionalâ€¦</option>
          <option>Budget</option>
          <option>Mid-range</option>
          <option>High-end</option>
          <option>Luxury</option>
        </select>
      </div>

      <div class="field">
        <label for="paceHint">Pace preference comment</label>
        <input id="paceHint" type="text" placeholder="e.g. late mornings, nightlife, few hotel changes" />
      </div>

      <button class="btn btn-primary btn-block" id="generateBtn">Generate / Refresh Itinerary</button>
      <div class="small-hint">
        Edit each day (city, hotel, transfer, activities) after generation before sending to the client.
      </div>

      <div class="upload-container">
        <label for="templateUpload">Upload new itinerary templates (JSON)</label><br />
        <input id="templateUpload" type="file" accept=".json" />
        <div class="small-hint">
          This enriches hotels &amp; activities for each city.
        </div>
      </div>
    </div>

    <div class="main-content">
      <div id="itineraryArea"></div>
    </div>
  </div>

  <script>
    const CITY_OPTIONS = [
      "Ho Chi Minh City",
      "Hanoi",
      "Da Nang",
      "Hoi An",
      "Hue",
      "Ha Long Bay",
      "Ninh Binh",
      "Sapa",
      "Can Tho",
      "Phu Quoc",
      "Nha Trang",
      "Da Lat",
      "Mui Ne"
    ];

    // Hotel options with star ratings: {name: "Hotel Name", stars: 4}
    const HOTEL_OPTIONS = {
      "Ho Chi Minh City": [
        {name: "Liberty Central Saigon Riverside", stars: 4},
        {name: "Au Lac Charner Hotel", stars: 3},
        {name: "Hotel Nikko Saigon", stars: 5},
        {name: "Majestic Saigon Hotel", stars: 4},
        {name: "Rex Hotel Saigon", stars: 4},
        {name: "Caravelle Saigon", stars: 5},
        {name: "Park Hyatt Saigon", stars: 5},
        {name: "Silverland Jolie Hotel", stars: 4},
        {name: "Alagon D'antique Hotel & Spa", stars: 4},
        {name: "La Siesta Premium Saigon", stars: 4}
      ],
      "Hanoi": [
        {name: "La Siesta Classic Ma May", stars: 4},
        {name: "Hanoi Pearl Hotel", stars: 4},
        {name: "Apricot Hotel Hanoi", stars: 4},
        {name: "Sofitel Legend Metropole Hanoi", stars: 5},
        {name: "Peridot Grand Hotel & Spa", stars: 4},
        {name: "MK Premier Boutique Hotel", stars: 4},
        {name: "Hanoi La Siesta Trendy", stars: 4},
        {name: "Acoustic Hotel & Spa", stars: 4},
        {name: "Oriental Suite Hotel & Spa", stars: 4},
        {name: "The Oriental Jade Hotel", stars: 4}
      ],
      "Da Nang": [
        {name: "Brilliant Hotel Da Nang", stars: 4},
        {name: "Novotel Danang Premier Han River", stars: 5},
        {name: "Sala Da Nang Beach Hotel", stars: 4},
        {name: "Premier Village Danang Resort", stars: 5},
        {name: "TMS Hotel Da Nang Beach", stars: 4},
        {name: "A La Carte Da Nang Beach", stars: 4},
        {name: "Rosamia Da Nang Hotel", stars: 4},
        {name: "Grand Mercure Danang", stars: 5},
        {name: "Furama Resort Danang", stars: 5}
      ],
      "Hoi An": [
        {name: "Little Riverside Hoi An", stars: 4},
        {name: "Almanity Hoi An Resort & Spa", stars: 4},
        {name: "Ann Retreat Resort & Spa", stars: 4},
        {name: "La Siesta Hoi An Resort & Spa", stars: 4},
        {name: "Allegro Hoi An", stars: 4},
        {name: "Anantara Hoi An Resort", stars: 5},
        {name: "Lantana Riverside Hoi An", stars: 4},
        {name: "Victoria Hoi An Beach Resort & Spa", stars: 5},
        {name: "Vinh Hung Riverside Resort", stars: 4}
      ],
      "Hue": [
        {name: "Eldora Hotel Hue", stars: 4},
        {name: "Silk Path Grand Hue", stars: 5},
        {name: "Moonlight Hotel Hue", stars: 4},
        {name: "Saigon Morin Hotel", stars: 4},
        {name: "Imperial Hotel Hue", stars: 4},
        {name: "Pilgrimage Village Boutique Resort & Spa", stars: 4},
        {name: "Hotel La Perle", stars: 4},
        {name: "Huong Giang Hotel Resort & Spa", stars: 4}
      ],
      "Ha Long Bay": [
        {name: "Orchid Cruise Ha Long", stars: 5},
        {name: "Paradise Elegance Cruise", stars: 5},
        {name: "Bhaya Classic Cruise", stars: 4},
        {name: "Indochina Sails", stars: 4},
        {name: "Stellar of the Seas", stars: 5},
        {name: "Heritage Line Cruise", stars: 5},
        {name: "Peony Cruise", stars: 4},
        {name: "Alisa Premier Cruise", stars: 4}
      ],
      "Ninh Binh": [
        {name: "Tam Coc Garden Resort", stars: 4},
        {name: "Emeralda Resort Ninh Binh", stars: 4},
        {name: "Ninh Binh Hidden Charm Hotel", stars: 4},
        {name: "Tam Coc La Montagne Resort & Spa", stars: 4},
        {name: "Mua Caves Ecolodge", stars: 3},
        {name: "Tam Coc Rice Fields Resort", stars: 4}
      ],
      "Sapa": [
        {name: "Aira Boutique Sapa Hotel & Spa", stars: 4},
        {name: "Victoria Sapa Resort & Spa", stars: 4},
        {name: "Silk Path Grand Resort & Spa Sapa", stars: 5},
        {name: "KK Sapa Hotel", stars: 3},
        {name: "Sapa Horizon Hotel", stars: 3},
        {name: "U Sapa Hotel", stars: 3},
        {name: "Pao's Sapa Leisure Hotel", stars: 4}
      ],
      "Can Tho": [
        {name: "Victoria Can Tho Resort", stars: 4},
        {name: "Azerai Can Tho", stars: 5},
        {name: "Muong Thanh Luxury Can Tho", stars: 4},
        {name: "TTC Hotel Premium Can Tho", stars: 4},
        {name: "Nesta Hotel Can Tho", stars: 3},
        {name: "Iris Hotel Can Tho", stars: 3}
      ],
      "Phu Quoc": [
        {name: "Salinda Resort Phu Quoc", stars: 5},
        {name: "Fusion Resort Phu Quoc", stars: 5},
        {name: "InterContinental Phu Quoc Long Beach", stars: 5},
        {name: "Vinpearl Resort & Spa Phu Quoc", stars: 5},
        {name: "JW Marriott Phu Quoc Emerald Bay", stars: 5},
        {name: "La Veranda Resort Phu Quoc", stars: 4},
        {name: "Novotel Phu Quoc Resort", stars: 4},
        {name: "Dusit Princess Moonrise Beach Resort", stars: 5}
      ],
      "Nha Trang": [
        {name: "InterContinental Nha Trang", stars: 5},
        {name: "Sheraton Nha Trang Hotel & Spa", stars: 5},
        {name: "Mia Resort Nha Trang", stars: 5},
        {name: "Amiana Resort Nha Trang", stars: 5},
        {name: "Novotel Nha Trang", stars: 4},
        {name: "Sunrise Nha Trang Beach Hotel & Spa", stars: 4}
      ],
      "Da Lat": [
        {name: "Ana Mandara Villas Dalat Resort & Spa", stars: 5},
        {name: "Dalat Palace Heritage Hotel", stars: 4},
        {name: "Terracotta Hotel & Resort Dalat", stars: 4},
        {name: "Swiss-Belresort Tuyen Lam Dalat", stars: 4},
        {name: "Du Parc Hotel Dalat", stars: 4},
        {name: "Ngoc Lan Hotel Dalat", stars: 3}
      ],
      "Mui Ne": [
        {name: "Anantara Mui Ne Resort", stars: 5},
        {name: "Sailing Club Resort Mui Ne", stars: 4},
        {name: "Pandanus Resort Mui Ne", stars: 4},
        {name: "Victoria Phan Thiet Beach Resort & Spa", stars: 4},
        {name: "The Cliff Resort & Residences", stars: 4},
        {name: "Sandunes Beach Resort & Spa", stars: 4}
      ],
      "Phnom Penh": [
        {name: "The Plantation Urban Resort & Spa", stars: 4},
        {name: "Sun & Moon Urban Hotel", stars: 3},
        {name: "Rosewood Phnom Penh", stars: 5},
        {name: "Raffles Hotel Le Royal", stars: 5},
        {name: "Hyatt Regency Phnom Penh", stars: 5}
      ],
      "Siem Reap": [
        {name: "Lotus Blanc Resort", stars: 4},
        {name: "Tara Angkor Hotel", stars: 4},
        {name: "Somadevi Angkor Boutique", stars: 4},
        {name: "Sofitel Angkor Phokeethra", stars: 5},
        {name: "Raffles Grand d'Angkor", stars: 5},
        {name: "Anantara Angkor Resort", stars: 5}
      ]
    };

    const ACTIVITIES = {
      "Ho Chi Minh City": {
        morning: [
          "Guided visit of the War Remnants Museum and the Reunification Palace.",
          "Walking tour through Dong Khoi Street and the French colonial quarter.",
          "Cu Chi Tunnels half-day excursion (underground network tour).",
          "Notre Dame Cathedral and Central Post Office visit.",
          "Jade Emperor Pagoda and Thien Hau Temple tour.",
          "Independence Palace guided tour.",
          "Saigon Skydeck observation deck visit."
        ],
        afternoon: [
          "Ben Thanh Market & local coffee workshop.",
          "Cu Chi Tunnels (half-day, may be combined with morning).",
          "French Quarter walking tour with colonial architecture.",
          "Mekong Delta day trip to My Tho and Ben Tre.",
          "Saigon River boat tour.",
          "Art galleries and museums in District 1.",
          "Local cooking class with market visit."
        ],
        evening: [
          "Saigon rooftop bar experience & night street food tour.",
          "Dinner cruise on the Saigon River with live music.",
          "Ben Thanh Night Market exploration.",
          "A O Show or traditional Vietnamese cultural performance.",
          "Bui Vien Walking Street (backpacker area).",
          "Rooftop bar hopping in District 1.",
          "Local beer and street food experience."
        ]
      },
      "Hanoi": {
        morning: [
          "City tour: Ho Chi Minh complex, One Pillar Pagoda and Tran Quoc Pagoda.",
          "Cyclo ride in the Old Quarter, including local market visit.",
          "Ho Chi Minh Mausoleum and Presidential Palace visit.",
          "West Lake and Tran Quoc Pagoda walk.",
          "Train Street visit (famous narrow street with train tracks).",
          "Dong Xuan Market exploration.",
          "Hoa Lo Prison Museum (Hanoi Hilton) tour."
        ],
        afternoon: [
          "Temple of Literature and Ethnology Museum.",
          "Ethnology Museum and Old Quarter walking tour.",
          "Water Puppet Show at Thang Long Theatre.",
          "St. Joseph's Cathedral and surrounding French Quarter.",
          "Vietnamese Women's Museum visit.",
          "Old Quarter 36 streets walking tour.",
          "Art galleries and craft workshops in the Old Quarter."
        ],
        evening: [
          "Street food tour around Hoan Kiem Lake.",
          "Beer corner & local bar experience in the Old Quarter.",
          "Hoan Kiem Lake night walk and Ngoc Son Temple.",
          "Traditional Vietnamese music performance.",
          "Rooftop bar with views of the Old Quarter.",
          "Night market shopping in the Old Quarter.",
          "Local cafÃ© culture experience (egg coffee)."
        ]
      },
      "Da Nang": {
        morning: [
          "Ba Na Hills â€“ Golden Bridge & French Village (early departure).",
          "Relaxed beach time on My Khe Beach.",
          "Marble Mountains (Ngu Hanh Son) exploration and cave visits.",
          "Son Tra Peninsula (Monkey Mountain) and Lady Buddha statue.",
          "Dragon Bridge and Han River waterfront walk.",
          "Cham Museum visit (largest collection of Cham artifacts).",
          "My Khe Beach water sports (kayaking, jet skiing)."
        ],
        afternoon: [
          "Marble Mountains & Linh Ung Pagoda.",
          "Han Market & local coffee break.",
          "Ba Na Hills â€“ Golden Bridge & French Village (if not done in morning).",
          "Non Nuoc Beach relaxation.",
          "Local craft villages (marble carving, pottery).",
          "Dragon Bridge photo opportunity.",
          "Han River promenade walk and cafÃ© culture."
        ],
        evening: [
          "Han River cruise to see the bridges at night.",
          "Free time to explore bars and cafÃ©s along the river.",
          "Dragon Bridge fire and water show (weekends).",
          "Seafood dinner at a beachfront restaurant.",
          "Sky36 Rooftop Bar with panoramic city views.",
          "Han Market night food stalls.",
          "Riverside bars and live music venues."
        ]
      },
      "Hoi An": {
        morning: [
          "Basket boat tour in the Coconut Forest with local fisherman experience.",
          "Cooking class & local market visit.",
          "Tra Que Vegetable Village bicycle tour.",
          "Thanh Ha Pottery Village visit.",
          "Cam Thanh Coconut Village eco-tour.",
          "An Bang Beach morning relaxation.",
          "Hoi An Ancient Town early morning photography walk."
        ],
        afternoon: [
          "Walking tour of Hoi An Ancient Town (UNESCO).",
          "Free time for tailor fittings and shopping.",
          "Japanese Covered Bridge and Assembly Halls visit.",
          "Museum of Folk Culture and History.",
          "Kim Bong Carpentry Village tour.",
          "Cua Dai Beach or An Bang Beach time.",
          "Lantern making workshop."
        ],
        evening: [
          "Lantern boat ride on the river & Old Town by night.",
          "Romantic dinner in the Ancient Town.",
          "Hoi An Night Market exploration.",
          "Traditional music performance at a local venue.",
          "Riverside cafÃ©s and bars.",
          "Lantern-lit streets photography walk.",
          "Cooking class dinner experience."
        ]
      },
      "Hue": {
        morning: [
          "Boat trip on the Perfume River to Thien Mu Pagoda.",
          "Visit the Imperial Citadel (UNESCO).",
          "Royal Tombs tour (Khai Dinh, Tu Duc, or Minh Mang).",
          "Dong Ba Market exploration.",
          "Thien Mu Pagoda and Perfume River boat ride.",
          "Imperial City guided tour with history insights.",
          "Cycling tour around the Citadel walls."
        ],
        afternoon: [
          "Visit the Royal Tombs (Khai Dinh or Tu Duc).",
          "Incense village & conical hat village stop.",
          "Thien Mu Pagoda (if not done in morning).",
          "Dong Ba Market shopping and local food.",
          "Royal Fine Arts Museum visit.",
          "Perfume River cruise with traditional music.",
          "Local craft villages (incense, conical hats, bronze casting)."
        ],
        evening: [
          "Dinner with royal-style Hue cuisine.",
          "Free evening to explore riverside cafÃ©s.",
          "Truong Tien Bridge walk and night views.",
          "Royal-style dinner at a traditional restaurant.",
          "Perfume River night cruise.",
          "Local bars and cafÃ©s along the river.",
          "Traditional Hue music performance."
        ]
      },
      "Ha Long Bay": {
        morning: [
          "Check in to cruise and start sailing among the limestone karsts.",
          "Kayaking or bamboo boat ride in a quiet lagoon.",
          "Surprise Cave (Sung Sot Cave) exploration.",
          "Ti Top Island beach and hiking.",
          "Floating fishing village visit (Cua Van or Vung Vieng).",
          "Luon Cave kayaking through narrow passages.",
          "Cruise departure and first views of limestone karsts."
        ],
        afternoon: [
          "Visit a cave or floating village in Ha Long Bay.",
          "Cooking demonstration on board the cruise.",
          "Pearl Farm visit and demonstration.",
          "Swimming and sunbathing on the sundeck.",
          "Tai Chi session on deck.",
          "Cave exploration (Surprise Cave, Thien Cung Cave).",
          "Bamboo boat ride through floating village."
        ],
        evening: [
          "Sunset on deck with welcome drink.",
          "Squid fishing or relaxing onboard activities.",
          "Sunset party with cocktails and snacks.",
          "Dinner on board with fresh seafood.",
          "Night squid fishing experience.",
          "Karaoke or board games on board.",
          "Stargazing on the sundeck (weather permitting)."
        ]
      },
      "Ninh Binh": {
        morning: [
          "Boat trip through the caves in Tam Coc or Trang An.",
          "Cycling through rice fields and local villages.",
          "Trang An Scenic Landscape Complex boat tour.",
          "Tam Coc boat ride through rice fields and caves.",
          "Hoa Lu Ancient Capital visit (Dinh and Le temples).",
          "Bai Dinh Pagoda complex tour (largest pagoda in Vietnam).",
          "Early morning photography of rice terraces."
        ],
        afternoon: [
          "Visit Bich Dong Pagoda or Bai Dinh Pagoda.",
          "Viewpoint hike at Mua Cave for panorama of Ninh Binh.",
          "Bich Dong Pagoda (three-level cave pagoda).",
          "Cycling tour through countryside and villages.",
          "Van Long Nature Reserve boat trip.",
          "Local craft village visit (embroidery, weaving).",
          "Cuc Phuong National Park visit (if time permits)."
        ],
        evening: [
          "Relax at the lodge with countryside views.",
          "Optional walk or bicycle ride at sunset.",
          "Sunset viewing from Mua Cave viewpoint.",
          "Countryside lodge dinner with local specialties.",
          "Evening walk through rice fields.",
          "Local homestay cultural exchange.",
          "Stargazing in the peaceful countryside."
        ]
      },
      "Sapa": {
        morning: [
          "Guided trekking through minority villages around Sapa.",
          "Visit a local market (depending on day).",
          "Cat Cat Village trek and waterfall visit.",
          "Fansipan cable car to Indochina's highest peak.",
          "Lao Chai and Ta Van villages trekking.",
          "Silver Waterfall and Love Waterfall visit.",
          "Ham Rong Mountain flower garden and viewpoint."
        ],
        afternoon: [
          "Continue trekking through rice terraces and valleys.",
          "Visit a local family for tea and cultural exchange.",
          "Y Linh Ho village trek through rice terraces.",
          "Local homestay experience and traditional lunch.",
          "Bamboo forest trekking.",
          "Local handicraft workshops (weaving, silver making).",
          "Muong Hoa Valley exploration."
        ],
        evening: [
          "Free time in Sapa town for dinner and shopping.",
          "Relax at the hotel or enjoy a massage after trekking.",
          "Sapa night market and local food.",
          "Traditional Hmong or Red Dao cultural show.",
          "Local restaurant with mountain views.",
          "Evening walk around Sapa Lake.",
          "Hot stone bath experience (Red Dao tradition)."
        ]
      },
      "Can Tho": {
        morning: [
          "Early boat trip to Cai Rang floating market.",
          "Visit small canals and local fruit gardens.",
          "Cai Rang Floating Market (largest in Mekong Delta).",
          "Phong Dien Floating Market visit.",
          "Boat trip through narrow canals and arroyos.",
          "Local fruit orchards and garden visits.",
          "Traditional sampan boat ride."
        ],
        afternoon: [
          "Cycle or walk through villages along the Mekong canals.",
          "Visit a local rice noodle or rice paper workshop.",
          "Binh Thuy Ancient House visit.",
          "Mekong Delta countryside cycling tour.",
          "Local workshops (rice paper, coconut candy, rice wine).",
          "Coconut processing factory visit.",
          "Mekong Delta homestay experience."
        ],
        evening: [
          "Riverside dinner in Can Tho.",
          "Free evening to explore Ninh Kieu Pier promenade.",
          "Ninh Kieu Pier night market and food stalls.",
          "Mekong River sunset cruise.",
          "Local seafood dinner by the river.",
          "Evening walk along the waterfront.",
          "Traditional music performance."
        ]
      },
      "Phu Quoc": {
        morning: [
          "Relax on the beach or by the pool.",
          "Optional snorkelling or boat trip to nearby islands.",
          "Snorkelling tour to An Thoi Archipelago.",
          "Sao Beach (most beautiful beach on the island).",
          "Phu Quoc National Park hiking.",
          "Starfish Beach visit.",
          "Cable car to Hon Thom Island."
        ],
        afternoon: [
          "Visit a fish sauce factory or pepper farm.",
          "Explore Phu Quoc National Park or a local waterfall (seasonal).",
          "Phu Quoc Pearl Farm visit.",
          "Coconut Prison historical site.",
          "Dinh Cau Night Market preparation and local food.",
          "Beach relaxation and water sports.",
          "Local pepper and fish sauce factory tours."
        ],
        evening: [
          "Dinner at the night market in Duong Dong.",
          "Beachfront drinks at a sunset bar.",
          "Duong Dong Night Market food tour.",
          "Sunset viewing at Dinh Cau Rock.",
          "Beachfront seafood dinner.",
          "Rooftop bar with ocean views.",
          "Beach bonfire and stargazing."
        ]
      },
      "Nha Trang": {
        morning: [
          "Island-hopping boat trip with snorkelling.",
          "Relaxed beachfront morning in Nha Trang.",
          "Snorkelling and diving at Hon Mun Marine Park.",
          "VinWonders Theme Park visit.",
          "Po Nagar Cham Towers visit.",
          "Long Son Pagoda and White Buddha statue.",
          "Nha Trang Beach water sports (parasailing, jet skiing)."
        ],
        afternoon: [
          "Mud bath & spa experience.",
          "Visit Po Nagar Cham Towers and Long Son Pagoda.",
          "Thap Ba Hot Springs mud bath.",
          "Hon Chong Promontory visit.",
          "Dam Market shopping.",
          "Beach relaxation and swimming.",
          "Oceanographic Institute visit."
        ],
        evening: [
          "Seafood dinner at a local restaurant.",
          "Free time to enjoy Nha Trang's nightlife and seafront promenade.",
          "Nha Trang Night Market exploration.",
          "Seafront promenade walk.",
          "Rooftop bars with ocean views.",
          "Local seafood restaurants.",
          "Beachfront bars and live music."
        ]
      },
      "Da Lat": {
        morning: [
          "City tour: Bao Dai's Summer Palace, Crazy House or Da Lat Railway Station.",
          "Visit local flower gardens and Xuan Huong Lake.",
          "Crazy House (Hang Nga Guesthouse) visit.",
          "Bao Dai's Summer Palace tour.",
          "Da Lat Railway Station and old steam train.",
          "Xuan Huong Lake walk and paddle boating.",
          "Flower gardens (Valley of Love, Flower Park)."
        ],
        afternoon: [
          "Visit coffee farm and waterfall in the countryside.",
          "Cable car to Truc Lam Pagoda (if operating).",
          "Elephant Falls and Datanla Falls visit.",
          "Coffee plantation tour and tasting.",
          "Truc Lam Zen Monastery cable car ride.",
          "Countryside motorbike tour.",
          "Local strawberry farms and flower farms."
        ],
        evening: [
          "Explore Da Lat night market.",
          "Relax in a cafÃ© with local coffee and cool mountain air.",
          "Da Lat Night Market food tour.",
          "Local cafÃ© culture (famous for coffee).",
          "Evening walk around Xuan Huong Lake.",
          "Traditional music performance.",
          "Rooftop bars with mountain views."
        ]
      },
      "Mui Ne": {
        morning: [
          "Sunrise visit to the white sand dunes of Mui Ne.",
          "Walk along the Fairy Stream (Suoi Tien).",
          "White Sand Dunes sunrise and sandboarding.",
          "Red Sand Dunes visit.",
          "Fairy Stream (Suoi Tien) walk through red canyons.",
          "Fishing village visit and morning market.",
          "Beach sunrise viewing."
        ],
        afternoon: [
          "Relax at the resort or on the beach.",
          "Optional kitesurfing or watersports (seasonal).",
          "Kitesurfing lessons (best kitesurfing spot in Vietnam).",
          "Beach relaxation and swimming.",
          "Poshanu Cham Towers visit.",
          "Mui Ne Beach water sports.",
          "Local seafood lunch by the beach."
        ],
        evening: [
          "Seafood dinner by the sea.",
          "Free time to enjoy beach bars and the sound of the ocean.",
          "Beachfront seafood restaurants.",
          "Sunset viewing at the sand dunes.",
          "Beach bars and nightlife.",
          "Night fishing experience.",
          "Beach bonfire and stargazing."
        ]
      }
    };

    const state = {
      traveller: {},
      daysData: [],
      selectedItineraryTemplate: null // Store selected brief/detailed itinerary template
    };

    // =======================
    // VHT ITINERARY LIBRARY
    // =======================

    const briefItineraries = {
      4: {
        id: "vn-4-taste",
        name: "Vietnam in 4 Days â€“ Saigon & Mekong Snapshot",
        destinations: "Ho Chi Minh City, Mekong Delta",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Ho Chi Minh City, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Short but sweet introduction to Vietnam. Start in Ho Chi Minh City with a city highlights tour and Old Quarter. Day trip to Ninh Binh (Trang An or Tam Coc + viewpoints). Finish with a mini-cruise in Ha Long or Bai Tu Long Bay before departure.",
        days: [
          "Day 1 â€“ Ho Chi Minh City: Arrival, orientation walk and rooftop sunset.",
          "Day 2 â€“ Saigon City Highlights: Independence Palace, Notre Dame, Post Office, War Remnants Museum, Ben Thanh Market.",
          "Day 3 â€“ Mekong Delta Day Trip: My Tho, boat ride, canals, local houses, honey tea and fruits.",
          "Day 4 â€“ Free time & departure from Ho Chi Minh City."
        ]
      },
      6: {
        id: "vn-6-coast",
        name: "Vietnam in 6 Days â€“ Saigon, Mekong & Central Coast",
        destinations: "Ho Chi Minh City, Mekong Delta, Da Nang, Hoi An",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Da Nang / Hoi An, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "From busy Saigon to charming Hoi An. This 6-day itinerary takes you from the dynamic Ho Chi Minh City and the serene Mekong Delta to the enchanting ancient town of Hoi An.",
        days: [
          "Day 1 â€“ Ho Chi Minh City: Arrival and evening in the city center.",
          "Day 2 â€“ Saigon City Tour: Main landmarks + local street food experience.",
          "Day 3 â€“ Mekong Delta: Boat trip, canals, local crafts and village life.",
          "Day 4 â€“ Fly to Da Nang, transfer to Hoi An, evening lanterns in Ancient Town.",
          "Day 5 â€“ Hoi An Old Town & countryside: Walking tour + basket boat or Tra Que village.",
          "Day 6 â€“ Free time in Hoi An (beach/old town) and onward departure."
        ]
      },
      8: {
        id: "vn-8-classic",
        name: "Vietnam in 8 Days â€“ Classic Highlights South to Central",
        destinations: "Ho Chi Minh City, Mekong Delta, Cu Chi, Da Nang, Hoi An",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Da Nang / Hoi An, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Saigon, Mekong Delta, Da Nang & Hoi An. This 8-day itinerary offers a comprehensive journey through the highlights of Southern and Central Vietnam.",
        days: [
          "Day 1 â€“ Ho Chi Minh City: Arrival, easy evening in District 1.",
          "Day 2 â€“ Saigon City Highlights: Independence Palace, Cathedral, Post Office, War Museum, Ben Thanh.",
          "Day 3 â€“ Cu Chi Tunnels: Half-day visit to the underground network + free afternoon.",
          "Day 4 â€“ Mekong Delta: Boat trip, floating/local markets, canals and village lunch.",
          "Day 5 â€“ Fly to Da Nang, transfer to Hoi An, lantern-lit evening by the river.",
          "Day 6 â€“ Hoi An Old Town: Walking tour, Japanese Bridge, assembly halls, local crafts.",
          "Day 7 â€“ Countryside Experience: Tra Que village & coconut basket boats OR beach day.",
          "Day 8 â€“ Free time in Hoi An and departure from Da Nang."
        ]
      },
      10: {
        id: "vn-10-discovery",
        name: "Vietnam in 10 Days â€“ South, Central & a Taste of the North",
        destinations: "Ho Chi Minh City, Mekong Delta, Da Nang, Hoi An, Ba Na Hills, Hanoi, Ninh Binh",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Saigon, Mekong, Hoi An and Hanoi snapshot. This 10-day itinerary offers a comprehensive journey through the highlights of Southern, Central, and Northern Vietnam.",
        days: [
          "Day 1â€“2 â€“ Ho Chi Minh City: Arrival + full city tour and Cu Chi Tunnels.",
          "Day 3 â€“ Mekong Delta: Day trip with boat, canals, local farms and lunch.",
          "Day 4 â€“ Fly to Da Nang, transfer to Hoi An, evening in Ancient Town.",
          "Day 5 â€“ Hoi An: Walking tour + Tra Que & coconut palm forest.",
          "Day 6 â€“ Ba Na Hills: Golden Bridge, cable car, French Village.",
          "Day 7 â€“ Fly Da Nang â†’ Hanoi, Old Quarter orientation.",
          "Day 8 â€“ Hanoi City Tour: Ho Chi Minh complex, Temple of Literature, Old Quarter.",
          "Day 9 â€“ Ninh Binh day trip: Hoa Lu, Trang An or Tam Coc, viewpoints.",
          "Day 10 â€“ Free time in Hanoi and departure."
        ]
      },
      12: {
        id: "vn-12-highlights",
        name: "Vietnam in 12 Days â€“ Highlights with Ha Long Bay",
        destinations: "Ho Chi Minh City, Mekong Delta, Da Nang, Hoi An, Ba Na Hills, Hanoi, Ha Long Bay",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Saigon, Mekong, Hoi An, Hanoi & Ha Long. This 12-day itinerary combines the vibrant energy of Southern Vietnam with the cultural richness of the Central region and the breathtaking natural beauty of the North, including an iconic Ha Long Bay cruise.",
        days: [
          "Days 1â€“3 â€“ Ho Chi Minh City & Cu Chi: Arrival, full city tour, half-day Cu Chi Tunnels.",
          "Day 4 â€“ Mekong Delta: My Tho/Ben Tre boat trip, village visit and local lunch.",
          "Day 5 â€“ Fly to Da Nang, transfer to Hoi An, sunset in Ancient Town.",
          "Day 6 â€“ Hoi An countryside: Tra Que & coconut basket boats.",
          "Day 7 â€“ Ba Na Hills: Golden Bridge, cable car, Fantasy Park.",
          "Day 8 â€“ Fly Da Nang â†’ Hanoi, evening Old Quarter.",
          "Day 9 â€“ Hanoi City Highlights: Ho Chi Minh complex, Temple of Literature, Old Quarter.",
          "Day 10 â€“ Hanoi â†’ Ha Long / Bai Tu Long: Board overnight cruise, kayaking & caves.",
          "Day 11 â€“ Morning on the bay, brunch on cruise, return to Hanoi.",
          "Day 12 â€“ Free time in Hanoi and departure."
        ]
      },
      14: {
        id: "vn-14-immersion",
        name: "Private Vietnam Trip 14 Days 13 Nights â€“ Vietnam Immersion",
        destinations: "Hanoi, Ninh Binh, Ha Long Bay, Da Nang, Hoi An, Ho Chi Minh City, Mekong Delta, Can Tho",
        startsIn: "Hanoi, Vietnam",
        endsIn: "Ho Chi Minh City, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "This 14-day Vietnam Immersion itinerary begins in Hanoi with history, culture and a full Ninh Binh experience, continues through Ha Long Bay and Central Vietnam (Da Nang, Ba Na Hills, Hoi An), and ends in Ho Chi Minh City with Mekong Delta and Cu Chi Tunnels highlights.",
        days: [
          "Day 1 â€“ Arrival in Hanoi.",
          "Day 2 â€“ Full-day Hanoi city tour.",
          "Day 3 â€“ Ninh Binh full-day (Trang An + Hoa Lu).",
          "Day 4 â€“ Hanoi â†’ Ha Long Bay cruise.",
          "Day 5 â€“ Ha Long Bay â†’ Hanoi â†’ Fly to Da Nang.",
          "Day 6 â€“ Ba Na Hills full-day.",
          "Day 7 â€“ Hoi An walking tour (from Da Nang).",
          "Day 8 â€“ Da Nang city tour.",
          "Day 9 â€“ Free day in Da Nang.",
          "Day 10 â€“ Fly Da Nang â†’ Ho Chi Minh City.",
          "Day 11 â€“ HCMC highlights + Cu Chi Tunnels.",
          "Day 12 â€“ Mekong Delta â†’ Can Tho.",
          "Day 13 â€“ Cai Rang Floating Market â†’ HCMC.",
          "Day 14 â€“ Departure from Ho Chi Minh."
        ]
      },
      16: {
        id: "vn-16-grand",
        name: "Vietnam in 16 Days â€“ Coastline & Culture",
        destinations: "Hanoi, Ninh Binh, Ha Long Bay, Da Nang, Hoi An, Ba Na Hills, Ho Chi Minh City, Mekong Delta, Can Tho",
        startsIn: "Hanoi, Vietnam",
        endsIn: "Ho Chi Minh City, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Adds more free time and coastal relaxation. This 16-day itinerary offers an extensive exploration of Vietnam's grand highlights, from the cultural richness of the North through the historical charm of the Central region, to the vibrant energy of the South.",
        days: [
          "Days 1â€“3 â€“ Hanoi & Ninh Binh: City tour + Hoa Lu/Trang An day trip.",
          "Days 4â€“5 â€“ Ha Long Bay cruise with overnight on board.",
          "Days 6â€“9 â€“ Da Nang & Hoi An: Ba Na Hills, Hoi An town, Da Nang city tour, free beach day.",
          "Day 10 â€“ Fly to Ho Chi Minh City, evening street life.",
          "Days 11â€“12 â€“ Saigon city & Cu Chi Tunnels.",
          "Days 13â€“14 â€“ Mekong Delta & Can Tho: Local life, boat trips, Cai Rang floating market.",
          "Days 15â€“16 â€“ Extra free day in Saigon for shopping/spa and departure."
        ]
      },
      18: {
        id: "vn-18-extended",
        name: "Vietnam in 18 Days â€“ Extended North & Central",
        destinations: "Hanoi, Ninh Binh, Ha Long Bay, Da Nang, Hoi An, Ba Na Hills, Ho Chi Minh City, Mekong Delta, Can Tho",
        startsIn: "Hanoi, Vietnam",
        endsIn: "Ho Chi Minh City, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "More time in Hanoi, Ninh Binh, Hoi An and Saigon. This 18-day itinerary offers a comprehensive journey through Vietnam, starting from the vibrant Ho Chi Minh City in the South, moving through the cultural heart of the Central region, and concluding in the historical capital of Hanoi in the North.",
        days: [
          "Days 1â€“3 â€“ Hanoi: City highlights + food and coffee experiences.",
          "Days 4â€“5 â€“ Ninh Binh: Two days of boat trips, temples and viewpoints.",
          "Days 6â€“7 â€“ Ha Long / Bai Tu Long: Cruise, caves, kayaking.",
          "Days 8â€“11 â€“ Da Nang & Hoi An: Ba Na Hills, walking tour, countryside, beach/free time.",
          "Day 12 â€“ Fly to Saigon, evening city lights.",
          "Days 13â€“14 â€“ Ho Chi Minh City & Cu Chi Tunnels.",
          "Days 15â€“16 â€“ Mekong Delta: 2-day program with local stays and Can Tho.",
          "Days 17â€“18 â€“ Free days in Saigon for shopping, massages and departure."
        ]
      },
      20: {
        id: "vn-20-signature",
        name: "Vietnam in 20 Days â€“ Vietnam & Inland Valleys",
        destinations: "Hanoi, Ninh Binh, Ha Long Bay, Da Nang, Hoi An, Ba Na Hills, Hue, Ho Chi Minh City, Mekong Delta",
        startsIn: "Hanoi, Vietnam",
        endsIn: "Ho Chi Minh City, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Adds extra countryside and rural experiences. This 20-day itinerary offers a comprehensive journey through Vietnam, from the vibrant Ho Chi Minh City in the South, through the cultural heart of the Central region, to the historical capital of Hanoi and the majestic landscapes of the North.",
        days: [
          "Day 1 â€“ Ho Chi Minh City arrival.",
          "Day 2 â€“ Full-day Ho Chi Minh City tour.",
          "Day 3 â€“ Mekong Delta full-day excursion.",
          "Day 4 â€“ Cu Chi Tunnels half-day tour.",
          "Day 5 â€“ Fly Ho Chi Minh â†’ Da Nang, transfer to Hoi An.",
          "Day 6 â€“ Hoi An Ancient Town walking tour (half-day).",
          "Day 7 â€“ Tra Que Vegetable Village & Coconut Palm Forest.",
          "Day 8 â€“ Free day in Hoi An.",
          "Day 9 â€“ Ba Na Hills full day â†’ overnight Da Nang.",
          "Day 10 â€“ Da Nang city full-day tour.",
          "Day 11 â€“ Da Nang â†’ Hue full-day city tour, overnight in Hue.",
          "Day 12 â€“ Hue â†’ Fly to Hanoi.",
          "Day 13 â€“ Hanoi city full-day tour.",
          "Day 14 â€“ Hoa Lu â€“ Trang An â€“ Mua Cave full-day tour.",
          "Day 15 â€“ Extra day in Ninh Binh for slower exploration and village walks.",
          "Day 16 â€“ Hanoi â†’ Sapa by limousine bus.",
          "Day 17 â€“ Sapa trekking: Y Linh Ho â€“ Lao Chai â€“ Ta Van.",
          "Day 18 â€“ Fansipan Peak â†’ Hanoi by limousine bus.",
          "Day 19 â€“ Hanoi â†’ Ha Long Bay, overnight cruise.",
          "Day 20 â€“ Ha Long Bay â†’ Hanoi, free time and departure."
        ]
      },
      21: {
        id: "vn-21-symphony",
        name: "Private Vietnam 21 Days 20 Nights â€“ Symphony of Vietnam",
        destinations: "Ho Chi Minh City, Mekong Delta, Da Nang, Hoi An, Hue, Hanoi, Ninh Binh, Sapa, Ha Long Bay",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Let the Symphony of Vietnam be your personal 21-day, 20-night odyssey from vibrant Ho Chi Minh City and the Mekong Delta to charming Hoi An and Hue, and on to Hanoi, Ninh Binh, Sapa and Ha Long Bay. This journey blends culture, history and landscapes into one seamless, private experience.",
        days: [
          "Day 1 â€“ Ho Chi Minh City arrival.",
          "Day 2 â€“ Full-day Ho Chi Minh City tour.",
          "Day 3 â€“ Mekong Delta full-day excursion.",
          "Day 4 â€“ Cu Chi Tunnels half-day tour.",
          "Day 5 â€“ Fly Ho Chi Minh â†’ Da Nang, transfer to Hoi An.",
          "Day 6 â€“ Hoi An Ancient Town walking tour (half-day).",
          "Day 7 â€“ Tra Que Vegetable Village & Coconut Palm Forest.",
          "Day 8 â€“ Free day in Hoi An.",
          "Day 9 â€“ Ba Na Hills full day â†’ overnight Da Nang.",
          "Day 10 â€“ Da Nang city full-day tour.",
          "Day 11 â€“ Da Nang â†’ Hue full-day city tour, overnight in Hue.",
          "Day 12 â€“ Hue â†’ Fly to Hanoi.",
          "Day 13 â€“ Hanoi city full-day tour.",
          "Day 14 â€“ Hoa Lu â€“ Trang An â€“ Mua Cave full-day tour.",
          "Day 15 â€“ Hanoi â†’ Sapa by limousine bus.",
          "Day 16 â€“ Sapa trekking: Y Linh Ho â€“ Lao Chai â€“ Ta Van.",
          "Day 17 â€“ Fansipan Peak â†’ Hanoi by limousine bus.",
          "Day 18 â€“ Hanoi â†’ Ha Long Bay, overnight cruise.",
          "Day 19 â€“ Ha Long Bay â†’ Hanoi.",
          "Day 20 â€“ Hanoi â€“ Quang Phu Cau Incense Village.",
          "Day 21 â€“ Departure from Hanoi."
        ]
      },
      22: {
        id: "vn-22-panorama",
        name: "Vietnam Panorama â€“ 22 Days",
        destinations: "Ho Chi Minh City, Mekong Delta, Cai Be, Vinh Long, Cat Tien, Da Lat, Da Nang, Hoi An, Ba Na Hills, Hue, Phong Nha, Hanoi, Ninh Binh, Cuc Phuong, Ha Giang, Ha Long Bay, Lan Ha Bay",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Based on your 22D/21N Southâ€“North panorama. This comprehensive journey takes you through Vietnam's diverse landscapes, from the bustling South to the majestic North, including the spectacular Ha Giang loop.",
        days: [
          "Day 1 â€“ Ho Chi Minh City arrival.",
          "Day 2 â€“ Ho Chi Minh City & Cu Chi Tunnels.",
          "Day 3 â€“ Ho Chi Minh â€“ Cai Be â€“ Floating Market â€“ Cu Lao An Binh â€“ Vinh Long.",
          "Day 4 â€“ Ho Chi Minh â€“ Cat Tien National Park.",
          "Day 5 â€“ Ho Chi Minh â€“ Fly to Da Lat â€“ Waterfalls tour.",
          "Day 6 â€“ Da Lat â€“ Natural countryside landscapes.",
          "Day 7 â€“ Dalat â€“ Fly to Danang â€“ Hoi An.",
          "Day 8 â€“ Hoi An basket boat, Tra Que Village & Ancient Town tour.",
          "Day 9 â€“ Hoi An cooking class & My Son Sanctuary.",
          "Day 10 â€“ Hoi An â€“ Da Nang â€“ Ba Na Hills full day.",
          "Day 11 â€“ Da Nang city half-day tour.",
          "Day 12 â€“ Danang â€“ Hue City full-day tour.",
          "Day 13 â€“ Hue â€“ Phong Nha Cave â€“ Train to Ha Noi.",
          "Day 14 â€“ Ha Noi â€“ Ha Noi half-day tour.",
          "Day 15 â€“ Ha Noi â€“ Bai Dinh â€“ Trang An â€“ Mua Cave full-day tour.",
          "Day 16 â€“ Ninh Binh â€“ Cuc Phuong National Park â€“ Ha Noi.",
          "Day 17 â€“ Ha Noi â€“ Ha Giang City (group tour).",
          "Day 18 â€“ Ha Giang City â€“ Quan Ba â€“ Yen Minh â€“ Dong Van Town (group tour).",
          "Day 19 â€“ Dong Van â€“ Meo Vac (group tour).",
          "Day 20 â€“ Ha Giang â€“ Ha Noi.",
          "Day 21 â€“ Ha Noi â€“ Tuan Chau â€“ Ha Long Bay â€“ Lan Ha Bay â€“ Tra Bau.",
          "Day 22 â€“ Lan Ha Bay â€“ Cat Ba Island â€“ Tuan Chau â€“ Ha Noi departure."
        ]
      },
      24: {
        id: "vn-24-deep",
        name: "Vietnam in 24 Days â€“ Deep Discovery",
        destinations: "Ho Chi Minh City, Mekong Delta, Nha Trang, Da Lat, Da Nang, Hoi An, Ba Na Hills, Hue, Hanoi, Ninh Binh, Sapa, Ha Long Bay",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Adds more slow days on top of the 22-day panorama. This 24-day itinerary offers a deep dive into Vietnam's culture, history, and natural beauty with a relaxed pace.",
        days: [
          "Day 1 â€“ Ho Chi Minh City arrival.",
          "Day 2 â€“ Ho Chi Minh City & Cu Chi Tunnels.",
          "Day 3 â€“ Ho Chi Minh â€“ Mekong Delta full day.",
          "Day 4 â€“ Ho Chi Minh â€“ Cu Chi Tunnels half day.",
          "Day 5 â€“ Ho Chi Minh â€“ Fly to Nha Trang.",
          "Day 6 â€“ Nha Trang city & mud spa tour.",
          "Day 7 â€“ Nha Trang free day.",
          "Day 8 â€“ Nha Trang â€“ Da Lat by private car.",
          "Day 9 â€“ Da Lat city tour.",
          "Day 10 â€“ Da Lat free day.",
          "Day 11 â€“ Da Lat â€“ Fly to Da Nang â€“ Hoi An.",
          "Day 12 â€“ Hoi An walking tour & Tra Que / basket boat.",
          "Day 13 â€“ Hoi An free day (tailors, beach or spa).",
          "Day 14 â€“ Hoi An â€“ Ba Na Hills full day â€“ Da Nang.",
          "Day 15 â€“ Da Nang city full-day tour.",
          "Day 16 â€“ Da Nang â€“ Hue City full-day tour.",
          "Day 17 â€“ Hue â€“ Fly to Ha Noi.",
          "Day 18 â€“ Ha Noi city full day.",
          "Day 19 â€“ Ha Noi â€“ Hoa Lu â€“ Trang An â€“ Mua Cave.",
          "Day 20 â€“ Ha Noi â€“ Sa Pa by limousine bus.",
          "Day 21 â€“ Sa Pa trekking â€“ Y Linh Ho â€“ Lao Chai â€“ Ta Van.",
          "Day 22 â€“ Sa Pa â€“ Fansipan Peak â€“ Ha Noi.",
          "Day 23 â€“ Ha Noi free day (cafÃ©s, museums and shopping).",
          "Day 24 â€“ Ha Noi â€“ Ha Long Bay overnight cruise â€“ Ha Noi departure."
        ]
      },
      26: {
        id: "vn-26-explorer",
        name: "Vietnam in 26 Days â€“ Mountains, Coast & Countryside",
        destinations: "Ho Chi Minh City, Mekong Delta, Nha Trang, Da Lat, Da Nang, Hoi An, Ba Na Hills, Hue, Hanoi, Ninh Binh, Sapa, Mai Chau, Ha Long Bay",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Very slow version including mountains and valleys. This 26-day itinerary offers an in-depth exploration of Vietnam's diverse regions, from the vibrant South to the majestic North, with extra time for relaxation and cultural immersion.",
        days: [
          "Day 1 â€“ Ho Chi Minh City arrival.",
          "Day 2 â€“ Ho Chi Minh City full day.",
          "Day 3 â€“ Ho Chi Minh â€“ Mekong Delta full day.",
          "Day 4 â€“ Ho Chi Minh â€“ Cu Chi Tunnels half day.",
          "Day 5 â€“ Ho Chi Minh â€“ Fly to Nha Trang.",
          "Day 6 â€“ Nha Trang city & mud spa tour.",
          "Day 7 â€“ Nha Trang free day.",
          "Day 8 â€“ Nha Trang â€“ Da Lat by private car.",
          "Day 9 â€“ Da Lat city tour.",
          "Day 10 â€“ Da Lat free day (extra relaxed exploration).",
          "Day 11 â€“ Da Lat â€“ Fly to Da Nang â€“ Hoi An.",
          "Day 12 â€“ Hoi An walking tour & Tra Que / basket boat.",
          "Day 13 â€“ Hoi An free day.",
          "Day 14 â€“ Hoi An â€“ Ba Na Hills full day â€“ Da Nang.",
          "Day 15 â€“ Da Nang city full-day tour.",
          "Day 16 â€“ Da Nang â€“ Hue City full-day tour.",
          "Day 17 â€“ Hue free day (extra relaxed exploration).",
          "Day 18 â€“ Hue â€“ Fly to Ha Noi.",
          "Day 19 â€“ Ha Noi city full day.",
          "Day 20 â€“ Ha Noi â€“ Hoa Lu â€“ Trang An â€“ Mua Cave.",
          "Day 21 â€“ Ninh Binh â€“ Cuc Phuong National Park â€“ Ha Noi (additional village walks).",
          "Day 22 â€“ Ha Noi â€“ Ha Giang City (group tour).",
          "Day 23 â€“ Ha Giang City â€“ Quan Ba â€“ Yen Minh â€“ Dong Van Town (group tour).",
          "Day 24 â€“ Dong Van â€“ Meo Vac (group tour) â€“ Ha Noi.",
          "Day 25 â€“ Ha Noi â€“ Ha Long Bay overnight cruise.",
          "Day 26 â€“ Ha Long Bay â€“ Ha Noi departure."
        ]
      },
      28: {
        id: "vn-28-month",
        name: "Vietnam in 28 Days â€“ Almost a Full Month",
        destinations: "Ho Chi Minh City, Mekong Delta, Can Tho, Nha Trang, Da Lat, Da Nang, Hoi An, Ba Na Hills, Hue, Hanoi, Ninh Binh, Sapa, Mai Chau, Ha Long Bay",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "Near full-month program based on your 30-day tour. This 28-day itinerary follows most of the 30-day 'Vietnam Full Month' route, offering a comprehensive journey through Vietnam's highlights with a balanced mix of excursions and rest days.",
        days: [
          "Day 1 â€“ Ho Chi Minh (Saigon) arrival.",
          "Day 2 â€“ Ho Chi Minh â€“ Cai Be â€“ Floating Market â€“ An Binh Island â€“ Vinh Long â€“ Can Tho.",
          "Day 3 â€“ Cai Rang Floating Market â€“ local Mekong life â€“ return to Ho Chi Minh City.",
          "Day 4 â€“ Fly from Ho Chi Minh City to Nha Trang â€“ beach city arrival.",
          "Day 5 â€“ Nha Trang city highlights & mud spa experience.",
          "Day 6 â€“ Free day in Nha Trang (beach & relaxation).",
          "Day 7 â€“ Scenic private-car transfer Nha Trang â†’ Da Lat.",
          "Day 8 â€“ Da Lat city tour (Bao Dai Palace, cable car, pagodas, waterfalls, flower park).",
          "Day 9 â€“ Free day in romantic Da Lat.",
          "Day 10 â€“ Fly Da Lat â†’ Da Nang, transfer to Hoi An.",
          "Day 11 â€“ Hoi An walking tour, Tra Que Village & basket boat in Coconut Forest.",
          "Day 12 â€“ Full day Ba Na Hills & Golden Bridge from Hoi An.",
          "Day 13 â€“ Half-day My Son Sanctuary, afternoon free in Hoi An.",
          "Day 14 â€“ Free day in Hoi An (beach / lantern town).",
          "Day 15 â€“ Hoi An â†’ Marble Mountain â†’ Hai Van Pass â†’ Hue.",
          "Day 16 â€“ Full-day Hue city tour (tombs, pagodas, Perfume River, market).",
          "Day 17 â€“ Fly Hue â†’ Hanoi, free evening in the capital.",
          "Day 18 â€“ Hanoi city afternoon tour by Jeep with street food & local life.",
          "Day 19 â€“ Full-day Bai Dinh â€“ Trang An boat trip â€“ Mua Cave viewpoint.",
          "Day 20 â€“ Quang Phu Cau incense village (craft & photography).",
          "Day 21 â€“ Hanoi â†’ Sapa by limousine bus, free time in Sapa.",
          "Day 22 â€“ Sapa trekking: Cat Cat â€“ Y Linh Ho â€“ Lao Chai â€“ Ta Van.",
          "Day 23 â€“ Sapa waterfalls & viewpoints: O Quy Ho, Silver Waterfall, Love Waterfall, Heaven Gate.",
          "Day 24 â€“ Fansipan cable car excursion, afternoon limousine bus back to Hanoi.",
          "Day 25 â€“ Free day in Hanoi (shopping / optional activities).",
          "Day 26 â€“ Hanoi â†’ Mai Chau valley, biking through minority villages.",
          "Day 27 â€“ Morning walk in Mai Chau villages, afternoon return to Hanoi.",
          "Day 28 â€“ Hanoi â†’ Ha Long Bay cruise, caves & sunset, return to Hanoi for departure."
        ]
      },
      30: {
        id: "vn-30-full-month",
        name: "Private Vietnam 30 Days 29 Nights â€“ Vietnam Full Month",
        destinations: "Ho Chi Minh City, Can Tho, Nha Trang, Da Lat, Da Nang, Hoi An, Hue, Hanoi, Ninh Binh, Sapa, Mai Chau, Ha Long Bay",
        startsIn: "Ho Chi Minh City, Vietnam",
        endsIn: "Hanoi, Vietnam",
        tourType: "Private tour",
        travelStyle: "Highlight Tours, Classic Tours, Family Tours, Luxury Tours",
        intro: "This incredible 30-day private tour unveils the diverse beauty and rich culture of Vietnam, from the bustling streets of Ho Chi Minh City to the serene landscapes of Ha Long Bay. You'll journey through vibrant floating markets, ancient temples, charming historical towns like Hoi An and Hue, and the stunning mountain scenery of Sapa and Mai Chau. Experience bustling city life, tranquil countryside, and breathtaking natural wonders in one comprehensive itinerary.",
        days: [
          "Day 1 â€“ Ho Chi Minh (Saigon) arrival",
          "Day 2 â€“ Ho Chi Minh â€“ Cai Be â€“ Floating Market â€“ An Binh Island â€“ Vinh Long â€“ Can Tho",
          "Day 3 â€“ Cai Rang Floating Market â€“ local Mekong life â€“ return to Ho Chi Minh City",
          "Day 4 â€“ Fly from Ho Chi Minh City to Nha Trang â€“ beach city arrival",
          "Day 5 â€“ Nha Trang city highlights & mud spa experience",
          "Day 6 â€“ Free day in Nha Trang (beach & relaxation)",
          "Day 7 â€“ Scenic private-car transfer Nha Trang â†’ Da Lat",
          "Day 8 â€“ Da Lat city tour (Bao Dai Palace, cable car, pagodas, waterfalls, flower park)",
          "Day 9 â€“ Free day in romantic Da Lat",
          "Day 10 â€“ Fly Da Lat â†’ Da Nang, transfer to Hoi An",
          "Day 11 â€“ Hoi An walking tour, Tra Que Village & basket boat in Coconut Forest",
          "Day 12 â€“ Full day Ba Na Hills & Golden Bridge from Hoi An",
          "Day 13 â€“ Half-day My Son Sanctuary, afternoon free in Hoi An",
          "Day 14 â€“ Free day in Hoi An (beach / lantern town)",
          "Day 15 â€“ Hoi An â†’ Marble Mountain â†’ Hai Van Pass â†’ Hue",
          "Day 16 â€“ Full-day Hue city tour (tombs, pagodas, Perfume River, market)",
          "Day 17 â€“ Fly Hue â†’ Hanoi, free evening in the capital",
          "Day 18 â€“ Hanoi city afternoon tour by Jeep with street food & local life",
          "Day 19 â€“ Full-day Bai Dinh â€“ Trang An boat trip â€“ Mua Cave viewpoint",
          "Day 20 â€“ Quang Phu Cau incense village (craft & photography)",
          "Day 21 â€“ Hanoi â†’ Sapa by limousine bus, free time in Sapa",
          "Day 22 â€“ Sapa trekking: Cat Cat â€“ Y Linh Ho â€“ Lao Chai â€“ Ta Van",
          "Day 23 â€“ Sapa waterfalls & viewpoints: O Quy Ho, Silver Waterfall, Love Waterfall, Heaven Gate",
          "Day 24 â€“ Fansipan cable car excursion, afternoon limousine bus back to Hanoi",
          "Day 25 â€“ Free day in Hanoi (shopping / optional activities)",
          "Day 26 â€“ Hanoi â†’ Mai Chau valley, biking through minority villages",
          "Day 27 â€“ Morning walk in Mai Chau villages, afternoon return to Hanoi",
          "Day 28 â€“ Hanoi â†’ Ha Long Bay (La Regina Classic Cruise), caves & sunset",
          "Day 29 â€“ Ha Long Bay floating village, brunch on board, return to Hanoi",
          "Day 30 â€“ Free time in Hanoi & departure transfer to the airport"
        ]
      }
    };

    const detailedItineraries = {
      4: {
        id: "vn-4-taste-detailed",
        name: "Vietnam in 4 Days â€“ Saigon & Mekong Snapshot (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Orientation", details: "Arrive at Tan Son Nhat International Airport (SGN), where you'll be met by your private driver and transferred to your hotel in the city center. After check-in, enjoy free time to relax or take an orientation walk around the bustling streets of District 1. In the evening, consider a rooftop bar for sunset views over the city." },
          { day: 2, title: "Saigon City Highlights Tour", details: "Embark on a full-day city tour of Ho Chi Minh City. Visit the historic Reunification Palace, the iconic Notre Dame Cathedral, and the Central Post Office. Explore the War Remnants Museum to understand Vietnam's recent history, and immerse yourself in the vibrant atmosphere of Ben Thanh Market. Lunch will be served at a local restaurant, offering authentic Vietnamese cuisine." },
          { day: 3, title: "Mekong Delta Discovery (My Tho & Ben Tre)", details: "Take a full-day excursion to the Mekong Delta. Drive to My Tho, where you'll take a boat trip on the Mekong River. Visit various islands, enjoy a sampan ride through narrow canals lined with coconut palms, and experience local life. Sample fresh fruits, enjoy honey tea, and visit a coconut candy workshop. Lunch will be served at a local restaurant on one of the islands before returning to Ho Chi Minh City in the late afternoon." },
          { day: 4, title: "Ho Chi Minh City Departure", details: "Enjoy a leisurely breakfast at your hotel. Depending on your flight schedule, you'll have free time for last-minute souvenir shopping or a final stroll. Your private driver will transfer you to Tan Son Nhat International Airport (SGN) for your onward departure." }
        ]
      },
      6: {
        id: "vn-6-coast-detailed",
        name: "Vietnam in 6 Days â€“ Saigon, Mekong & Central Coast (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Evening Exploration", details: "Arrive at Tan Son Nhat International Airport (SGN), meet your private driver, and transfer to your hotel in Ho Chi Minh City. After check-in, enjoy a free evening to explore the vibrant city center, perhaps with a street food tour or a visit to Ben Thanh Night Market." },
          { day: 2, title: "Saigon City Tour & Street Food", details: "Discover Ho Chi Minh City's iconic landmarks including the Reunification Palace, Notre Dame Cathedral, and Central Post Office. Delve into the local culture with a guided street food experience, sampling various Vietnamese delicacies. Visit the War Remnants Museum for historical insights. Lunch at a local restaurant." },
          { day: 3, title: "Mekong Delta Full Day Excursion", details: "Journey to the Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, explore lush islands, and take a traditional sampan ride through narrow canals. Visit local workshops to see coconut candy making and honey bee farms. Enjoy a fresh local lunch before returning to Ho Chi Minh City." },
          { day: 4, title: "Fly to Da Nang & Transfer to Hoi An", details: "After breakfast, transfer to Tan Son Nhat Airport for your flight to Da Nang. Upon arrival, meet your driver and transfer directly to your hotel in Hoi An. In the evening, immerse yourself in the magical atmosphere of Hoi An Ancient Town, illuminated by thousands of lanterns." },
          { day: 5, title: "Hoi An Old Town & Countryside Discovery", details: "Begin with a walking tour of Hoi An Ancient Town, a UNESCO World Heritage site. Explore the Japanese Covered Bridge, Phuc Kien Assembly Hall, and traditional houses. In the afternoon, choose between a fun basket boat ride in the Coconut Forest or a visit to Tra Que Vegetable Village for a hands-on farming experience. Enjoy a local lunch." },
          { day: 6, title: "Hoi An Departure", details: "Enjoy a leisurely breakfast and free time in Hoi An for last-minute shopping, relaxing at the beach, or enjoying a coffee by the river. Your private driver will transfer you to Da Nang International Airport (DAD) for your onward flight." }
        ]
      },
      8: {
        id: "vn-8-classic-detailed",
        name: "Vietnam in 8 Days â€“ Classic Highlights South to Central (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Leisure", details: "Arrive at Tan Son Nhat International Airport (SGN), where your private driver will meet you and transfer you to your hotel in Ho Chi Minh City. After check-in, enjoy a relaxed evening, perhaps with a stroll around the vibrant city center or a quiet dinner." },
          { day: 2, title: "Saigon City Highlights Tour", details: "Explore the iconic landmarks of Ho Chi Minh City on a full-day tour. Visit the Reunification Palace, Notre Dame Cathedral, and the historic Central Post Office. Gain insights into the Vietnam War at the War Remnants Museum, and experience the lively atmosphere of Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 3, title: "Cu Chi Tunnels Half-Day Excursion", details: "In the morning, embark on a half-day trip to the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers during the war. Learn about their ingenious living conditions and guerrilla tactics. You'll have the afternoon free back in Ho Chi Minh City for personal exploration or relaxation." },
          { day: 4, title: "Mekong Delta Full-Day Discovery", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local floating markets (if applicable), and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery before returning to Ho Chi Minh City." },
          { day: 5, title: "Fly to Da Nang & Transfer to Hoi An", details: "After breakfast, transfer to Tan Son Nhat Airport for your flight to Da Nang. Upon arrival, your private driver will transfer you directly to your hotel in Hoi An. In the evening, take a leisurely walk through the enchanting lantern-lit streets of Hoi An Ancient Town." },
          { day: 6, title: "Hoi An Ancient Town Walking Tour", details: "Discover the charm of Hoi An Ancient Town, a UNESCO World Heritage site, on a guided walking tour. Visit the iconic Japanese Covered Bridge, the Phuc Kien Assembly Hall, and a traditional merchant's house. Explore the bustling local market and learn about Hoi An's rich history as a trading port. Enjoy a local lunch." },
          { day: 7, title: "Hoi An Countryside Experience or Beach Day", details: "Today, choose your preferred activity: either a delightful countryside experience including a visit to Tra Que Vegetable Village for a hands-on farming lesson and a fun basket boat ride in the Coconut Forest, or a relaxing day at An Bang Beach. Lunch will be arranged according to your choice. Enjoy the evening at leisure in Hoi An." },
          { day: 8, title: "Hoi An Departure", details: "Enjoy a final breakfast in Hoi An. Depending on your flight schedule, you'll have free time for last-minute souvenir shopping or a final stroll through the ancient town. Your private driver will transfer you to Da Nang International Airport (DAD) for your onward departure." }
        ]
      },
      10: {
        id: "vn-10-discovery-detailed",
        name: "Vietnam in 10 Days â€“ South, Central & a Taste of the North (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & City Orientation", details: "Arrive at Tan Son Nhat International Airport (SGN), where your private driver will meet you and transfer you to your hotel in Ho Chi Minh City. After check-in, enjoy a relaxed evening, perhaps with an orientation walk around the vibrant city center." },
          { day: 2, title: "Saigon City Tour & Cu Chi Tunnels", details: "Morning: Visit the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers. Afternoon: Explore Ho Chi Minh City's highlights including the Reunification Palace, Notre Dame Cathedral, Central Post Office, and Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 3, title: "Mekong Delta Full-Day Excursion", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local markets, and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery before returning to Ho Chi Minh City." },
          { day: 4, title: "Fly to Da Nang & Transfer to Hoi An", details: "After breakfast, transfer to Tan Son Nhat Airport for your flight to Da Nang. Upon arrival, your private driver will transfer you directly to your hotel in Hoi An. In the evening, take a leisurely walk through the enchanting lantern-lit streets of Hoi An Ancient Town." },
          { day: 5, title: "Hoi An Ancient Town & Countryside Discovery", details: "Begin with a walking tour of Hoi An Ancient Town, a UNESCO World Heritage site. Explore the Japanese Covered Bridge, Phuc Kien Assembly Hall, and traditional houses. In the afternoon, choose between a fun basket boat ride in the Coconut Forest or a visit to Tra Que Vegetable Village for a hands-on farming experience. Enjoy a local lunch." },
          { day: 6, title: "Ba Na Hills Full-Day Excursion", details: "Embark on a full-day trip to Ba Na Hills. Take the world's longest cable car ride to the summit, visit the iconic Golden Bridge, explore the beautiful Le Jardin D'Amour gardens, Linh Ung Pagoda, and enjoy the French Village and Fantasy Park. Buffet lunch included. Return to Hoi An in the late afternoon." },
          { day: 7, title: "Fly to Hanoi & Old Quarter Orientation", details: "After breakfast, transfer to Da Nang Airport for your flight to Hanoi. Upon arrival, your private driver will meet you and transfer you to your hotel. Enjoy a free evening to explore Hanoi's bustling Old Quarter, perhaps with a cyclo ride or a street food tour." },
          { day: 8, title: "Hanoi City Highlights Tour", details: "Discover Hanoi's rich history and culture on a full-day city tour. Visit the Ho Chi Minh Complex (Mausoleum exterior, Presidential Palace, Stilt House), One Pillar Pagoda, and the Temple of Literature. Explore the vibrant Old Quarter and enjoy a traditional water puppet show. Lunch at a local restaurant." },
          { day: 9, title: "Ninh Binh Full-Day Excursion", details: "Take a full-day trip to Ninh Binh, often called 'Ha Long Bay on land.' Visit Hoa Lu, Vietnam's ancient capital, and take a scenic boat trip through the stunning karst landscapes of Trang An or Tam Coc. Climb to the Mua Cave viewpoint for panoramic views of the rice fields and rivers. Lunch at a local restaurant. Return to Hanoi in the late afternoon." },
          { day: 10, title: "Hanoi Departure", details: "Enjoy a leisurely breakfast at your hotel. Depending on your flight schedule, you'll have free time for last-minute souvenir shopping or a final stroll. Your private driver will transfer you to Noi Bai International Airport (HAN) for your onward departure." }
        ]
      },
      12: {
        id: "vn-12-highlights-detailed",
        name: "Vietnam in 12 Days â€“ Highlights with Ha Long Bay (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Leisure", details: "Arrive at Tan Son Nhat International Airport (SGN), where your private driver will meet you and transfer you to your hotel in Ho Chi Minh City. After check-in, enjoy a relaxed evening, perhaps with a stroll around the vibrant city center or a quiet dinner." },
          { day: 2, title: "Saigon City Tour & Cu Chi Tunnels", details: "Morning: Visit the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers. Learn about their ingenious living conditions and guerrilla tactics. Afternoon: Explore Ho Chi Minh City's highlights including the Reunification Palace, Notre Dame Cathedral, Central Post Office, and Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 3, title: "Mekong Delta Full-Day Excursion", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local markets, and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery before returning to Ho Chi Minh City." },
          { day: 4, title: "Fly to Da Nang & Transfer to Hoi An", details: "After breakfast, transfer to Tan Son Nhat Airport for your flight to Da Nang. Upon arrival, your private driver will transfer you directly to your hotel in Hoi An. In the evening, take a leisurely walk through the enchanting lantern-lit streets of Hoi An Ancient Town." },
          { day: 5, title: "Hoi An Ancient Town & Countryside Discovery", details: "Begin with a walking tour of Hoi An Ancient Town, a UNESCO World Heritage site. Explore the Japanese Covered Bridge, Phuc Kien Assembly Hall, and traditional houses. In the afternoon, choose between a fun basket boat ride in the Coconut Forest or a visit to Tra Que Vegetable Village for a hands-on farming experience. Enjoy a local lunch." },
          { day: 6, title: "Ba Na Hills Full-Day Excursion", details: "Embark on a full-day trip to Ba Na Hills. Take the world's longest cable car ride to the summit, visit the iconic Golden Bridge, explore the beautiful Le Jardin D'Amour gardens, Linh Ung Pagoda, and enjoy the French Village and Fantasy Park. Buffet lunch included. Return to Hoi An in the late afternoon." },
          { day: 7, title: "Fly to Hanoi & Old Quarter Orientation", details: "After breakfast, transfer to Da Nang Airport for your flight to Hanoi. Upon arrival, your private driver will meet you and transfer you to your hotel. Enjoy a free evening to explore Hanoi's bustling Old Quarter, perhaps with a cyclo ride or a street food tour." },
          { day: 8, title: "Hanoi City Highlights Tour", details: "Discover Hanoi's rich history and culture on a full-day city tour. Visit the Ho Chi Minh Complex (Mausoleum exterior, Presidential Palace, Stilt House), One Pillar Pagoda, and the Temple of Literature. Explore the vibrant Old Quarter and enjoy a traditional water puppet show. Lunch at a local restaurant." },
          { day: 9, title: "Hanoi â†’ Ha Long Bay Overnight Cruise", details: "After breakfast, transfer to Ha Long Bay. Upon arrival, embark on an overnight cruise. Enjoy a welcome drink, lunch, and explore a stunning cave. Participate in kayaking or swimming activities, enjoy a sunset party, and a cooking class before dinner onboard. Overnight on the cruise." },
          { day: 10, title: "Ha Long Bay Morning & Return to Hanoi", details: "Start your day with Tai Chi on the sundeck. Enjoy breakfast and visit a floating village or another cave. Brunch will be served onboard as the cruise sails back to the harbor. Disembark and transfer back to your hotel in Hanoi. Enjoy a free evening." },
          { day: 11, title: "Ninh Binh Full-Day Excursion", details: "Take a full-day trip to Ninh Binh, often called 'Ha Long Bay on land.' Visit Hoa Lu, Vietnam's ancient capital, and take a scenic boat trip through the stunning karst landscapes of Trang An or Tam Coc. Climb to the Mua Cave viewpoint for panoramic views of the rice fields and rivers. Lunch at a local restaurant. Return to Hanoi in the late afternoon." },
          { day: 12, title: "Hanoi Departure", details: "Enjoy a leisurely breakfast at your hotel. Depending on your flight schedule, you'll have free time for last-minute souvenir shopping or a final stroll. Your private driver will transfer you to Noi Bai International Airport (HAN) for your onward departure." }
        ]
      },
      14: {
        id: "vn-14-immersion-detailed",
        name: "Private Vietnam Trip 14 Days 13 Nights â€“ Vietnam Immersion (Detailed)",
        days: [
          { day: 1, title: "Arrival in Hanoi", details: "Arrival at Noi Bai Airport, meet guide, transfer to hotel, overnight." },
          { day: 2, title: "Hanoi City Tour Full Day", details: "Ho Chi Minh Complex, One Pillar Pagoda, Temple of Literature, lunch, museums, Train Street, Old Quarter." },
          { day: 3, title: "Ninh Binh Full Day", details: "Trang An boat ride, lunch, Hoa Lu ancient capital, return to Hanoi." },
          { day: 4, title: "Hanoi â€“ Ha Long Bay", details: "Transfer to Ha Long, cruise, cave visit, sunset party, cooking class, dinner onboard." },
          { day: 5, title: "Ha Long â€“ Fly to Da Nang", details: "Tai Chi, breakfast, cave visit, brunch, disembark, transfer to Hanoi airport, flight to Da Nang, hotel check-in." },
          { day: 6, title: "Ba Na Hills Full Day", details: "Cable car to Ba Na Hills, Golden Bridge, gardens, pagoda, Fantasy Park, buffet lunch, French Village, return to Da Nang." },
          { day: 7, title: "Hoi An Walking Tour", details: "Transfer to Hoi An, walking tour of Old Town: Tan Ky House, Assembly Halls, Japanese Bridge, market, free time, return to Da Nang." },
          { day: 8, title: "Da Nang City Tour", details: "Marble Mountain (pagodas, caves, viewpoints), Son Tra Peninsula with Lady Buddha, Cham Museum, Dragon Bridge, Han Market, lunch." },
          { day: 9, title: "Free Day in Da Nang", details: "Full free day for beach, spa, shopping, or optional activities." },
          { day: 10, title: "Fly Da Nang â†’ Ho Chi Minh City", details: "Breakfast, airport transfer, flight to Ho Chi Minh City, pick-up and transfer to hotel, free time." },
          { day: 11, title: "HCMC Highlights + Cu Chi Tunnels", details: "Morning city tour: Reunification Palace, Notre Dame, Central Post Office, War Remnants Museum. Afternoon Cu Chi Tunnels visit, return to HCMC." },
          { day: 12, title: "Mekong Delta â†’ Can Tho", details: "Drive to Mekong Delta, boat trip, island visit, sampan canals, local lunch, continue to Can Tho for overnight." },
          { day: 13, title: "Cai Rang Floating Market â†’ HCMC", details: "Early morning visit to Cai Rang floating market, breakfast on boat, local life experience, return to Ho Chi Minh City." },
          { day: 14, title: "Departure from Ho Chi Minh", details: "Breakfast at hotel, free time depending on flight schedule, private transfer to Tan Son Nhat Airport for departure." }
        ]
      },
      16: {
        id: "vn-16-grand-detailed",
        name: "Vietnam in 16 Days â€“ Coastline & Culture (Detailed)",
        days: [
          { day: 1, title: "Hanoi Arrival & Leisure", details: "Arrive at Noi Bai International Airport (HAN), where your private driver will meet you and transfer you to your hotel in Hanoi. After check-in, enjoy a relaxed evening, perhaps with a stroll around the vibrant Old Quarter or a quiet dinner." },
          { day: 2, title: "Hanoi City Highlights Tour", details: "Discover Hanoi's rich history and culture on a full-day city tour. Visit the Ho Chi Minh Complex (Mausoleum exterior, Presidential Palace, Stilt House), One Pillar Pagoda, and the Temple of Literature. Explore the vibrant Old Quarter and enjoy a traditional water puppet show. Lunch at a local restaurant." },
          { day: 3, title: "Ninh Binh Full-Day Excursion", details: "Take a full-day trip to Ninh Binh, often called 'Ha Long Bay on land.' Visit Hoa Lu, Vietnam's ancient capital, and take a scenic boat trip through the stunning karst landscapes of Trang An or Tam Coc. Climb to the Mua Cave viewpoint for panoramic views of the rice fields and rivers. Lunch at a local restaurant. Return to Hanoi in the late afternoon." },
          { day: 4, title: "Hanoi â†’ Ha Long Bay Overnight Cruise", details: "After breakfast, transfer to Ha Long Bay. Upon arrival, embark on an overnight cruise. Enjoy a welcome drink, lunch, and explore a stunning cave. Participate in kayaking or swimming activities, enjoy a sunset party, and a cooking class before dinner onboard. Overnight on the cruise." },
          { day: 5, title: "Ha Long Bay Morning & Return to Hanoi", details: "Start your day with Tai Chi on the sundeck. Enjoy breakfast and visit a floating village or another cave. Brunch will be served onboard as the cruise sails back to the harbor. Disembark and transfer back to your hotel in Hanoi. Enjoy a free evening." },
          { day: 6, title: "Hanoi â†’ Da Nang Flight & Transfer to Hoi An", details: "After breakfast, transfer to Noi Bai Airport for your flight to Da Nang. Upon arrival, your private driver will transfer you directly to your hotel in Hoi An. In the evening, take a leisurely walk through the enchanting lantern-lit streets of Hoi An Ancient Town." },
          { day: 7, title: "Hoi An Ancient Town & Tra Que Village", details: "Discover the charm of Hoi An Ancient Town, a UNESCO World Heritage site, on a guided walking tour. Visit the iconic Japanese Covered Bridge, the Phuc Kien Assembly Hall, and a traditional merchant's house. In the afternoon, visit Tra Que Vegetable Village for a hands-on farming experience and a local lunch." },
          { day: 8, title: "Hoi An Free Day", details: "Enjoy a full free day in Hoi An for shopping, tailoring, cycling to the beach, or simply relaxing by the river. Overnight in Hoi An." },
          { day: 9, title: "Hoi An â†’ Ba Na Hills Full-Day & Da Nang", details: "Depart for Ba Na Hills: cable car ride, Golden Bridge, Le Jardin d'Amour gardens, Linh Ung Pagoda, Fantasy Park and French Village, with buffet lunch. Transfer to Da Nang for overnight." },
          { day: 10, title: "Da Nang City Highlights Tour", details: "Explore the iconic landmarks of Da Nang on a full-day city tour. Visit Marble Mountain, Son Tra Peninsula (Lady Buddha), and the Cham Museum. Experience the vibrant atmosphere of Han Market and see the Dragon Bridge. Lunch at a local restaurant." },
          { day: 11, title: "Da Nang Free Day", details: "Enjoy a leisurely breakfast and a full free day in Da Nang. You can relax at My Khe Beach, explore more of the city, or indulge in some shopping. Overnight in Da Nang." },
          { day: 12, title: "Da Nang â†’ Ho Chi Minh City Flight", details: "After breakfast, transfer to Da Nang Airport for your flight to Ho Chi Minh City. Upon arrival, your private driver will meet you and transfer you to your hotel. Enjoy a free evening to explore the vibrant city." },
          { day: 13, title: "Ho Chi Minh City Tour & Cu Chi Tunnels", details: "Morning: Visit the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers. Learn about their ingenious living conditions and guerrilla tactics. Afternoon: Explore Ho Chi Minh City's highlights including the Reunification Palace, Notre Dame Cathedral, Central Post Office, and Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 14, title: "Mekong Delta Discovery & Can Tho", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local markets, and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery. Continue to Can Tho for overnight." },
          { day: 15, title: "Cai Rang Floating Market & Return to Ho Chi Minh City", details: "Early morning visit to Cai Rang Floating Market, the largest in the Mekong Delta. Experience the bustling trade from your boat. After a local breakfast, return to Ho Chi Minh City. Enjoy a free afternoon for relaxation or last-minute shopping." },
          { day: 16, title: "Ho Chi Minh City Departure", details: "Enjoy a leisurely breakfast at your hotel. Depending on your flight schedule, you'll have free time for last-minute souvenir shopping or a final stroll. Your private driver will transfer you to Tan Son Nhat International Airport (SGN) for your onward departure." }
        ]
      },
      18: {
        id: "vn-18-extended-detailed",
        name: "Vietnam in 18 Days â€“ Extended North & Central (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Leisure", details: "Arrive at Tan Son Nhat International Airport (SGN), where your private driver will meet you and transfer you to your hotel in Ho Chi Minh City. After check-in, enjoy a relaxed evening, perhaps with a stroll around the vibrant city center or a quiet dinner." },
          { day: 2, title: "Saigon City Highlights Tour", details: "Explore the iconic landmarks of Ho Chi Minh City on a full-day tour. Visit the Reunification Palace, Notre Dame Cathedral, and the historic Central Post Office. Gain insights into the Vietnam War at the War Remnants Museum, and experience the lively atmosphere of Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 3, title: "Mekong Delta Full-Day Excursion", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local markets, and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery before returning to Ho Chi Minh City." },
          { day: 4, title: "Cu Chi Tunnels Half-Day Excursion", details: "In the morning, embark on a half-day trip to the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers during the war. Learn about their ingenious living conditions and guerrilla tactics. You'll have the afternoon free back in Ho Chi Minh City for personal exploration or relaxation." },
          { day: 5, title: "Ho Chi Minh City â†’ Da Nang Flight & Transfer to Hoi An", details: "After breakfast, transfer to Tan Son Nhat Airport for your flight to Da Nang. Upon arrival, your private driver will transfer you directly to your hotel in Hoi An. In the evening, take a leisurely walk through the enchanting lantern-lit streets of Hoi An Ancient Town." },
          { day: 6, title: "Hoi An Ancient Town Walking Tour", details: "Discover the charm of Hoi An Ancient Town, a UNESCO World Heritage site, on a guided walking tour. Visit the iconic Japanese Covered Bridge, the Phuc Kien Assembly Hall, and a traditional merchant's house. Explore the bustling local market and learn about Hoi An's rich history as a trading port. Enjoy a local lunch." },
          { day: 7, title: "Hoi An Countryside Experience or Beach Day", details: "Today, choose your preferred activity: either a delightful countryside experience including a visit to Tra Que Vegetable Village for a hands-on farming lesson and a fun basket boat ride in the Coconut Forest, or a relaxing day at An Bang Beach. Lunch will be arranged according to your choice. Enjoy the evening at leisure in Hoi An." },
          { day: 8, title: "Hoi An Free Day", details: "Enjoy a full free day in Hoi An for shopping, tailoring, cycling to the beach, or simply relaxing by the river. Overnight in Hoi An." },
          { day: 9, title: "Hoi An â†’ Ba Na Hills Full-Day & Da Nang", details: "Depart for Ba Na Hills: cable car ride, Golden Bridge, Le Jardin d'Amour gardens, Linh Ung Pagoda, Fantasy Park and French Village, with buffet lunch. Transfer to Da Nang for overnight." },
          { day: 10, title: "Da Nang City Highlights Tour", details: "Explore the iconic landmarks of Da Nang on a full-day city tour. Visit Marble Mountain, Son Tra Peninsula (Lady Buddha), and the Cham Museum. Experience the vibrant atmosphere of Han Market and see the Dragon Bridge. Lunch at a local restaurant." },
          { day: 11, title: "Da Nang â†’ Hue City Full-Day Tour", details: "Travel to Hue and explore the Ancient Citadel, take a boat on the Perfume River to Thien Mu Pagoda, visit Tu Duc Tomb and browse Dong Ba Market before checking in to your hotel in Hue." },
          { day: 12, title: "Hue â†’ Hanoi Flight", details: "Breakfast, private transfer to Hue airport, short flight to Hanoi, pick-up and transfer to hotel. Free time to experience the Old Quarter in the evening." },
          { day: 13, title: "Hanoi City Highlights Tour", details: "Discover Hanoi's rich history and culture on a full-day city tour. Visit the Ho Chi Minh Complex (Mausoleum exterior, Presidential Palace, Stilt House), One Pillar Pagoda, and the Temple of Literature. Explore the vibrant Old Quarter and enjoy a traditional water puppet show. Lunch at a local restaurant." },
          { day: 14, title: "Ninh Binh Full-Day Excursion", details: "Take a full-day trip to Ninh Binh, often called 'Ha Long Bay on land.' Visit Hoa Lu, Vietnam's ancient capital, and take a scenic boat trip through the stunning karst landscapes of Trang An or Tam Coc. Climb to the Mua Cave viewpoint for panoramic views of the rice fields and rivers. Lunch at a local restaurant. Return to Hanoi in the late afternoon." },
          { day: 15, title: "Hanoi â†’ Ha Long Bay Overnight Cruise", details: "After breakfast, transfer to Ha Long Bay. Upon arrival, embark on an overnight cruise. Enjoy a welcome drink, lunch, and explore a stunning cave. Participate in kayaking or swimming activities, enjoy a sunset party, and a cooking class before dinner onboard. Overnight on the cruise." },
          { day: 16, title: "Ha Long Bay Morning & Return to Hanoi", details: "Start your day with Tai Chi on the sundeck. Enjoy breakfast and visit a floating village or another cave. Brunch will be served onboard as the cruise sails back to the harbor. Disembark and transfer back to your hotel in Hanoi. Enjoy a free evening." },
          { day: 17, title: "Hanoi Free Day / Optional Incense Village", details: "Enjoy a full free day in Hanoi for shopping, cafes, museums, or an optional half-day trip to Quang Phu Cau Incense Village to see traditional incense making. Overnight in Hanoi." },
          { day: 18, title: "Hanoi Departure", details: "Enjoy a leisurely breakfast at your hotel. Depending on your flight schedule, you'll have free time for last-minute souvenir shopping or a final stroll. Your private driver will transfer you to Noi Bai International Airport (HAN) for your onward departure." }
        ]
      },
      20: {
        id: "vn-20-signature-detailed",
        name: "Vietnam in 20 Days â€“ Vietnam & Inland Valleys (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Leisure", details: "Arrive at Tan Son Nhat International Airport (SGN), where your private driver will meet you and transfer you to your hotel in Ho Chi Minh City. After check-in, enjoy a relaxed evening, perhaps with a stroll around the vibrant city center or a quiet dinner." },
          { day: 2, title: "Saigon City Highlights Tour", details: "Explore the iconic landmarks of Ho Chi Minh City on a full-day tour. Visit the Reunification Palace, Notre Dame Cathedral, and the historic Central Post Office. Gain insights into the Vietnam War at the War Remnants Museum, and experience the lively atmosphere of Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 3, title: "Mekong Delta Full-Day Excursion", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local markets, and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery before returning to Ho Chi Minh City." },
          { day: 4, title: "Cu Chi Tunnels Half-Day Excursion", details: "In the morning, embark on a half-day trip to the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers during the war. Learn about their ingenious living conditions and guerrilla tactics. You'll have the afternoon free back in Ho Chi Minh City for personal exploration or relaxation." },
          { day: 5, title: "Ho Chi Minh City â†’ Da Nang Flight & Transfer to Hoi An", details: "After breakfast, transfer to Tan Son Nhat Airport for your flight to Da Nang. Upon arrival, your private driver will transfer you directly to your hotel in Hoi An. In the evening, take a leisurely walk through the enchanting lantern-lit streets of Hoi An Ancient Town." },
          { day: 6, title: "Hoi An Ancient Town Walking Tour", details: "Discover the charm of Hoi An Ancient Town, a UNESCO World Heritage site, on a guided walking tour. Visit the iconic Japanese Covered Bridge, the Phuc Kien Assembly Hall, and a traditional merchant's house. Explore the bustling local market and learn about Hoi An's rich history as a trading port. Enjoy a local lunch." },
          { day: 7, title: "Hoi An Countryside Experience or Beach Day", details: "Today, choose your preferred activity: either a delightful countryside experience including a visit to Tra Que Vegetable Village for a hands-on farming lesson and a fun basket boat ride in the Coconut Forest, or a relaxing day at An Bang Beach. Lunch will be arranged according to your choice. Enjoy the evening at leisure in Hoi An." },
          { day: 8, title: "Hoi An Free Day", details: "Enjoy a full free day in Hoi An for shopping, tailoring, cycling to the beach, or simply relaxing by the river. Overnight in Hoi An." },
          { day: 9, title: "Hoi An â†’ Ba Na Hills Full-Day & Da Nang", details: "Depart for Ba Na Hills: cable car ride, Golden Bridge, Le Jardin d'Amour gardens, Linh Ung Pagoda, Fantasy Park and French Village, with buffet lunch. Transfer to Da Nang for overnight." },
          { day: 10, title: "Da Nang City Highlights Tour", details: "Explore the iconic landmarks of Da Nang on a full-day city tour. Visit Marble Mountain, Son Tra Peninsula (Lady Buddha), and the Cham Museum. Experience the vibrant atmosphere of Han Market and see the Dragon Bridge. Lunch at a local restaurant." },
          { day: 11, title: "Da Nang â†’ Hue City Full-Day Tour", details: "Travel to Hue and explore the Ancient Citadel, take a boat on the Perfume River to Thien Mu Pagoda, visit Tu Duc Tomb and browse Dong Ba Market before checking in to your hotel in Hue." },
          { day: 12, title: "Hue â†’ Hanoi Flight", details: "Breakfast, private transfer to Hue airport, short flight to Hanoi, pick-up and transfer to hotel. Free time to experience the Old Quarter in the evening." },
          { day: 13, title: "Hanoi City Highlights Tour", details: "Discover Hanoi's rich history and culture on a full-day city tour. Visit the Ho Chi Minh Complex (Mausoleum exterior, Presidential Palace, Stilt House), One Pillar Pagoda, and the Temple of Literature. Explore the vibrant Old Quarter and enjoy a traditional water puppet show. Lunch at a local restaurant." },
          { day: 14, title: "Ninh Binh Full-Day Excursion", details: "Take a full-day trip to Ninh Binh, often called 'Ha Long Bay on land.' Visit Hoa Lu, Vietnam's ancient capital, and take a scenic boat trip through the stunning karst landscapes of Trang An or Tam Coc. Climb to the Mua Cave viewpoint for panoramic views of the rice fields and rivers. Lunch at a local restaurant. Return to Hanoi in the late afternoon." },
          { day: 15, title: "Extra Day in Ninh Binh", details: "Extra day in Ninh Binh for slower exploration and village walks. Visit additional temples, enjoy countryside cycling, or explore local craft villages. Overnight in Ninh Binh or return to Hanoi." },
          { day: 16, title: "Hanoi â†’ Sapa by Limousine Bus", details: "Early pick-up by limousine bus for a comfortable 5â€“6 hour journey to Sapa. Check in to your hotel and enjoy free time around Sapa town. Overnight in Sapa." },
          { day: 17, title: "Sapa Trekking â€“ Y Linh Ho, Lao Chai & Ta Van", details: "Guided trek through terraced valleys and minority villages: pass a waterfall and hydro station, visit Y Linh Ho, Lao Chai and Ta Van villages with a simple local lunch en route, then drive back to Sapa." },
          { day: 18, title: "Fansipan Peak & Return to Hanoi", details: "Morning cable car ride to Fansipan, the Roof of Indochina, with time to explore temples and viewpoints. Return to Sapa for lunch, then afternoon limousine bus back to Hanoi, arriving in the evening. Overnight in Hanoi." },
          { day: 19, title: "Hanoi â†’ Ha Long Bay Overnight Cruise", details: "After breakfast, transfer to Ha Long Bay. Upon arrival, embark on an overnight cruise. Enjoy a welcome drink, lunch, and explore a stunning cave. Participate in kayaking or swimming activities, enjoy a sunset party, and a cooking class before dinner onboard. Overnight on the cruise." },
          { day: 20, title: "Ha Long Bay Morning & Return to Hanoi, Departure", details: "Start your day with Tai Chi on the sundeck. Enjoy breakfast and visit a floating village or another cave. Brunch will be served onboard as the cruise sails back to the harbor. Disembark and transfer back to Hanoi. Depending on your flight schedule, transfer to Noi Bai International Airport (HAN) for your onward departure." }
        ]
      },
      21: {
        id: "vn-21-symphony-detailed",
        name: "Private Vietnam 21 Days 20 Nights â€“ Symphony of Vietnam (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival", details: "Arrive at Tan Son Nhat Airport, meet your guide/driver with a name sign, transfer to your central hotel and enjoy free time to rest or explore nearby streets. Overnight in Ho Chi Minh City." },
          { day: 2, title: "Ho Chi Minh City Full Day", details: "City tour including Reunification Palace, Notre Dame Cathedral, Central Post Office, Chinatown, Thien Hau Pagoda, Binh Tay Market, War Remnants Museum and Ben Thanh Market, with lunch at a local restaurant." },
          { day: 3, title: "Mekong Delta Full Day", details: "Drive to My Tho; visit Vinh Trang Pagoda, cruise the Mekong River to islands, enjoy sampan rides through canals, local music, fruit, honey tea and coconut candy workshop before returning to Ho Chi Minh City." },
          { day: 4, title: "Cu Chi Tunnels Half Day", details: "Transfer to Cu Chi; watch an introductory film, explore the multi-level tunnel system, see hidden traps, bunkers, Hoang Cam stove and guerrilla kitchens; taste cassava and tea, optional shooting range, then return to the city." },
          { day: 5, title: "Fly to Da Nang â€“ Hoi An", details: "Transfer to the airport and fly to Da Nang; meet your driver on arrival and continue by road to Hoi An. Check in and enjoy free time in this charming lantern-lit town." },
          { day: 6, title: "Hoi An Walking Half-Day Tour", details: "Explore Hoi An Ancient Town: Tan Ky Old House, Fukien Assembly Hall, Japanese Covered Bridge and Hoi An Market, with time for a cafÃ© stop or lantern-making workshop. Free time in the afternoon." },
          { day: 7, title: "Tra Que & Coconut Palm Forest", details: "Bamboo basket boat trip through the Coconut Palm Forest, then visit Tra Que Vegetable Village for a fresh local lunch and insight into traditional farming. Gentle countryside cycling or walk back to town." },
          { day: 8, title: "Free Day in Hoi An", details: "Enjoy a full free day for shopping, tailoring, cycling to the beach or simply relaxing by the river. Overnight in Hoi An." },
          { day: 9, title: "Ba Na Hills Full Day â€“ Overnight Da Nang", details: "Depart for Ba Na Hills: cable car ride, Golden Bridge, Le Jardin d'Amour gardens, Linh Ung Pagoda, Fantasy Park and French Village, with buffet lunch. Transfer to Da Nang for overnight." },
          { day: 10, title: "Da Nang City Full Day", details: "Discover Marble Mountain, Son Tra Peninsula (Lady Buddha), Cham Museum, Dragon Bridge and Han Market, with lunch at a local restaurant. Overnight in Da Nang." },
          { day: 11, title: "Da Nang â€“ Hue City Full Day", details: "Travel to Hue and explore the Ancient Citadel, take a boat on the Perfume River to Thien Mu Pagoda, visit Tu Duc Tomb and browse Dong Ba Market before checking in to your hotel in Hue." },
          { day: 12, title: "Hue â€“ Fly to Hanoi", details: "Breakfast and free time until transfer to the airport for a short flight to Hanoi. On arrival, transfer to your hotel and relax. Overnight in Hanoi." },
          { day: 13, title: "Hanoi City Full Day", details: "Visit the Ho Chi Minh Complex (Mausoleum exterior as per opening times, Presidential Palace, Stilt House), One Pillar Pagoda, Temple of Literature, a museum (Ethnology or Women's) and explore the Old Quarter, Train Street and Hoan Kiem Lake with Ngoc Son Temple." },
          { day: 14, title: "Hoa Lu â€“ Trang An â€“ Mua Cave", details: "Full-day excursion to Ninh Binh: visit Hoa Lu ancient capital and temples, boat trip through Trang An's caves and karsts, then climb Mua Cave viewpoint for panoramic rice field and river views. Return to Hanoi." },
          { day: 15, title: "Hanoi â€“ Sapa by Limousine Bus", details: "Early pick-up by limousine bus for a comfortable 5â€“6 hour journey to Sapa. Check in to your hotel and enjoy free time around Sapa town. Overnight in Sapa." },
          { day: 16, title: "Sapa Trekking â€“ Y Linh Ho â€“ Lao Chai â€“ Ta Van", details: "Guided trek through terraced valleys and minority villages: pass a waterfall and hydro station, visit Y Linh Ho, Lao Chai and Ta Van villages with a simple local lunch en route, then drive back to Sapa." },
          { day: 17, title: "Sapa â€“ Fansipan Peak â€“ Hanoi", details: "Morning cable car ride to Fansipan, the Roof of Indochina, with time to explore temples and viewpoints. Return to Sapa for lunch, then afternoon limousine bus back to Hanoi. Overnight in Hanoi." },
          { day: 18, title: "Hanoi â€“ Ha Long Bay Overnight Cruise", details: "Shuttle from Hanoi to Ha Long Bay, board your cruise, enjoy welcome drinks and lunch while sailing to Bai Tu Long/Ha Long, visit a cave or do kayaking/swimming, join sunset activities and cooking demonstration, then dinner onboard." },
          { day: 19, title: "Ha Long Bay â€“ Hanoi", details: "Morning Tai Chi and light breakfast, visit another cave or fishing village, early brunch while cruising back to harbor, disembark and take the shuttle back to Hanoi. Overnight in Hanoi." },
          { day: 20, title: "Quang Phu Cau Incense Village", details: "Half-day trip from Hanoi to Quang Phu Cau incense village to see incense production, colorful drying courtyards and meet local artisans. Return to Hanoi for free time in the afternoon." },
          { day: 21, title: "Departure from Hanoi", details: "Breakfast and free time until your private transfer to Noi Bai International Airport for your onward flight." }
        ]
      },
      22: {
        id: "vn-22-panorama-detailed",
        name: "Vietnam Panorama â€“ 22 Days (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh (Saigon) Arrival", details: "Arrival at Tan Son Nhat Airport, meet & greet, private transfer to central hotel, rest & free time." },
          { day: 2, title: "Ho Chi Minh City & Cu Chi Tunnels", details: "Morning: Visit the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers. Afternoon: Explore Ho Chi Minh City's highlights including the Reunification Palace, Notre Dame Cathedral, Central Post Office, and Ben Thanh Market. Lunch at a local restaurant." },
          { day: 3, title: "Ho Chi Minh â€“ Cai Be â€“ Floating Market â€“ Cu Lao An Binh â€“ Vinh Long", details: "Full-day boat program in Cai Be & An Binh Island, traditional crafts, rowboat canals, fruit tasting. Visit Vinh Long and experience local Mekong Delta life. Return to Ho Chi Minh City." },
          { day: 4, title: "Ho Chi Minh â€“ Cat Tien National Park", details: "Drive to Cat Tien National Park, explore the tropical forest, visit wildlife rescue center, and enjoy nature trails. Overnight in Cat Tien or return to Ho Chi Minh City." },
          { day: 5, title: "Ho Chi Minh â€“ Fly to Da Lat â€“ Waterfalls Tour", details: "Transfer to airport, flight to Da Lat. Upon arrival, visit Datanla Waterfall, Prenn Waterfall, and enjoy the cool mountain air. Check in to hotel and free evening." },
          { day: 6, title: "Da Lat â€“ Natural Countryside Landscapes", details: "Explore Da Lat's countryside: visit flower farms, coffee plantations, and ethnic minority villages. Enjoy scenic views of the Central Highlands. Lunch at a local restaurant." },
          { day: 7, title: "Dalat â€“ Fly to Danang â€“ Hoi An", details: "Transfer to Da Lat airport, fly to Da Nang, private transfer to Hoi An hotel. Free evening to explore the lantern-lit Ancient Town." },
          { day: 8, title: "Hoi An Basket Boat, Tra Que Village & Ancient Town Tour", details: "Morning: Basket boat ride in Coconut Forest. Afternoon: Visit Tra Que Vegetable Village for farming experience and local lunch. Evening: Walking tour of Hoi An Ancient Town, visiting Japanese Bridge, Assembly Halls, and traditional houses." },
          { day: 9, title: "Hoi An Cooking Class & My Son Sanctuary", details: "Morning: Visit My Son Sanctuary, a UNESCO World Heritage site with ancient Cham temples. Afternoon: Participate in a cooking class to learn Vietnamese cuisine. Return to Hoi An." },
          { day: 10, title: "Hoi An â€“ Da Nang â€“ Ba Na Hills Full Day", details: "Drive to Ba Na Hills, take cable car to the summit, visit Golden Bridge, Le Jardin d'Amour gardens, Linh Ung Pagoda, Fantasy Park and French Village. Buffet lunch included. Return to Da Nang for overnight." },
          { day: 11, title: "Da Nang City Half-Day Tour", details: "Visit Marble Mountain with pagodas, caves and viewpoints. Explore Son Tra Peninsula with Lady Buddha statue. Visit Cham Museum and Han Market. Lunch at a local restaurant." },
          { day: 12, title: "Danang â€“ Hue City Full-Day Tour", details: "Travel to Hue via Hai Van Pass. Explore the Ancient Citadel, take a boat on the Perfume River to Thien Mu Pagoda, visit Tu Duc Tomb and browse Dong Ba Market. Overnight in Hue." },
          { day: 13, title: "Hue â€“ Phong Nha Cave â€“ Train to Ha Noi", details: "Morning: Drive to Phong Nha, visit Paradise Cave or Phong Nha Cave by boat. Afternoon: Transfer to Dong Hoi station, board overnight train to Hanoi. Overnight on train." },
          { day: 14, title: "Ha Noi â€“ Ha Noi Half-Day Tour", details: "Arrive in Hanoi early morning, transfer to hotel for breakfast and check-in. Afternoon: Half-day city tour including Ho Chi Minh Complex, One Pillar Pagoda, and Temple of Literature. Free evening in Old Quarter." },
          { day: 15, title: "Ha Noi â€“ Bai Dinh â€“ Trang An â€“ Mua Cave Full-Day Tour", details: "Full-day trip to Ninh Binh: visit Bai Dinh Pagoda (largest in Vietnam), boat trip through Trang An's caves and karsts, climb Mua Cave viewpoint for panoramic views. Lunch at a local restaurant. Return to Hanoi." },
          { day: 16, title: "Ninh Binh â€“ Cuc Phuong National Park â€“ Ha Noi", details: "Drive to Cuc Phuong National Park, explore the ancient forest, visit the Endangered Primate Rescue Center, and enjoy nature trails. Return to Hanoi in the late afternoon." },
          { day: 17, title: "Ha Noi â€“ Ha Giang City (Group Tour)", details: "Early morning departure for Ha Giang. Scenic drive through mountain passes. Arrive in Ha Giang City, check in to hotel. Free evening to explore the town." },
          { day: 18, title: "Ha Giang City â€“ Quan Ba â€“ Yen Minh â€“ Dong Van Town (Group Tour)", details: "Continue the Ha Giang loop: visit Quan Ba Heaven's Gate, Yen Minh town, and drive to Dong Van. Visit Dong Van Old Quarter and enjoy mountain scenery. Overnight in Dong Van." },
          { day: 19, title: "Dong Van â€“ Meo Vac (Group Tour)", details: "Drive through Ma Pi Leng Pass, one of Vietnam's most spectacular mountain passes. Visit Meo Vac town and enjoy stunning views of the Nho Que River. Return to Ha Giang or continue to Hanoi." },
          { day: 20, title: "Ha Giang â€“ Ha Noi", details: "Return journey to Hanoi. Arrive in the afternoon, check in to hotel. Free evening for rest or exploration." },
          { day: 21, title: "Ha Noi â€“ Tuan Chau â€“ Ha Long Bay â€“ Lan Ha Bay â€“ Tra Bau", details: "Shuttle to Tuan Chau, board cruise for Lan Ha Bay. Welcome drink and lunch while cruising. Visit Tra Bau area, kayaking or swimming, sunset party, cooking class and dinner onboard. Overnight on cruise." },
          { day: 22, title: "Lan Ha Bay â€“ Cat Ba Island â€“ Tuan Chau â€“ Ha Noi Departure", details: "Morning Tai Chi, breakfast, visit Cat Ba Island or floating village, brunch on board. Disembark at Tuan Chau, transfer back to Hanoi. Depending on flight schedule, transfer to Noi Bai Airport for departure." }
        ]
      },
      24: {
        id: "vn-24-deep-detailed",
        name: "Vietnam in 24 Days â€“ Deep Discovery (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Leisure", details: "Arrive at Tan Son Nhat International Airport (SGN), where your private driver will meet you and transfer you to your hotel in Ho Chi Minh City. After check-in, enjoy a relaxed evening, perhaps with a stroll around the vibrant city center or a quiet dinner." },
          { day: 2, title: "Saigon City Highlights Tour", details: "Explore the iconic landmarks of Ho Chi Minh City on a full-day tour. Visit the Reunification Palace, Notre Dame Cathedral, and the historic Central Post Office. Gain insights into the Vietnam War at the War Remnants Museum, and experience the lively atmosphere of Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 3, title: "Mekong Delta Full-Day Excursion", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local markets, and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery before returning to Ho Chi Minh City." },
          { day: 4, title: "Cu Chi Tunnels Half-Day Excursion", details: "In the morning, embark on a half-day trip to the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers during the war. Learn about their ingenious living conditions and guerrilla tactics. You'll have the afternoon free back in Ho Chi Minh City for personal exploration or relaxation." },
          { day: 5, title: "Ho Chi Minh â€“ Fly to Nha Trang", details: "Breakfast, transfer to airport, flight to Nha Trang, pick up & hotel check-in, free time." },
          { day: 6, title: "Nha Trang City & Mud Spa Tour", details: "Visit Oceanographic Institute, pagoda, cathedral, Cham Po Nagar, mud bath & hot springs, local lunch." },
          { day: 7, title: "Nha Trang Free Day", details: "Beach time, optional island trips, spa or leisure day at your own pace." },
          { day: 8, title: "Nha Trang â€“ Da Lat by Private Car", details: "Late morning departure, scenic mountain road to Da Lat, check-in & free evening." },
          { day: 9, title: "Da Lat City Tour", details: "Bao Dai Summer Palace, cable car, Truc Lam Zen Monastery, Datanla Waterfall, pagodas, flower park." },
          { day: 10, title: "Da Lat Free Day", details: "Free day for cafes, markets, lakes, or optional activities." },
          { day: 11, title: "Da Lat â€“ Fly to Da Nang â€“ Hoi An", details: "Transfer to Da Lat airport, fly to Da Nang, private transfer to Hoi An hotel." },
          { day: 12, title: "Hoi An Walking Tour & Tra Que / Basket Boat", details: "Walking tour of Hoi An Old Town, Tra Que Vegetable Village lunch & activities, basket boat in Coconut Forest." },
          { day: 13, title: "Hoi An Free Day (Tailors, Beach or Spa)", details: "Full free day in Hoi An for shopping, tailoring, beach relaxation, spa treatments, or optional tours." },
          { day: 14, title: "Hoi An â€“ Ba Na Hills Full Day â€“ Da Nang", details: "Cable car to Ba Na Hills, Golden Bridge, Le Jardin D'Amour, Linh Ung Pagoda, Fantasy Park, buffet lunch. Transfer to Da Nang for overnight." },
          { day: 15, title: "Da Nang City Full-Day Tour", details: "Marble Mountain (pagodas, caves, viewpoints), Son Tra Peninsula with Lady Buddha, Cham Museum, Dragon Bridge, Han Market, lunch." },
          { day: 16, title: "Da Nang â€“ Hue City Full-Day Tour", details: "Travel to Hue and explore the Ancient Citadel, take a boat on the Perfume River to Thien Mu Pagoda, visit Tu Duc Tomb and browse Dong Ba Market before checking in to your hotel in Hue." },
          { day: 17, title: "Hue â€“ Fly to Ha Noi", details: "Breakfast, transfer to Hue airport, fly to Hanoi, private transfer & check-in." },
          { day: 18, title: "Ha Noi City Full Day", details: "Ho Chi Minh Complex (Mausoleum exterior, Presidential Palace, Stilt House), One Pillar Pagoda, Temple of Literature, museum (Ethnology or Women's), Train Street, Old Quarter and Hoan Kiem Lake." },
          { day: 19, title: "Ha Noi â€“ Hoa Lu â€“ Trang An â€“ Mua Cave", details: "Full-day excursion to Ninh Binh: visit Hoa Lu ancient capital and temples, boat trip through Trang An's caves and karsts, climb Mua Cave viewpoint for panoramic rice field and river views. Return to Hanoi." },
          { day: 20, title: "Ha Noi â€“ Sa Pa by Limousine Bus", details: "Early pick-up by limousine bus for a comfortable 5â€“6 hour journey to Sapa. Check in to your hotel and enjoy free time around Sapa town. Overnight in Sapa." },
          { day: 21, title: "Sa Pa Trekking â€“ Y Linh Ho â€“ Lao Chai â€“ Ta Van", details: "Guided trek through terraced valleys and minority villages: pass a waterfall and hydro station, visit Y Linh Ho, Lao Chai and Ta Van villages with a simple local lunch en route, then drive back to Sapa." },
          { day: 22, title: "Sa Pa â€“ Fansipan Peak â€“ Ha Noi", details: "Morning cable car ride to Fansipan, the Roof of Indochina, with time to explore temples and viewpoints. Return to Sapa for lunch, then afternoon limousine bus back to Hanoi. Overnight in Hanoi." },
          { day: 23, title: "Ha Noi Free Day (CafÃ©s, Museums and Shopping)", details: "Full free day in Hanoi for cafÃ©s, museums, shopping, or optional tours. Perfect for rest and personal exploration." },
          { day: 24, title: "Ha Noi â€“ Ha Long Bay Overnight Cruise â€“ Ha Noi Departure", details: "Shuttle to Ha Long Bay, board cruise, welcome drinks and lunch, visit cave, kayaking/swimming, sunset party, cooking class, dinner onboard. Next morning: Tai Chi, breakfast, brunch, disembark and return to Hanoi. Transfer to Noi Bai Airport for departure." }
        ]
      },
      26: {
        id: "vn-26-explorer-detailed",
        name: "Vietnam in 26 Days â€“ Mountains, Coast & Countryside (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh City Arrival & Leisure", details: "Arrive at Tan Son Nhat International Airport (SGN), where your private driver will meet you and transfer you to your hotel in Ho Chi Minh City. After check-in, enjoy a relaxed evening, perhaps with a stroll around the vibrant city center or a quiet dinner." },
          { day: 2, title: "Saigon City Highlights Tour", details: "Explore the iconic landmarks of Ho Chi Minh City on a full-day tour. Visit the Reunification Palace, Notre Dame Cathedral, and the historic Central Post Office. Gain insights into the Vietnam War at the War Remnants Museum, and experience the lively atmosphere of Ben Thanh Market. Lunch will be at a local restaurant." },
          { day: 3, title: "Mekong Delta Full-Day Excursion", details: "Journey to the lush Mekong Delta for a full-day tour. Enjoy a boat trip on the Mekong River, visit local markets, and explore traditional villages. Experience a sampan ride through narrow canals and savor a local lunch amidst the tranquil scenery before returning to Ho Chi Minh City." },
          { day: 4, title: "Cu Chi Tunnels Half-Day Excursion", details: "In the morning, embark on a half-day trip to the Cu Chi Tunnels, an intricate underground network used by Viet Cong soldiers during the war. Learn about their ingenious living conditions and guerrilla tactics. You'll have the afternoon free back in Ho Chi Minh City for personal exploration or relaxation." },
          { day: 5, title: "Ho Chi Minh â€“ Fly to Nha Trang", details: "Breakfast, transfer to airport, flight to Nha Trang, pick up & hotel check-in, free time." },
          { day: 6, title: "Nha Trang City & Mud Spa Tour", details: "Visit Oceanographic Institute, pagoda, cathedral, Cham Po Nagar, mud bath & hot springs, local lunch." },
          { day: 7, title: "Nha Trang Free Day", details: "Beach time, optional island trips, spa or leisure day at your own pace." },
          { day: 8, title: "Nha Trang â€“ Da Lat by Private Car", details: "Late morning departure, scenic mountain road to Da Lat, check-in & free evening." },
          { day: 9, title: "Da Lat City Tour", details: "Bao Dai Summer Palace, cable car, Truc Lam Zen Monastery, Datanla Waterfall, pagodas, flower park." },
          { day: 10, title: "Da Lat Free Day (Extra Relaxed Exploration)", details: "Extra free day in Da Lat for cafes, markets, lakes, optional activities, or simply enjoying the cool mountain air at a relaxed pace." },
          { day: 11, title: "Da Lat â€“ Fly to Da Nang â€“ Hoi An", details: "Transfer to Da Lat airport, fly to Da Nang, private transfer to Hoi An hotel." },
          { day: 12, title: "Hoi An Walking Tour & Tra Que / Basket Boat", details: "Walking tour of Hoi An Old Town, Tra Que Vegetable Village lunch & activities, basket boat in Coconut Forest." },
          { day: 13, title: "Hoi An Free Day", details: "Full free day in Hoi An for shopping, tailoring, beach, or optional tours." },
          { day: 14, title: "Hoi An â€“ Ba Na Hills Full Day â€“ Da Nang", details: "Cable car to Ba Na Hills, Golden Bridge, Le Jardin D'Amour, Linh Ung Pagoda, Fantasy Park, buffet lunch. Transfer to Da Nang for overnight." },
          { day: 15, title: "Da Nang City Full-Day Tour", details: "Marble Mountain (pagodas, caves, viewpoints), Son Tra Peninsula with Lady Buddha, Cham Museum, Dragon Bridge, Han Market, lunch." },
          { day: 16, title: "Da Nang â€“ Hue City Full-Day Tour", details: "Travel to Hue and explore the Ancient Citadel, take a boat on the Perfume River to Thien Mu Pagoda, visit Tu Duc Tomb and browse Dong Ba Market before checking in to your hotel in Hue." },
          { day: 17, title: "Hue Free Day (Extra Relaxed Exploration)", details: "Extra free day in Hue for more relaxed exploration: visit additional tombs, enjoy Perfume River activities, explore local markets, or simply relax." },
          { day: 18, title: "Hue â€“ Fly to Ha Noi", details: "Breakfast, transfer to Hue airport, fly to Hanoi, private transfer & check-in." },
          { day: 19, title: "Ha Noi City Full Day", details: "Ho Chi Minh Complex (Mausoleum exterior, Presidential Palace, Stilt House), One Pillar Pagoda, Temple of Literature, museum (Ethnology or Women's), Train Street, Old Quarter and Hoan Kiem Lake." },
          { day: 20, title: "Ha Noi â€“ Hoa Lu â€“ Trang An â€“ Mua Cave", details: "Full-day excursion to Ninh Binh: visit Hoa Lu ancient capital and temples, boat trip through Trang An's caves and karsts, climb Mua Cave viewpoint for panoramic rice field and river views. Return to Hanoi." },
          { day: 21, title: "Ninh Binh â€“ Cuc Phuong National Park â€“ Ha Noi (Additional Village Walks)", details: "Drive to Cuc Phuong National Park, explore the ancient forest, visit the Endangered Primate Rescue Center, enjoy nature trails and additional village walks. Return to Hanoi in the late afternoon." },
          { day: 22, title: "Ha Noi â€“ Ha Giang City (Group Tour)", details: "Early morning departure for Ha Giang. Scenic drive through mountain passes. Arrive in Ha Giang City, check in to hotel. Free evening to explore the town." },
          { day: 23, title: "Ha Giang City â€“ Quan Ba â€“ Yen Minh â€“ Dong Van Town (Group Tour)", details: "Continue the Ha Giang loop: visit Quan Ba Heaven's Gate, Yen Minh town, and drive to Dong Van. Visit Dong Van Old Quarter and enjoy mountain scenery. Overnight in Dong Van." },
          { day: 24, title: "Dong Van â€“ Meo Vac (Group Tour) â€“ Ha Noi", details: "Drive through Ma Pi Leng Pass, one of Vietnam's most spectacular mountain passes. Visit Meo Vac town and enjoy stunning views. Return journey to Hanoi, arriving in the evening." },
          { day: 25, title: "Ha Noi â€“ Ha Long Bay Overnight Cruise", details: "Shuttle to Ha Long Bay, board cruise, welcome drinks and lunch, visit cave, kayaking/swimming, sunset party, cooking class, dinner onboard. Overnight on cruise." },
          { day: 26, title: "Ha Long Bay â€“ Ha Noi Departure", details: "Morning Tai Chi, breakfast, visit floating village or another cave, brunch on board. Disembark and transfer back to Hanoi. Transfer to Noi Bai Airport for departure." }
        ]
      },
      28: {
        id: "vn-28-month-detailed",
        name: "Vietnam in 28 Days â€“ Almost a Full Month (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh (Saigon) Arrival", details: "Arrival at Tan Son Nhat Airport, meet & greet, private transfer to central hotel, rest & free time." },
          { day: 2, title: "Ho Chi Minh â€“ Cai Be â€“ Floating Market â€“ An Binh Island â€“ Vinh Long â€“ Can Tho", details: "Full-day boat program in Cai Be & An Binh Island, traditional crafts, rowboat canals, fruit tasting. Continue to Can Tho for overnight." },
          { day: 3, title: "Can Tho â€“ Cai Rang Floating Market â€“ Ho Chi Minh City", details: "Morning visit to Cai Rang floating market, breakfast on boat, local life experience, return to Ho Chi Minh City." },
          { day: 4, title: "Ho Chi Minh â€“ Flight to Nha Trang", details: "Breakfast, transfer to airport, flight to Nha Trang, pick up & hotel check-in, free time." },
          { day: 5, title: "Nha Trang City & Mud Spa", details: "Oceanographic Institute, pagoda, cathedral, Cham Po Nagar, mud bath & hot springs, local lunch." },
          { day: 6, title: "Nha Trang Free Day", details: "Beach time, optional island trips, spa or leisure day at your own pace." },
          { day: 7, title: "Nha Trang â€“ Da Lat by Private Car", details: "Late morning departure, scenic mountain road to Da Lat, check-in & free evening." },
          { day: 8, title: "Da Lat City Tour", details: "Bao Dai Summer Palace, cable car, Truc Lam Zen Monastery, Datanla Waterfall, pagodas, flower park." },
          { day: 9, title: "Da Lat Free Day", details: "Free day for cafes, markets, lakes, or optional activities." },
          { day: 10, title: "Da Lat â€“ Flight to Da Nang â€“ Hoi An", details: "Transfer to Da Lat airport, fly to Da Nang, private transfer to Hoi An hotel." },
          { day: 11, title: "Hoi An Ancient Town â€“ Tra Que & Basket Boat", details: "Walking tour of Hoi An Old Town, Tra Que Vegetable Village lunch & activities, basket boat in Coconut Forest." },
          { day: 12, title: "Ba Na Hills Day Trip", details: "Cable car to Ba Na Hills, Golden Bridge, Le Jardin D'Amour, Linh Ung Pagoda, Fantasy Park, buffet lunch." },
          { day: 13, title: "My Son Sanctuary Half Day", details: "Morning visit to My Son Hindu temples, Cham dance show, return to Hoi An, afternoon free." },
          { day: 14, title: "Hoi An Free Day", details: "Relax on the beach, tailor visits, lantern streets, or optional tours." },
          { day: 15, title: "Hoi An â€“ Marble Mountain â€“ Hai Van Pass â€“ Hue", details: "Drive via Marble Mountain and Hai Van Pass to Hue, lunch en route, check-in, free time." },
          { day: 16, title: "Hue City Tour", details: "Imperial tombs, Perfume River boat to Thien Mu Pagoda, Tu Duc Tomb, Dong Ba Market, lunch in town." },
          { day: 17, title: "Hue â€“ Flight to Hanoi", details: "Breakfast, transfer to Hue airport, fly to Hanoi, private transfer & check-in." },
          { day: 18, title: "Hanoi City Afternoon Tour by Jeep", details: "Free morning. Afternoon Jeep tour: Old Quarter, Train Street, French Quarter, Ho Chi Minh area, West Lake, street food & egg coffee." },
          { day: 19, title: "Bai Dinh â€“ Trang An â€“ Mua Cave", details: "Full-day trip to Ninh Binh: Bai Dinh Pagoda, Trang An boat caves, climb Mua Cave viewpoint." },
          { day: 20, title: "Quang Phu Cau Incense Village", details: "Half/day or full-day visit to incense-making village, photography & workshop, lunch at local restaurant." },
          { day: 21, title: "Hanoi â€“ Sapa by Limousine Bus", details: "Comfortable transfer to Sapa, check-in, free time to explore Sapa town." },
          { day: 22, title: "Sapa Trek â€“ Cat Cat â€“ Y Linh Ho â€“ Lao Chai â€“ Ta Van", details: "Guided trekking through minority villages & rice terraces, lunch en route, car back to Sapa." },
          { day: 23, title: "Sapa Waterfalls & Passes â€“ O Quy Ho, Silver & Love Waterfalls", details: "Scenic drive through Hoang Lien National Park, visit waterfalls & viewpoints, optional orchard stop." },
          { day: 24, title: "Fansipan Half Day â€“ Return to Hanoi", details: "Cable car to Fansipan summit, temples & views, then limousine bus back to Hanoi." },
          { day: 25, title: "Hanoi Free Day", details: "Full free day in Hanoi for shopping, cafes, museums, or optional tours." },
          { day: 26, title: "Hanoi â€“ Mai Chau", details: "Drive to Mai Chau valley, lunch, afternoon cycling through minority villages, evening cultural show & local rice wine." },
          { day: 27, title: "Mai Chau â€“ Hanoi", details: "Morning village walk, lunch at ecolodge, afternoon transfer back to Hanoi." },
          { day: 28, title: "Hanoi â€“ Ha Long Bay Cruise & Return to Hanoi, Departure", details: "Shuttle to Ha Long, board La Regina Classic Cruise, visit cave, sunset, cooking class & dinner on board. Next morning: Taichi, visit floating village, brunch, disembark & transfer back to Hanoi. Transfer to Noi Bai Airport for departure." }
        ]
      },
      30: {
        id: "vn-30-full-month-detailed",
        name: "Private Vietnam 30 Days 29 Nights â€“ Vietnam Full Month (Detailed)",
        days: [
          { day: 1, title: "Ho Chi Minh (Saigon) Arrival", details: "Arrival at Tan Son Nhat Airport, meet & greet, private transfer to central hotel, rest & free time." },
          { day: 2, title: "Ho Chi Minh â€“ Cai Be Floating Market â€“ An Binh Island â€“ Vinh Long â€“ Can Tho", details: "Full-day boat program in Cai Be & An Binh Island, traditional crafts, rowboat canals, fruit tasting. Continue to Can Tho for overnight." },
          { day: 3, title: "Can Tho â€“ Cai Rang Floating Market â€“ Ho Chi Minh City", details: "Morning visit to Cai Rang floating market, local lunch, transfer back to Ho Chi Minh City." },
          { day: 4, title: "Ho Chi Minh â€“ Flight to Nha Trang", details: "Breakfast, transfer to airport, flight to Nha Trang, pick up & hotel check-in, free time." },
          { day: 5, title: "Nha Trang City & Mud Spa", details: "Oceanographic Institute, pagoda, cathedral, Cham Po Nagar, mud bath & hot springs, local lunch." },
          { day: 6, title: "Nha Trang Free Day", details: "Beach time, optional island trips, spa or leisure day at your own pace." },
          { day: 7, title: "Nha Trang â€“ Da Lat by Private Car", details: "Late morning departure, scenic mountain road to Da Lat, check-in & free evening." },
          { day: 8, title: "Da Lat City Tour", details: "Bao Dai Summer Palace, cable car, Truc Lam Zen Monastery, Datanla Waterfall, pagodas, flower park." },
          { day: 9, title: "Da Lat Free Day", details: "Free day for cafes, markets, lakes, or optional activities." },
          { day: 10, title: "Da Lat â€“ Flight to Da Nang â€“ Hoi An", details: "Transfer to Da Lat airport, fly to Da Nang, private transfer to Hoi An hotel." },
          { day: 11, title: "Hoi An Ancient Town â€“ Tra Que & Basket Boat", details: "Walking tour of Hoi An Old Town, Tra Que Vegetable Village lunch & activities, basket boat in Coconut Forest." },
          { day: 12, title: "Ba Na Hills Day Trip", details: "Cable car to Ba Na Hills, Golden Bridge, Le Jardin D'Amour, Linh Ung Pagoda, Fantasy Park, buffet lunch." },
          { day: 13, title: "My Son Sanctuary Half Day", details: "Morning visit to My Son Hindu temples, Cham dance show, return to Hoi An, afternoon free." },
          { day: 14, title: "Hoi An Free Day", details: "Relax on the beach, tailor visits, lantern streets, or optional tours." },
          { day: 15, title: "Hoi An â€“ Marble Mountain â€“ Hai Van Pass â€“ Hue", details: "Drive via Marble Mountain and Hai Van Pass to Hue, lunch en route, check-in, free time." },
          { day: 16, title: "Hue City Tour", details: "Imperial tombs, Perfume River boat to Thien Mu Pagoda, Tu Duc Tomb, Dong Ba Market, lunch in town." },
          { day: 17, title: "Hue â€“ Flight to Hanoi", details: "Breakfast, transfer to Hue airport, fly to Hanoi, private transfer & check-in." },
          { day: 18, title: "Hanoi City Afternoon Tour by Jeep", details: "Free morning. Afternoon Jeep tour: Old Quarter, Train Street, French Quarter, Ho Chi Minh area, West Lake, street food & egg coffee." },
          { day: 19, title: "Bai Dinh â€“ Trang An â€“ Mua Cave", details: "Full-day trip to Ninh Binh: Bai Dinh Pagoda, Trang An boat caves, climb Mua Cave viewpoint." },
          { day: 20, title: "Quang Phu Cau Incense Village", details: "Half/day or full-day visit to incense-making village, photography & workshop, lunch at local restaurant." },
          { day: 21, title: "Hanoi â€“ Sapa by Limousine Bus", details: "Comfortable transfer to Sapa, check-in, free time to explore Sapa town." },
          { day: 22, title: "Sapa Trek â€“ Cat Cat â€“ Y Linh Ho â€“ Lao Chai â€“ Ta Van", details: "Guided trekking through minority villages & rice terraces, lunch en route, car back to Sapa." },
          { day: 23, title: "Sapa Waterfalls & Passes â€“ O Quy Ho, Silver & Love Waterfalls", details: "Scenic drive through Hoang Lien National Park, visit waterfalls & viewpoints, optional orchard stop." },
          { day: 24, title: "Fansipan Half Day â€“ Return to Hanoi", details: "Cable car to Fansipan summit, temples & views, then limousine bus back to Hanoi." },
          { day: 25, title: "Hanoi Free Day", details: "Full free day in Hanoi for shopping, cafes, museums, or optional tours." },
          { day: 26, title: "Hanoi â€“ Mai Chau", details: "Drive to Mai Chau valley, lunch, afternoon cycling through minority villages, evening cultural show & local rice wine." },
          { day: 27, title: "Mai Chau â€“ Hanoi", details: "Morning village walk, lunch at ecolodge, afternoon transfer back to Hanoi." },
          { day: 28, title: "Hanoi â€“ Ha Long Bay", details: "Shuttle to Ha Long, board La Regina Classic Cruise, visit cave, sunset, cooking class & dinner on board." },
          { day: 29, title: "Ha Long Bay â€“ Hanoi", details: "Taichi, visit floating village (kayak or bamboo boat), brunch, disembark & transfer back to Hanoi." },
          { day: 30, title: "Departure from Hanoi", details: "Free time until private airport transfer for your international departure." }
        ]
      }
    };

    function $(id) { return document.getElementById(id); }

    function formatDate(date) {
      const d = new Date(date);
      if (isNaN(d.getTime())) return "";
      const opts = { day: "2-digit", month: "short", year: "numeric" };
      return d.toLocaleDateString("en-GB", opts);
    }

    function formatDateTime(dateStr, timeStr) {
      if (!dateStr) return "";
      const d = formatDate(dateStr);
      if (!timeStr) return d;
      return `${d} ${timeStr}`;
    }

    function addDays(baseDate, daysToAdd) {
      const d = new Date(baseDate);
      d.setDate(d.getDate() + daysToAdd);
      return d.toISOString().split("T")[0];
    }

    function autoFillEndDate() {
      const startDate = $("startDate").value;
      const numDays = parseInt($("numDays").value, 10) || 1;
      if (startDate) {
        $("endDate").value = addDays(startDate, numDays - 1);
      } else {
        $("endDate").value = "";
      }
    }

    $("startDate").addEventListener("change", autoFillEndDate);
    $("numDays").addEventListener("change", autoFillEndDate);

    function hotelRatingToStars(rating) {
      if (!rating) return "";
      const r = rating.toLowerCase();
      if (r.includes("homestay")) return "Homestay";
      if (r.startsWith("3")) return "â˜…â˜…â˜…â˜†â˜†";
      if (r.startsWith("4")) return "â˜…â˜…â˜…â˜…â˜†";
      if (r.startsWith("5")) return "â˜…â˜…â˜…â˜…â˜…";
      if (r.includes("luxury")) return "â˜…â˜…â˜…â˜…â˜…";
      if (r.includes("mixed")) return "â˜…â˜…â˜…â€“â˜…â˜…â˜…â˜…";
      return rating;
    }

    function parseTimesFromText(text) {
      const result = { arrival: null, departure: null };
      if (!text) return result;
      const lower = text.toLowerCase();
      const timeRegex = /(\d{1,2})[:\.](\d{2})/g;
      const matches = [];
      let m;
      while ((m = timeRegex.exec(lower)) !== null) {
        const hh = m[1].padStart(2, "0");
        const mm = m[2];
        if (parseInt(hh, 10) < 24 && parseInt(mm, 10) < 60) {
          matches.push(`${hh}:${mm}`);
        }
      }
      if (matches[0]) result.arrival = matches[0];
      if (matches[1]) result.departure = matches[1];
      return result;
    }

    function collectTravellerData() {
      let endCity = $("endCity").value || $("startCity").value;
      const specialRequests = $("specialRequests").value.trim();

      let arrivalTime = $("arrivalTime").value;
      let departureTime = $("departureTime").value;

      if (!arrivalTime || !departureTime) {
        const parsed = parseTimesFromText(specialRequests);
        if (!arrivalTime && parsed.arrival) arrivalTime = parsed.arrival;
        if (!departureTime && parsed.departure) departureTime = parsed.departure;
        if (!$("arrivalTime").value && parsed.arrival) $("arrivalTime").value = parsed.arrival;
        if (!$("departureTime").value && parsed.departure) $("departureTime").value = parsed.departure;
      }

      state.traveller = {
        groupName: $("groupName").value.trim(),
        nationality: $("nationality").value,
        ageGroup: $("ageGroup").value,
        numDays: parseInt($("numDays").value, 10) || 1,
        startDate: $("startDate").value,
        endDate: $("endDate").value,
        arrivalTime,
        departureTime,
        area: $("area").value,
        startCity: $("startCity").value,
        endCity,
        tourType: $("tourType").value,
        tourLevel: $("tourLevel").value,
        hotelRating: $("hotelRating").value,
        foodPref: $("foodPref").value,
        specialRequests,
        budgetHint: $("budgetHint").value,
        paceHint: $("paceHint").value
      };
    }

    function getDefaultCityForDay(dayIndex) {
      const { startCity, endCity, numDays } = state.traveller;
      if (numDays <= 1 || !endCity || endCity === startCity) return startCity;
      if (dayIndex === numDays - 1) return endCity;
      return startCity;
    }

    // ====== Geographic routing helpers ======
    const CITY_CORRIDOR = [
      { name: "Ho Chi Minh City", region: "south" },
      { name: "Mekong Delta", region: "south" },
      { name: "Nha Trang", region: "central" },
      { name: "Da Lat", region: "central" },
      { name: "Hoi An", region: "central" },
      { name: "Hue", region: "central" },
      { name: "Phong Nha", region: "central" },
      { name: "Ninh Binh", region: "north" },
      { name: "Hanoi", region: "north" },
      { name: "Ha Long Bay", region: "north" },
      { name: "Sapa", region: "north" }
    ];

    const BIG_STAY_CITIES = new Set([
      "Ho Chi Minh City",
      "Hoi An",
      "Hue",
      "Hanoi",
      "Ha Long Bay",
      "Sapa"
    ]);

    function findCityIndexInCorridor(cityName) {
      if (!cityName) return -1;
      return CITY_CORRIDOR.findIndex(c => c.name === cityName);
    }

    // ========= CAMBODIA EXTENSION CONFIG =========
    const CAMBODIA_BLOCK = ["Phnom Penh", "Siem Reap", "Siem Reap", "Siem Reap"];

    function isCambodiaArea(area) {
      if (!area) return false;
      const a = area.toLowerCase();
      return a.includes("cambodia");
    }

    // Decide at which position to inject the 4-day Cambodia block
    function decideCambodiaInsertionIndex(vnRoute, travellerProfile) {
      if (!Array.isArray(vnRoute) || vnRoute.length === 0) return 0;

      const startCity = travellerProfile.startCity || vnRoute[0];
      const endCity   = travellerProfile.endCity   || vnRoute[vnRoute.length - 1];

      const northCities  = new Set(["Hanoi", "Ninh Binh", "Ha Long Bay", "Sapa"]);
      const southCities  = new Set(["Ho Chi Minh City", "Mekong Delta", "Can Tho"]);
      const centralCities = new Set(["Hoi An", "Hue", "Da Nang", "Da Lat", "Nha Trang", "Phong Nha"]);

      const classify = (city) => {
        if (northCities.has(city)) return "north";
        if (southCities.has(city)) return "south";
        if (centralCities.has(city)) return "central";
        return "other";
      };

      const startRegion = classify(startCity);
      const endRegion   = classify(endCity);
      const len = vnRoute.length;

      // Short trips: inject after day 1
      if (travellerProfile.numDays <= 11 || travellerProfile.numberOfDays <= 11) {
        return Math.min(1, len);
      }

      // North â†’ South: Cambodia roughly in the middle
      if (startRegion === "north" && (endRegion === "south" || endRegion === "central")) {
        return Math.floor(len / 2);
      }

      // South â†’ North: also mid-ish
      if (startRegion === "south" && (endRegion === "north" || endRegion === "central")) {
        return Math.floor(len / 2);
      }

      // Central or unclear: slightly after first third
      return Math.max(1, Math.floor(len / 3));
    }

    // Inject Cambodia 4-day block into an existing Vietnam-only route
    function applyCambodiaExtensionToRoute(vnRoute, travellerProfile) {
      const totalDays = travellerProfile.numDays || travellerProfile.numberOfDays || vnRoute.length;
      const CAMBODIA_DAYS = 4;

      if (!isCambodiaArea(travellerProfile.area)) {
        return vnRoute; // no change
      }

      if (totalDays <= CAMBODIA_DAYS + 1) {
        // Trip too short: just append Cambodia and trim to length
        const mergedShort = [...vnRoute, ...CAMBODIA_BLOCK];
        return mergedShort.slice(0, totalDays);
      }

      const vnDays = totalDays - CAMBODIA_DAYS;
      if (vnDays <= 1) {
        const merged = [...vnRoute.slice(0, 1), ...CAMBODIA_BLOCK];
        return merged.slice(0, totalDays);
      }

      // Compress Vietnam route down to vnDays
      let compressed = [];

      if (vnRoute.length <= vnDays) {
        compressed = vnRoute.slice();
      } else {
        // keep first and last city, distribute others
        compressed.push(vnRoute[0]);
        const remainingSlots = vnDays - 2;
        const innerLen = vnRoute.length - 2;
        for (let i = 0; i < remainingSlots; i++) {
          const idx = 1 + Math.round((i * innerLen) / Math.max(1, remainingSlots - 1));
          compressed.push(vnRoute[idx]);
        }
        compressed.push(vnRoute[vnRoute.length - 1]);
      }

      // Decide where to inject Cambodia in the compressed VN route
      const insertIndex = decideCambodiaInsertionIndex(compressed, travellerProfile);
      const before = compressed.slice(0, insertIndex);
      const after  = compressed.slice(insertIndex);

      let fullRoute = [...before, ...CAMBODIA_BLOCK, ...after];

      // Ensure final length == totalDays
      if (fullRoute.length > totalDays) {
        // Trim from the middle section between first and last city
        const toRemove = fullRoute.length - totalDays;
        const keepStart = Math.ceil((fullRoute.length - toRemove) / 2);
        const prefix = fullRoute.slice(0, keepStart);
        const suffix = fullRoute.slice(fullRoute.length - (totalDays - keepStart));
        fullRoute = [...prefix, ...suffix];
      } else if (fullRoute.length < totalDays) {
        const lastCity = fullRoute[fullRoute.length - 1];
        while (fullRoute.length < totalDays) {
          fullRoute.push(lastCity);
        }
      }

      return fullRoute;
    }

    // Build a geographic route (array of city names) based on start, end, days, and area.
    // Returns null if it cannot find a sensible corridor, so that existing logic can be used instead.
    function buildGeographicRoute(travellerProfile) {
      const startCity = travellerProfile.startCity;
      const endCity = travellerProfile.endCity;
      const days = travellerProfile.numDays || travellerProfile.numberOfDays || 1;
      const area = (travellerProfile.area || "").toLowerCase();

      if (!startCity || !endCity || days <= 0) return null;

      const startIdx = findCityIndexInCorridor(startCity);
      const endIdx = findCityIndexInCorridor(endCity);

      // If we cannot locate both cities, fall back to previous logic
      if (startIdx === -1 || endIdx === -1) return null;

      // If start and end are the same and area is not "country-wide", just stay there
      if (startIdx === endIdx && !area.includes("country-wide") && !area.includes("country wide")) {
        const sameCityRoute = Array.from({ length: days }, () => startCity);
        return applyCambodiaExtensionToRoute(sameCityRoute, travellerProfile);
      }

      const step = startIdx <= endIdx ? 1 : -1;

      // Build the corridor between start and end (inclusive)
      const corridor = [];
      for (let i = startIdx; step === 1 ? i <= endIdx : i >= endIdx; i += step) {
        corridor.push(CITY_CORRIDOR[i].name);
      }

      const corridorCities = corridor.length;

      if (corridorCities === 0) return null;

      // CASE 1: fewer or equal days than corridor cities â†’ compress
      if (days <= corridorCities) {
        if (days === 1) {
          const singleRoute = [corridor[0]];
          return applyCambodiaExtensionToRoute(singleRoute, travellerProfile);
        }
        const route = [];
        for (let d = 0; d < days; d++) {
          const idx = Math.round((d * (corridorCities - 1)) / (days - 1));
          route.push(corridor[idx]);
        }
        return applyCambodiaExtensionToRoute(route, travellerProfile);
      }

      // CASE 2: more days than corridor cities â†’ start with 1 night per city,
      // then distribute extra nights across key hubs.
      const baseNights = new Array(corridorCities).fill(1);
      let extra = days - corridorCities;

      // Give extra nights to big hubs, start, and end, in a round-robin way
      while (extra > 0) {
        for (let i = 0; i < corridorCities && extra > 0; i++) {
          const city = corridor[i];
          const isStart = i === 0;
          const isEnd = i === corridorCities - 1;
          if (BIG_STAY_CITIES.has(city) || isStart || isEnd) {
            baseNights[i] += 1;
            extra -= 1;
          }
        }
      }

      const route = [];
      for (let i = 0; i < corridorCities; i++) {
        for (let n = 0; n < baseNights[i]; n++) {
          route.push(corridor[i]);
        }
      }

      // Apply Cambodia extension if needed
      const finalRoute = applyCambodiaExtensionToRoute(route, travellerProfile);

      return finalRoute;
    }

    function buildCountrywideRoute(startCity, endCity, numberOfDays) {
      // Only handle the common case: 10 days, HCMC -> Sapa (or Hanoi/Sapa combo)
      if (startCity === "Ho Chi Minh City" && (endCity === "Sapa" || endCity === "Hanoi") && numberOfDays === 10) {
        return [
          "Ho Chi Minh City", // Day 1 â€“ arrival & city
          "Ho Chi Minh City", // Day 2 â€“ Cu Chi + city
          "Ho Chi Minh City", // Day 3 â€“ Mekong Delta (return to HCMC)
          "Hoi An",           // Day 4 â€“ fly to Da Nang, transfer to Hoi An
          "Hoi An",           // Day 5 â€“ Hoi An full day
          "Hue",              // Day 6 â€“ Hoi An â†’ Hue via Hai Van
          "Hanoi",            // Day 7 â€“ Hue â†’ Hanoi flight
          "Hanoi",            // Day 8 â€“ Hanoi city
          "Sapa",             // Day 9 â€“ Hanoi â†’ Sapa
          "Sapa"              // Day 10 â€“ Sapa day / departure
        ];
      }

      // Fallback: return null to let existing logic handle other cases
      return null;
    }

    function buildSmartRoute() {
      const t = state.traveller;
      const startCity = t.startCity;
      const endCity = t.endCity;
      const numDays = t.numDays;

      // If no end city, or same city, or too short trip â†’ no smart routing
      if (!startCity || !endCity || startCity === endCity || numDays < 4) {
        return null;
      }

      let corridor = null;

      // Smart corridor between Ho Chi Minh City and Hanoi via Central Vietnam
      if (
        (startCity === "Ho Chi Minh City" && endCity === "Hanoi") ||
        (startCity === "Hanoi" && endCity === "Ho Chi Minh City")
      ) {
        corridor = ["Ho Chi Minh City", "Da Nang", "Hoi An", "Hue", "Hanoi"];
        // If starting from Hanoi, reverse the corridor
        if (startCity === "Hanoi") {
          corridor = corridor.slice().reverse();
        }
      }

      // If no corridor rule matched, fall back to default behaviour
      if (!corridor) return null;

      const pathLen = corridor.length;
      if (numDays === 1) {
        return [startCity];
      }

      // Distribute days along the corridor (start â†’ end, auto-spread middle days)
      const route = [];
      for (let i = 0; i < numDays; i++) {
        const tPos = (i / (numDays - 1)) * (pathLen - 1);
        let idx = Math.round(tPos);
        if (idx < 0) idx = 0;
        if (idx > pathLen - 1) idx = pathLen - 1;
        route.push(corridor[idx]);
      }
      return route;
    }

    // ====== UNIQUE ACTIVITY ENGINE (Option A â€“ Auto Mode) ======

    function assignUniqueActivities(route, days) {
      // Group consecutive days by city
      const stretches = [];
      let currentCity = null;
      let startIndex = 0;

      for (let i = 0; i < route.length; i++) {
        if (route[i] !== currentCity) {
          if (currentCity !== null) {
            stretches.push({
              city: currentCity,
              start: startIndex,
              length: i - startIndex
            });
          }
          currentCity = route[i];
          startIndex = i;
        }
      }
      // push last stretch
      stretches.push({
        city: currentCity,
        start: startIndex,
        length: route.length - startIndex
      });

      // Perform assignment
      stretches.forEach(stretch => {
        const city = stretch.city;
        const len = stretch.length;
        const mList = ACTIVITY_LIBRARY[city]?.morning || [];
        const aList = ACTIVITY_LIBRARY[city]?.afternoon || [];
        const eList = ACTIVITY_LIBRARY[city]?.evening || [];

        // Generic safe fillers
        const genericM = ["Free morning for rest or cafÃ© time."];
        const genericA = ["Optional sightseeing or market visit."];
        const genericE = ["Evening at leisure, suggested night walk."];

        for (let offset = 0; offset < len; offset++) {
          const dayIndex = stretch.start + offset;

          const pick = (list, idx, generic) => {
            if (list.length === 0) return generic[0];
            // Cycle through activities, but use different ones
            const cycleIndex = idx % list.length;
            // If we're cycling, add variation text only if needed
            if (idx >= list.length && cycleIndex === 0) {
              return list[cycleIndex] + " (continued)";
            }
            return list[cycleIndex];
          };

          days[dayIndex].morning   = pick(mList, offset, genericM);
          days[dayIndex].afternoon = pick(aList, offset, genericA);
          days[dayIndex].evening   = pick(eList, offset, genericE);
        }
      });

      return days;
    }

    const ACTIVITY_LIBRARY = {
      "Hanoi": {
        morning: [
          "Ho Chi Minh Mausoleum & Presidential Palace",
          "Visit the Museum of Ethnology",
          "Tran Quoc Pagoda & West Lake walk"
        ],
        afternoon: [
          "Temple of Literature & Old Quarter tour",
          "Hoa Lo Prison Museum",
          "French Quarter walking tour"
        ],
        evening: [
          "Street food tour at Hoan Kiem",
          "Water Puppet Show",
          "Lake night walk + cafÃ©"
        ]
      },

      "Ninh Binh": {
        morning: [
          "Boat trip at Trang An",
          "Tam Coc sampan ride"
        ],
        afternoon: [
          "Bich Dong Pagoda visit",
          "Cuc Phuong nature walk"
        ],
        evening: [
          "Relax at countryside lodge",
          "Riverside dinner"
        ]
      },

      "Phong Nha": {
        morning: [
          "Paradise Cave exploration",
          "Phong Nha Cave boat ride"
        ],
        afternoon: [
          "Phong Nha highlights tour",
          "Eco-trail with local guide"
        ],
        evening: [
          "Relax at farmstay",
          "Dinner by the river"
        ]
      },

      "Hue": {
        morning: [
          "Citadel & Imperial City",
          "Perfume River boat to Thien Mu Pagoda"
        ],
        afternoon: [
          "Tombs of Khai Dinh or Minh Mang",
          "Local handicraft village visit"
        ],
        evening: [
          "Royal-style dinner",
          "Walk along Truong Tien Bridge"
        ]
      },

      "Hoi An": {
        morning: [
          "Basket boat tour in Coconut Forest",
          "Local cooking class"
        ],
        afternoon: [
          "Old Town walking tour (UNESCO)",
          "Silk village visit"
        ],
        evening: [
          "Lantern boat ride",
          "Hoi An night market"
        ]
      },

      "Da Lat": {
        morning: [
          "Bao Dai Palace & Old Railway Station",
          "Crazy House visit"
        ],
        afternoon: [
          "Coffee farm & waterfall tour",
          "Countryside motorbike loop"
        ],
        evening: [
          "Da Lat night market",
          "Warm cafÃ© night"
        ]
      },

      "Nha Trang": {
        morning: [
          "Island-hopping & snorkelling",
          "Cable car to VinWonders"
        ],
        afternoon: [
          "Mud bath & spa experience",
          "Long Son Pagoda visit"
        ],
        evening: [
          "Seafood dinner",
          "Beach night walk"
        ]
      },

      "Mekong Delta": {
        morning: [
          "Cai Be floating market visit",
          "Rural village bicycle ride"
        ],
        afternoon: [
          "Coconut workshop & boat canals",
          "Local craft village"
        ],
        evening: [
          "Homestay dinner",
          "Relaxed riverside walk"
        ]
      },

      "Ho Chi Minh City": {
        morning: [
          "War Remnants Museum",
          "Cu Chi Tunnels"
        ],
        afternoon: [
          "Ben Thanh Market & Coffee Workshop",
          "French Quarter walking tour"
        ],
        evening: [
          "Rooftop bar",
          "Street food night tour"
        ]
      },

      "Phnom Penh": {
        morning: [
          "Royal Palace and Silver Pagoda visit",
          "Tuol Sleng Genocide Museum (S21)"
        ],
        afternoon: [
          "Choeung Ek Killing Fields memorial visit",
          "Central Market or Russian Market shopping"
        ],
        evening: [
          "Sunset cruise on the Mekong River",
          "Street food and riverside walk"
        ]
      },

      "Siem Reap": {
        morning: [
          "Angkor Wat sunrise tour",
          "Bayon Temple at Angkor Thom"
        ],
        afternoon: [
          "Ta Prohm (Tomb Raider temple) visit",
          "Floating village excursion on Tonle Sap"
        ],
        evening: [
          "Apsara dance dinner show",
          "Pub Street and Old Market evening walk"
        ]
      }
    };

    function getActivitiesFor(city, dayPart) {
      const cityData = ACTIVITIES[city];
      if (!cityData || !cityData[dayPart] || cityData[dayPart].length === 0) {
        if (dayPart === "morning") return [`Sightseeing & easy introduction to ${city}.`];
        if (dayPart === "afternoon") return [`Guided highlights tour in ${city}.`];
        return [`Relaxed evening in ${city} with free time.`];
      }
      return cityData[dayPart];
    }

    function getHotelsFor(city) {
      const hotels = HOTEL_OPTIONS[city] || [];
      // Return formatted strings with star ratings: "Hotel Name (4â˜…)"
      return hotels.map(h => {
        if (typeof h === 'string') {
          // Legacy format - return as is
          return h;
        }
        // New format with star rating
        const stars = 'â˜…'.repeat(h.stars);
        return `${h.name} (${h.stars}${stars})`;
      });
    }
    
    // Helper function to extract hotel name without star rating
    function getHotelNameOnly(hotelString) {
      if (!hotelString) return "";
      // Remove star rating if present: "Hotel Name (4â˜…â˜…â˜…â˜…)" -> "Hotel Name"
      return hotelString.replace(/\s*\(\d+â˜…+\)\s*$/, "").trim();
    }

    function getCityCountry(cityName) {
      if (!cityName) return "";
      const cambodiaCities = new Set(["Phnom Penh", "Siem Reap"]);
      return cambodiaCities.has(cityName) ? "Cambodia" : "Vietnam";
    }

    function buildTransferText(prevCity, currentCity) {
      if (!prevCity || !currentCity || prevCity === currentCity) {
        return "Transfer between cities (flight / car / train)â€¦";
      }

      const prevCountry = getCityCountry(prevCity);
      const currCountry = getCityCountry(currentCity);
      const crossBorder = prevCountry !== currCountry && prevCountry !== "" && currCountry !== "";

      if (crossBorder) {
        return `Flight + private car transfer between ${prevCity} (${prevCountry}) and ${currentCity} (${currCountry}). Exact timing and vehicle to be confirmed according to flights and program.`;
      }

      return `Private car transfer between ${prevCity} and ${currentCity}. Exact timing and vehicle to be confirmed according to flights and program.`;
    }

    // Extract route (cities) from itinerary day descriptions
    function extractRouteFromItinerary(itineraryData, isDetailed = false) {
      if (!itineraryData || !itineraryData.days) return null;
      
      const startCity = extractCityName(itineraryData.startsIn);
      const endCity = extractCityName(itineraryData.endsIn);
      const numDays = itineraryData.days.length;
      
      // City mapping for variations
      const cityMap = {
        "Ho Chi Minh City": ["Ho Chi Minh City", "Saigon", "HCMC", "Ho Chi Minh"],
        "Da Nang": ["Da Nang", "Danang"],
        "Hoi An": ["Hoi An", "HoiAn"],
        "Hanoi": ["Hanoi", "Ha Noi"],
        "Sapa": ["Sapa", "Sa Pa"],
        "Ninh Binh": ["Ninh Binh", "NinhBinh"],
        "Ha Long Bay": ["Ha Long Bay", "Halong Bay", "Ha Long", "Halong"],
        "Mekong Delta": ["Mekong Delta", "Mekong"],
        "Can Tho": ["Can Tho", "CanTho"],
        "Nha Trang": ["Nha Trang", "NhaTrang"],
        "Da Lat": ["Da Lat", "Dalat"],
        "Hue": ["Hue"],
        "Mai Chau": ["Mai Chau", "MaiChau"],
        "Phong Nha": ["Phong Nha", "PhongNha"]
      };
      
      const route = [];
      let currentCity = startCity;
      
      if (isDetailed && Array.isArray(itineraryData.days)) {
        // Detailed itinerary: extract from day.details
        itineraryData.days.forEach((dayObj, index) => {
          const dayText = (dayObj.details || "").toLowerCase();
          
          // Check for transfer keywords
          const transferKeywords = ["fly to", "transfer to", "arrive in", "arrive at", "continue to", "travel to", "drive to"];
          let foundTransfer = false;
          
            for (const keyword of transferKeywords) {
              if (dayText.includes(keyword)) {
                // Extract city after transfer keyword - look for city names after the keyword
                const keywordIndex = dayText.indexOf(keyword);
                const textAfterKeyword = dayText.substring(keywordIndex + keyword.length);
                
                for (const [mainCity, variations] of Object.entries(cityMap)) {
                  for (const variant of variations) {
                    // Check if city appears after the transfer keyword
                    if (textAfterKeyword.includes(variant.toLowerCase())) {
                      currentCity = mainCity;
                      foundTransfer = true;
                      break;
                    }
                  }
                  if (foundTransfer) break;
                }
              }
            }
          
          // If no transfer found, check if city is mentioned
          if (!foundTransfer) {
            for (const [mainCity, variations] of Object.entries(cityMap)) {
              for (const variant of variations) {
                if (dayText.includes(variant.toLowerCase())) {
                  currentCity = mainCity;
                  break;
                }
              }
            }
          }
          
          route.push(currentCity);
        });
      } else if (Array.isArray(itineraryData.days)) {
        // Brief itinerary: extract from day strings
        itineraryData.days.forEach((dayStr, index) => {
          if (typeof dayStr === 'string') {
            const dayText = dayStr.toLowerCase();
            
            // Check for transfer keywords first
            const transferKeywords = ["fly to", "transfer to", "arrive in", "arrive at", "continue to", "travel to", "drive to"];
            let foundTransfer = false;
            
            for (const keyword of transferKeywords) {
              if (dayText.includes(keyword)) {
                // Extract city after transfer keyword - look for city names after the keyword
                const keywordIndex = dayText.indexOf(keyword);
                const textAfterKeyword = dayText.substring(keywordIndex + keyword.length);
                
                for (const [mainCity, variations] of Object.entries(cityMap)) {
                  for (const variant of variations) {
                    // Check if city appears after the transfer keyword
                    if (textAfterKeyword.includes(variant.toLowerCase())) {
                      currentCity = mainCity;
                      foundTransfer = true;
                      break;
                    }
                  }
                  if (foundTransfer) break;
                }
              }
            }
            
            // If no transfer found, check if a NEW city is mentioned (don't revert to previous cities)
            if (!foundTransfer) {
              // Only update if we find a different city mentioned
              for (const [mainCity, variations] of Object.entries(cityMap)) {
                if (mainCity === currentCity) continue; // Skip current city
                for (const variant of variations) {
                  if (dayText.includes(variant.toLowerCase())) {
                    // Only switch if it's clearly a new location (not just mentioned in context)
                    // Check if it's the main subject of the day
                    const cityIndex = dayText.indexOf(variant.toLowerCase());
                    const beforeCity = dayText.substring(Math.max(0, cityIndex - 20), cityIndex);
                    // If city appears after keywords like "in", "at", "to", it's likely the location
                    if (/in|at|to|arrive|transfer|fly|visit|explore/.test(beforeCity)) {
                      currentCity = mainCity;
                      break;
                    }
                  }
                }
                if (currentCity !== route[route.length - 1]) break;
              }
            }
            
            route.push(currentCity);
          } else {
            route.push(currentCity);
          }
        });
      }
      
      // Ensure we have the right number of days
      while (route.length < numDays) {
        route.push(route[route.length - 1] || endCity);
      }
      
      // Ensure route starts and ends correctly
      if (route.length > 0) {
        route[0] = startCity;
        route[route.length - 1] = endCity;
      }
      
      // Smart distribution: if route is mostly one city, distribute better
      const uniqueCities = [...new Set(route)];
      
      // Check if we need to redistribute
      const startCityCount = route.filter(c => c === startCity).length;
      const endCityCount = route.filter(c => c === endCity).length;
      
      // If start and end are different but route is heavily skewed, redistribute
      if (startCity !== endCity) {
        // If more than 70% of days are in start city, redistribute
        if (startCityCount / numDays > 0.7) {
          // Find transition point - usually around 60-70% through the trip
          const transitionDay = Math.max(1, Math.floor(numDays * 0.6));
          
          // For short trips (4-6 days), transition earlier
          if (numDays <= 6) {
            const transitionDay = Math.max(1, Math.floor(numDays * 0.5));
            for (let i = 0; i < numDays; i++) {
              if (i < transitionDay) {
                route[i] = startCity;
              } else {
                route[i] = endCity;
              }
            }
          } else {
            // For longer trips, transition around 60-65%
            for (let i = 0; i < numDays; i++) {
              if (i < transitionDay) {
                route[i] = startCity;
              } else {
                route[i] = endCity;
              }
            }
          }
        }
        // If we only found one unique city but start != end, distribute
        else if (uniqueCities.length === 1) {
          const transitionDay = Math.max(1, Math.floor(numDays * 0.5));
          for (let i = 0; i < numDays; i++) {
            if (i < transitionDay) {
              route[i] = startCity;
            } else {
              route[i] = endCity;
            }
          }
        }
      }
      
      // Ensure first and last days are correct
      if (route.length > 0) {
        route[0] = startCity;
        route[route.length - 1] = endCity;
      }
      
      return route.length > 0 ? route : null;
    }
    
    // Extract city name from "City, Country" or "City / City" format
    function extractCityName(locationStr) {
      if (!locationStr) return "";
      // Handle "Da Nang / Hoi An" format - take first city
      let city = locationStr.split(",")[0].trim();
      // If it contains "/", take the first part
      if (city.includes("/")) {
        city = city.split("/")[0].trim();
      }
      return city;
    }
    
    // Load itinerary template into generator
    function loadItineraryIntoGenerator(itineraryData, isDetailed = false) {
      if (!itineraryData) return;
      
      // Extract and store route
      const route = extractRouteFromItinerary(itineraryData, isDetailed);
      state.selectedItineraryTemplate = {
        route: route,
        data: itineraryData,
        isDetailed: isDetailed
      };
      
      // Auto-populate form fields
      if (itineraryData.startsIn) {
        const startCity = extractCityName(itineraryData.startsIn);
        const startCitySelect = $("startCity");
        if (startCitySelect) {
          startCitySelect.value = startCity;
        }
      }
      
      if (itineraryData.endsIn) {
        const endCity = extractCityName(itineraryData.endsIn);
        const endCitySelect = $("endCity");
        if (endCitySelect) {
          endCitySelect.value = endCity;
        }
      }
      
      if (itineraryData.days && Array.isArray(itineraryData.days)) {
        const numDays = itineraryData.days.length;
        const numDaysInput = $("numDays");
        if (numDaysInput) {
          numDaysInput.value = numDays;
          autoFillEndDate(); // Update end date
        }
      }
      
      if (itineraryData.tourType) {
        const tourTypeSelect = $("tourType");
        if (tourTypeSelect && itineraryData.tourType.includes("Private")) {
          tourTypeSelect.value = "Private tour";
        }
      }
      
      // Show success message
      const output = document.getElementById("itineraryArea");
      if (output) {
        output.innerHTML = `
          <div class="alert alert-success" style="padding: 15px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; color: #155724; margin: 20px 0;">
            <strong>âœ“ Itinerary Template Loaded!</strong><br>
            ${isDetailed ? 'Detailed' : 'Brief'} itinerary "${itineraryData.name}" has been loaded into the generator.<br>
            Form fields have been auto-filled. Click "Generate / Refresh Itinerary" to create your customized itinerary.
          </div>
        `;
      }
    }
    
    // Expose function globally for onclick handlers
    window.loadItineraryIntoGenerator = loadItineraryIntoGenerator;

    // Parse brief itinerary day string and extract activities
    function parseBriefDayDescription(dayStr) {
      if (!dayStr || typeof dayStr !== 'string') return { morning: "", afternoon: "", evening: "", transfer: "" };
      
      // Remove "Day X â€“" prefix
      const dayText = dayStr.replace(/^Day \d+[â€“-]\s*/i, "").trim();
      let morning = "";
      let afternoon = "";
      let evening = "";
      let transfer = "";
      
      // Extract transfer information first (before parsing activities)
      const transferPatterns = [
        /fly to [^,.]*/i,
        /transfer to [^,.]*/i,
        /arrive[^,.]*/i,
        /departure[^,.]*/i,
        /continue to [^,.]*/i,
        /travel to [^,.]*/i
      ];
      
      for (const pattern of transferPatterns) {
        const match = dayText.match(pattern);
        if (match) {
          transfer = match[0].trim();
          break;
        }
      }
      
      // Split by colon to separate title from description
      const parts = dayText.split(/[:;]/);
      const titlePart = parts[0] || "";
      const descPart = parts.length > 1 ? parts.slice(1).join(":").trim() : "";
      const mainPart = descPart || dayText;
      
      const lowerText = mainPart.toLowerCase();
      
      // Check for explicit time mentions
      if (lowerText.includes("morning") || lowerText.includes("half-day") && lowerText.includes("morning")) {
        const morningMatch = mainPart.match(/(morning|half-day)[^.]*?\./i);
        if (morningMatch) {
          morning = morningMatch[0].replace(/^(morning|half-day)\s*:?\s*/i, "").replace(/\.$/, "").trim();
        }
      }
      
      if (lowerText.includes("afternoon") || lowerText.includes("half-day") && lowerText.includes("afternoon")) {
        const afternoonMatch = mainPart.match(/afternoon[^.]*?\./i);
        if (afternoonMatch) {
          afternoon = afternoonMatch[0].replace(/^afternoon\s*:?\s*/i, "").replace(/\.$/, "").trim();
        }
      }
      
      if (lowerText.includes("evening") || lowerText.includes("night") || lowerText.includes("lantern")) {
        const eveningMatch = mainPart.match(/(evening|night|lantern)[^.]*?\./i);
        if (eveningMatch) {
          evening = eveningMatch[0].replace(/^(evening|night|lantern)\s*:?\s*/i, "").replace(/\.$/, "").trim();
        }
      }
      
      // If no explicit time mentions, intelligently parse based on content
      if (!morning && !afternoon && !evening) {
        // Check title for activity type
        const titleLower = titlePart.toLowerCase();
        
        // Split description by commas and periods
        const sentences = mainPart.split(/[.,]/).map(s => s.trim()).filter(s => s.length > 3);
        
        // Special handling for common patterns
        if (titleLower.includes("arrival")) {
          // Arrival day - usually evening activities
          if (sentences.length > 0) {
            evening = sentences.join(". ") || mainPart;
          } else {
            evening = mainPart;
          }
        } else if (titleLower.includes("departure") || titleLower.includes("free time")) {
          // Departure or free day
          if (sentences.length > 0) {
            afternoon = sentences[0] || mainPart;
            evening = sentences.slice(1).join(". ") || "Evening at leisure.";
          } else {
            afternoon = mainPart;
            evening = "Evening at leisure.";
          }
        } else if (titleLower.includes("highlights") || titleLower.includes("tour") || titleLower.includes("city")) {
          // City tour or highlights - usually full day, split across morning/afternoon
          if (sentences.length >= 2) {
            morning = sentences[0];
            afternoon = sentences.slice(1).join(". ");
            evening = "Evening at leisure.";
          } else if (sentences.length === 1) {
            // Single sentence - check if it's a list
            const items = sentences[0].split(/[&,]/).map(s => s.trim()).filter(s => s.length > 3);
            if (items.length >= 3) {
              morning = items.slice(0, Math.ceil(items.length / 2)).join(", ");
              afternoon = items.slice(Math.ceil(items.length / 2)).join(", ");
              evening = "Evening at leisure.";
            } else {
              afternoon = sentences[0];
              evening = "Evening at leisure.";
            }
          } else {
            afternoon = mainPart;
            evening = "Evening at leisure.";
          }
        } else if (titleLower.includes("half-day") || titleLower.includes("half day")) {
          // Half-day activity
          if (lowerText.includes("morning")) {
            morning = mainPart.replace(/morning/i, "").trim();
            afternoon = "Free afternoon.";
            evening = "Evening at leisure.";
          } else {
            morning = "Free morning.";
            afternoon = mainPart.replace(/afternoon/i, "").trim();
            evening = "Evening at leisure.";
          }
        } else {
          // Default: distribute activities
          if (sentences.length >= 3) {
            morning = sentences[0];
            afternoon = sentences[1];
            evening = sentences.slice(2).join(". ");
          } else if (sentences.length === 2) {
            morning = sentences[0];
            afternoon = sentences[1];
            evening = "Evening at leisure.";
          } else if (sentences.length === 1) {
            // Check if it's a list of items
            const items = sentences[0].split(/[&,]/).map(s => s.trim()).filter(s => s.length > 3);
            if (items.length >= 2) {
              morning = items[0];
              afternoon = items.slice(1).join(", ");
              evening = "Evening at leisure.";
            } else {
              afternoon = sentences[0];
              evening = "Evening at leisure.";
            }
          } else {
            afternoon = mainPart || titlePart;
            evening = "Evening at leisure.";
          }
        }
      }
      
      // Clean up: remove transfer text from activities
      if (transfer) {
        const transferClean = transfer.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        morning = morning.replace(new RegExp(transferClean, "gi"), "").trim();
        afternoon = afternoon.replace(new RegExp(transferClean, "gi"), "").trim();
        evening = evening.replace(new RegExp(transferClean, "gi"), "").trim();
      }
      
      // Clean up empty strings and normalize
      morning = morning.replace(/^[.,]\s*/, "").trim();
      afternoon = afternoon.replace(/^[.,]\s*/, "").trim();
      evening = evening.replace(/^[.,]\s*/, "").trim();
      
      return { 
        morning: morning || "", 
        afternoon: afternoon || "", 
        evening: evening || "", 
        transfer: transfer || "" 
      };
    }
    
    // Parse detailed itinerary day object and extract activities
    function parseDetailedDayDescription(dayObj) {
      if (!dayObj || !dayObj.details) return { morning: "", afternoon: "", evening: "", transfer: "" };
      
      const details = dayObj.details;
      let morning = "";
      let afternoon = "";
      let evening = "";
      let transfer = "";
      
      // Extract transfer information
      const transferKeywords = ["transfer", "fly to", "arrive", "departure", "continue to", "travel to", "drive to"];
      for (const keyword of transferKeywords) {
        if (details.toLowerCase().includes(keyword)) {
          const keywordIndex = details.toLowerCase().indexOf(keyword);
          const sentenceStart = Math.max(0, details.lastIndexOf(".", keywordIndex) + 1);
          const sentenceEnd = details.indexOf(".", keywordIndex);
          if (sentenceEnd !== -1) {
            transfer = details.substring(sentenceStart, sentenceEnd + 1).trim();
            break;
          }
        }
      }
      
      // Split by sentences and look for time indicators
      const sentences = details.split(/[.!?]+/).map(s => s.trim()).filter(s => s.length > 10);
      const lowerDetails = details.toLowerCase();
      
      // Check for explicit time mentions
      let morningSentences = [];
      let afternoonSentences = [];
      let eveningSentences = [];
      
      sentences.forEach(sentence => {
        const lower = sentence.toLowerCase();
        if (lower.includes("morning") || lower.includes("breakfast") || lower.includes("early")) {
          morningSentences.push(sentence);
        } else if (lower.includes("afternoon") || lower.includes("lunch") || lower.includes("midday")) {
          afternoonSentences.push(sentence);
        } else if (lower.includes("evening") || lower.includes("night") || lower.includes("dinner") || lower.includes("sunset")) {
          eveningSentences.push(sentence);
        }
      });
      
      // If we found time-specific sentences, use them
      if (morningSentences.length > 0) {
        morning = morningSentences.join(" ").trim();
      }
      if (afternoonSentences.length > 0) {
        afternoon = afternoonSentences.join(" ").trim();
      }
      if (eveningSentences.length > 0) {
        evening = eveningSentences.join(" ").trim();
      }
      
      // If no time-specific sentences, intelligently distribute
      if (!morning && !afternoon && !evening) {
        // Check title for clues
        const title = (dayObj.title || "").toLowerCase();
        if (title.includes("arrival") || title.includes("departure")) {
          // Arrival/departure days - activities are usually afternoon/evening
          if (sentences.length >= 2) {
            afternoon = sentences[0];
            evening = sentences.slice(1).join(" ");
          } else if (sentences.length === 1) {
            evening = sentences[0];
          }
        } else {
          // Regular activity day - distribute across morning/afternoon/evening
          const totalSentences = sentences.length;
          if (totalSentences >= 3) {
            morning = sentences[0];
            afternoon = sentences[1];
            evening = sentences.slice(2).join(" ");
          } else if (totalSentences === 2) {
            morning = sentences[0];
            afternoon = sentences[1];
            evening = "Evening at leisure.";
          } else if (totalSentences === 1) {
            afternoon = sentences[0];
            evening = "Evening at leisure.";
          }
        }
      }
      
      // Clean up transfer from activity descriptions
      if (transfer) {
        morning = morning.replace(new RegExp(transfer.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), "gi"), "").trim();
        afternoon = afternoon.replace(new RegExp(transfer.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), "gi"), "").trim();
        evening = evening.replace(new RegExp(transfer.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), "gi"), "").trim();
      }
      
      return { 
        morning: morning || "", 
        afternoon: afternoon || "", 
        evening: evening || "", 
        transfer: transfer || "",
        title: dayObj.title || ""
      };
    }

    // Picture gallery functions
    function parsePictureData(pictureNotes) {
      if (!pictureNotes) return [];
      try {
        const data = JSON.parse(pictureNotes);
        return Array.isArray(data) ? data : [];
      } catch (e) {
        // Legacy format - might be URLs separated by newlines or commas
        if (pictureNotes.includes('http') || pictureNotes.includes('data:image')) {
          return pictureNotes.split(/[\n,]/).filter(url => url.trim().length > 0).map(url => url.trim());
        }
        return [];
      }
    }
    
    function savePictureData(dayIndex, images) {
      if (!state.daysData[dayIndex]) return;
      state.daysData[dayIndex].pictureNotes = JSON.stringify(images);
      renderItinerary();
    }
    
    function renderPictureGallery(pictureNotes, dayIndex) {
      const images = parsePictureData(pictureNotes);
      if (images.length === 0) {
        return `<div class="picture-gallery-placeholder">
          <span>Drag & drop 2-3 images here<br>or click to browse</span>
        </div>`;
      }
      
      // Limit to 3 images
      const displayImages = images.slice(0, 3);
      return displayImages.map((img, idx) => `
        <div class="picture-gallery-item">
          <img src="${img}" alt="Day ${dayIndex + 1} photo ${idx + 1}">
          <button class="remove-btn" onclick="removePicture(${dayIndex}, ${idx})" title="Remove image">Ã—</button>
        </div>
      `).join('');
    }
    
    function handleDragOver(e) {
      e.preventDefault();
      e.stopPropagation();
      e.currentTarget.classList.add('drag-over');
    }
    
    function handleDragLeave(e) {
      e.preventDefault();
      e.stopPropagation();
      e.currentTarget.classList.remove('drag-over');
    }
    
    function handleImageDrop(e, dayIndex) {
      e.preventDefault();
      e.stopPropagation();
      e.currentTarget.classList.remove('drag-over');
      
      const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
      if (files.length === 0) return;
      
      processImageFiles(files, dayIndex);
    }
    
    function handleFileSelect(e, dayIndex) {
      const files = Array.from(e.target.files).filter(file => file.type.startsWith('image/'));
      if (files.length === 0) return;
      
      processImageFiles(files, dayIndex);
      e.target.value = ''; // Reset input
    }
    
    function processImageFiles(files, dayIndex) {
      const currentImages = parsePictureData(state.daysData[dayIndex]?.pictureNotes || '');
      const newImages = [];
      let processed = 0;
      const maxImages = 3;
      
      files.forEach(file => {
        if (currentImages.length + newImages.length >= maxImages) return;
        
        const reader = new FileReader();
        reader.onload = (e) => {
          newImages.push(e.target.result);
          processed++;
          
          if (processed === Math.min(files.length, maxImages - currentImages.length)) {
            const allImages = [...currentImages, ...newImages].slice(0, maxImages);
            savePictureData(dayIndex, allImages);
          }
        };
        reader.readAsDataURL(file);
      });
    }
    
    function removePicture(dayIndex, imageIndex) {
      const currentImages = parsePictureData(state.daysData[dayIndex]?.pictureNotes || '');
      currentImages.splice(imageIndex, 1);
      savePictureData(dayIndex, currentImages);
    }
    
    // Expose functions globally for inline handlers
    window.handleImageDrop = handleImageDrop;
    window.handleDragOver = handleDragOver;
    window.handleDragLeave = handleDragLeave;
    window.handleFileSelect = handleFileSelect;
    window.removePicture = removePicture;
    window.renderPictureGallery = renderPictureGallery;

    function generateDaysData() {
      const t = state.traveller;
      state.daysData = [];

      // Check for loaded itinerary template first
      // BUT: only use it if it has intermediate cities (more than just start/end)
      if (state.selectedItineraryTemplate && state.selectedItineraryTemplate.route) {
        let templateRoute = [...state.selectedItineraryTemplate.route]; // Copy array
        
        // Always ensure route matches numDays
        if (templateRoute.length !== t.numDays) {
          while (templateRoute.length < t.numDays) {
            templateRoute.push(templateRoute[templateRoute.length - 1] || t.startCity);
          }
          templateRoute = templateRoute.slice(0, t.numDays);
        }
        
        // Check if template route has intermediate cities
        const uniqueCities = [...new Set(templateRoute)];
        const hasIntermediateCities = uniqueCities.length > 2 || 
          (uniqueCities.length === 2 && t.startCity && t.endCity && 
           uniqueCities.includes(t.startCity) && uniqueCities.includes(t.endCity) &&
           templateRoute.filter(c => c !== t.startCity && c !== t.endCity).length > 0);
        
        // If start and end are different but route lacks intermediate cities, skip template route
        if (t.startCity && t.endCity && t.startCity !== t.endCity && !hasIntermediateCities) {
          // Template route is too simple - skip it and use geographic route instead
          state.selectedItineraryTemplate = null;
        } else {
          // Template route is good - use it but ensure first/last days are correct
          if (t.startCity && t.endCity) {
            templateRoute[0] = t.startCity;
            templateRoute[t.numDays - 1] = t.endCity;
          }
          
          if (templateRoute.length === t.numDays) {
          // Use template route - build full day objects with actual itinerary activities
          for (let i = 0; i < t.numDays; i++) {
            const city = templateRoute[i] || t.startCity;
            const date = t.startDate ? addDays(t.startDate, i) : null;

            const morningOptions = getActivitiesFor(city, "morning");
            const afternoonOptions = getActivitiesFor(city, "afternoon");
            const eveningOptions = getActivitiesFor(city, "evening");

            const prevCity = i === 0 ? null : state.daysData[i - 1]?.city;
            let transfer = buildTransferText(prevCity, city);

            // Parse activities from itinerary template
            let morning = morningOptions[0] || "";
            let afternoon = afternoonOptions[0] || "";
            let evening = eveningOptions[0] || "";
            
            // Use activities from loaded itinerary template
            const template = state.selectedItineraryTemplate;
            if (template && template.data && template.data.days && Array.isArray(template.data.days) && template.data.days[i]) {
              const dayData = template.data.days[i];
              
              if (template.isDetailed && typeof dayData === 'object' && dayData.details) {
                // Detailed itinerary: parse day object with title and details
                const parsed = parseDetailedDayDescription(dayData);
                if (parsed.morning) morning = parsed.morning;
                if (parsed.afternoon) afternoon = parsed.afternoon;
                if (parsed.evening) evening = parsed.evening;
                if (parsed.transfer) {
                  transfer = parsed.transfer;
                }
              } else if (!template.isDetailed && typeof dayData === 'string') {
                // Brief itinerary: parse day string
                const parsed = parseBriefDayDescription(dayData);
                if (parsed.morning) morning = parsed.morning;
                if (parsed.afternoon) afternoon = parsed.afternoon;
                if (parsed.evening) evening = parsed.evening;
                if (parsed.transfer) {
                  transfer = parsed.transfer;
                }
              }
            }
            
            // Add airport pick-up/drop-off if needed
            if (i === 0 && t.arrivalTime) {
              if (transfer && !transfer.toLowerCase().includes("pick-up") && !transfer.toLowerCase().includes("arrival")) {
                transfer += (transfer ? " " : "") + `Airport pick-up according to arrival at ${t.arrivalTime}.`;
              } else if (!transfer) {
                transfer = `Airport pick-up according to arrival at ${t.arrivalTime}.`;
              }
            }
            if (i === t.numDays - 1 && t.departureTime) {
              if (transfer && !transfer.toLowerCase().includes("drop-off") && !transfer.toLowerCase().includes("departure")) {
                transfer += (transfer ? " " : "") + `Airport drop-off according to departure at ${t.departureTime}.`;
              } else if (!transfer) {
                transfer = `Airport drop-off according to departure at ${t.departureTime}.`;
              }
            }
            
            // If no transfer was set, use default
            if (!transfer && prevCity && prevCity !== city) {
              transfer = buildTransferText(prevCity, city);
            } else if (!transfer) {
              transfer = "Transfer details to be confirmed.";
            }

            state.daysData.push({
              dayIndex: i,
              label: `Day ${i + 1}`,
              city,
              date,
              hotelCity: city,
              hotelName: getHotelNameOnly(getHotelsFor(city)[0] || ""),
              transfer,
              morning,
              afternoon,
              evening,
              morningOptions,
              afternoonOptions,
              eveningOptions,
              pictureNotes: ""
            });
            }
            // Don't call assignUniqueActivities - we're using the actual itinerary activities
            return; // Early return - template route handled
          } else {
            // Template route length doesn't match - clear it and fall through
            state.selectedItineraryTemplate = null;
          }
        }
      }

      // Check for geographic route first (includes intermediate cities like Da Nang, Hoi An, Hue, etc.)
      const geoRoute = buildGeographicRoute(t);
      if (geoRoute && Array.isArray(geoRoute) && geoRoute.length === t.numDays) {
        // Use geographic route - it includes all intermediate cities
        // Use geographic route - build full day objects
        for (let i = 0; i < t.numDays; i++) {
          const city = geoRoute[i];
          const date = t.startDate ? addDays(t.startDate, i) : null;

          const morningOptions = getActivitiesFor(city, "morning");
          const afternoonOptions = getActivitiesFor(city, "afternoon");
          const eveningOptions = getActivitiesFor(city, "evening");

          const prevCity = i === 0 ? null : state.daysData[i - 1]?.city;
          let transfer = buildTransferText(prevCity, city);

          // add airport pick-up / drop-off automatically on first/last day
          if (i === 0 && t.arrivalTime) {
            transfer += (transfer ? " " : "") + `Airport pick-up according to arrival at ${t.arrivalTime}.`;
          }
          if (i === t.numDays - 1 && t.departureTime) {
            transfer += (transfer ? " " : "") + `Airport drop-off according to departure at ${t.departureTime}.`;
          }

          state.daysData.push({
            dayIndex: i,
            label: `Day ${i + 1}`,
            city,
            date,
            hotelCity: city,
            hotelName: getHotelsFor(city)[0] || "",
            transfer,
            morning: morningOptions[0] || "",
            afternoon: afternoonOptions[0] || "",
            evening: eveningOptions[0] || "",
            morningOptions,
            afternoonOptions,
            eveningOptions,
            pictureNotes: ""
          });
        }
        assignUniqueActivities(geoRoute, state.daysData);
        return; // Early return - geographic route handled
      }

      // Check for country-wide route
      let countrywideRoute = (t.area === "Vietnam â€“ Country-wide" || t.area === "Country-wide")
        ? buildCountrywideRoute(t.startCity, t.endCity, t.numDays)
        : null;
      
      // Apply Cambodia extension to countrywide route if needed
      if (countrywideRoute) {
        countrywideRoute = applyCambodiaExtensionToRoute(countrywideRoute, t);
      }

      // Try to build a smart route (e.g. HCMC â†’ Da Nang â†’ Hoi An â†’ Hue â†’ Hanoi)
      let smartRoute = buildSmartRoute();
      
      // Apply Cambodia extension to smart route if needed
      if (smartRoute) {
        smartRoute = applyCambodiaExtensionToRoute(smartRoute, t);
      }

      for (let i = 0; i < t.numDays; i++) {
        let city;
        if (countrywideRoute && countrywideRoute[i]) {
          // Use country-wide route
          city = countrywideRoute[i];
        } else if (smartRoute && smartRoute[i]) {
          // Use smart route
          city = smartRoute[i];
        } else {
          // Use default logic
          city = getDefaultCityForDay(i);
        }
        const date = t.startDate ? addDays(t.startDate, i) : null;

        const morningOptions = getActivitiesFor(city, "morning");
        const afternoonOptions = getActivitiesFor(city, "afternoon");
        const eveningOptions = getActivitiesFor(city, "evening");

        const prevCity = i === 0 ? null : state.daysData[i - 1]?.city;
        let transfer = buildTransferText(prevCity, city);

        // add airport pick-up / drop-off automatically on first/last day
        if (i === 0 && t.arrivalTime) {
          transfer += (transfer ? " " : "") + `Airport pick-up according to arrival at ${t.arrivalTime}.`;
        }
        if (i === t.numDays - 1 && t.departureTime) {
          transfer += (transfer ? " " : "") + `Airport drop-off according to departure at ${t.departureTime}.`;
        }

        state.daysData.push({
          dayIndex: i,
          label: `Day ${i + 1}`,
          city,
          date,
          hotelCity: city,
          hotelName: getHotelsFor(city)[0] || "",
          transfer,
          morning: morningOptions[0] || "",
          afternoon: afternoonOptions[0] || "",
          evening: eveningOptions[0] || "",
          morningOptions,
          afternoonOptions,
          eveningOptions,
          pictureNotes: ""
        });
      }
      
      // Build route array from days and assign unique activities
      const routeArray = state.daysData.map(d => d.city);
      assignUniqueActivities(routeArray, state.daysData);
    }

    function renderItinerary() {
      const t = state.traveller;
      const cont = $("itineraryArea");

      if (!t || !t.numDays) {
        cont.innerHTML = "<p>Please fill the form on the left and click <b>Generate / Refresh Itinerary</b>.</p>";
        return;
      }

      function getItineraryTitle(itinerary) {
        const groupName = itinerary.groupName && itinerary.groupName.trim()
          ? itinerary.groupName.trim()
          : "Unnamed group";

        const numDays = Array.isArray(itinerary.days)
          ? itinerary.days.length
          : itinerary.numDays || itinerary.duration || 0;

        const areaLabel = itinerary.area && itinerary.area.trim()
          ? itinerary.area.trim()
          : "Vietnam";

        return `${groupName} â€“ ${numDays} days in ${areaLabel}`;
      }

      const headerTitle = getItineraryTitle(t);
      const brandHeaderHtml = `
        <header class="brand-header">
          <div class="brand-header-left">
            <img src="vht_logo.png" alt="VHT Vietnam Holiday Tours logo" class="brand-logo">
            <div class="brand-title-block">
              <div class="brand-title">VHT â€“ Vietnam Holiday Tours</div>
              <div class="brand-subtitle">Tailor-made itinerary proposal</div>
            </div>
          </div>
        </header>
      `;
      let headerHtml = `
        <div class="itinerary-header">
          <h2>${headerTitle}</h2>
          <section class="trip-meta-card">
            <div class="itinerary-header-row">
              ${
                t.startDate
                  ? `<div class="badge"><span>Dates</span>${formatDateTime(t.startDate, t.arrivalTime)}${
                      t.endDate ? " â†’ " + formatDateTime(t.endDate, t.departureTime) : ""
                    }</div>`
                  : ""
              }
              ${t.area ? `<div class="badge"><span>Area</span>${t.area}</div>` : ""}
              ${t.nationality ? `<div class="badge"><span>Nationality</span>${t.nationality}</div>` : ""}
              ${t.ageGroup ? `<div class="badge"><span>Age</span>${t.ageGroup}</div>` : ""}
              ${t.tourType ? `<div class="badge"><span>Type</span>${t.tourType}</div>` : ""}
              ${t.tourLevel ? `<div class="badge"><span>Level</span>${t.tourLevel}</div>` : ""}
              ${t.hotelRating ? `<div class="badge"><span>Hotels</span>${t.hotelRating}</div>` : ""}
              ${t.foodPref ? `<div class="badge"><span>Food</span>${t.foodPref}</div>` : ""}
              ${t.startCity ? `<div class="badge"><span>Start</span>${t.startCity}</div>` : ""}
              ${t.endCity ? `<div class="badge"><span>End</span>${t.endCity}</div>` : ""}
              ${t.budgetHint ? `<div class="badge"><span>Budget</span>${t.budgetHint}</div>` : ""}
            </div>
            ${t.specialRequests ? `<div style="margin-top:6px;font-size:12px;"><b>Special requests:</b> ${t.specialRequests}</div>` : ""}
            ${t.paceHint ? `<div style="margin-top:4px;font-size:12px;"><b>Pace note:</b> ${t.paceHint}</div>` : ""}
          </section>
        </div>
      `;

      function citySelect(dayIndex, currentCity) {
        // Collect all known cities from hotels and from the geographic corridor
        const hotelCities = HOTEL_OPTIONS ? Object.keys(HOTEL_OPTIONS) : [];
        const corridorCities = CITY_CORRIDOR ? CITY_CORRIDOR.map(c => c.name) : [];
        const allCities = Array.from(new Set([...hotelCities, ...corridorCities]));

        // Decide what should be selected:
        // 1) use the city passed in (currentCity),
        // 2) otherwise fall back to itineraryState if available,
        // 3) otherwise nothing selected.
        const stateCity =
          (window.itineraryState &&
            Array.isArray(window.itineraryState.days) &&
            window.itineraryState.days[dayIndex] &&
            window.itineraryState.days[dayIndex].city) ||
          "";
        const selectedCity = currentCity || stateCity || "";

        return `
          <select data-day="${dayIndex}" data-field="city" class="city-select"
                  style="font-size:12px;padding:4px 6px;border-radius:6px;border:1px solid #ccc;">
            ${allCities
              .map(city => {
                const sel = city === selectedCity ? ' selected="selected"' : "";
                return `<option value="${city}"${sel}>${city}</option>`;
              })
              .join("")}
          </select>
        `;
      }

      let cambodiaHeaderShown = false;
      let daysHtml = state.daysData.map(d => {
        const city = d.city || "";
        const isCambodiaCity = city === "Phnom Penh" || city === "Siem Reap";
        
        // Insert header once before the first Cambodia day
        let cambodiaDividerHtml = "";
        if (isCambodiaCity && !cambodiaHeaderShown) {
          cambodiaHeaderShown = true;
          cambodiaDividerHtml = `
            <div class="cambodia-divider" style="background: linear-gradient(135deg, #d4af37, #f4d03f); color: #fff; padding: 16px 20px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
              <h2 style="margin: 0 0 6px; font-size: 18px; font-weight: 600;">ðŸ‡°ðŸ‡­ Cambodia Extension (4 Days)</h2>
              <p style="margin: 0; font-size: 13px; opacity: 0.95;">Phnom Penh &amp; Siem Reap section of the trip.</p>
            </div>
          `;
        }
        
        const hotelOptions = getHotelsFor(d.hotelCity);
        const starLabel = hotelRatingToStars(state.traveller.hotelRating);
        const hotelText = d.hotelName || "To be advised";
        const hotelSelect = `
          <div class="day-hotel-row">
            <span style="font-size:12px;font-weight:500;">Hotel:</span>
            <div class="screen-only">
              <select data-day="${d.dayIndex}" data-field="hotelName">
                <option value="">Select hotelâ€¦</option>
                ${hotelOptions.map(h => {
                  const hotelNameOnly = getHotelNameOnly(h);
                  const isSelected = hotelNameOnly === getHotelNameOnly(d.hotelName) || h === d.hotelName;
                  return `<option value="${hotelNameOnly}" ${isSelected ? "selected" : ""}>${h}</option>`;
                }).join("")}
              </select>
              ${starLabel ? `<span class="star-rating">${starLabel}</span>` : ""}
            </div>
            <div class="print-only">
              <span style="font-size:12px;">${hotelText}${starLabel ? " â€“ " + starLabel : ""}</span>
            </div>
          </div>
        `;

        function activityBlock(day, partLabel, fieldName, optionsArr) {
          const selectOptions = optionsArr.map(o => `<option value="${o}">${o}</option>`).join("");
          const text = day[fieldName] || "";
          return `
            <div class="day-activity-row">
              <div class="day-section-title">${partLabel}</div>
              <div class="screen-only">
                <select data-day="${day.dayIndex}" data-part="${fieldName}" class="alt-activity-select">
                  <option value="">Choose alternative activityâ€¦</option>
                  ${selectOptions}
                </select>
                <div class="small-hint" style="margin:2px 0 4px;">
                  You can also type your own activity below â€“ it will be saved and printed.
                </div>
                <textarea data-day="${day.dayIndex}" data-field="${fieldName}">${text}</textarea>
              </div>
              <div class="print-only">
                <p style="margin:2px 0 0;font-size:12px;">${text || "Details to be defined."}</p>
              </div>
            </div>
          `;
        }

        const transferText = d.transfer || "";
        const transferBlock = `
          <div class="transfer-label">Transfer</div>
          <div class="transfer-box">
            <div class="screen-only">
              <textarea data-day="${d.dayIndex}" data-field="transfer"
                placeholder="Transfer between cities (flight / car / train)â€¦">${transferText}</textarea>
            </div>
            <div class="print-only">
              <p style="margin:0;font-size:12px;">${transferText || "Transfer details to be confirmed."}</p>
            </div>
          </div>
        `;

        return `${cambodiaDividerHtml}
          <div class="day-card">
            <div class="day-banner">
              <div>
                <div class="day-banner-main">${d.label} â€“ ${d.city}</div>
                <div class="day-banner-sub">
                  <span class="screen-only"><span class="location-label">Location (editable):</span> ${citySelect(d.dayIndex, d.city)}</span>
                  <span class="print-only">Location: ${d.city}</span>
                </div>
              </div>
              <div class="day-banner-date">
                ${d.date ? formatDate(d.date) : ""}
              </div>
            </div>
            <div class="day-content">
              ${hotelSelect}

              ${transferBlock}

              ${activityBlock(d, "Morning", "morning", d.morningOptions || [])}
              ${activityBlock(d, "Afternoon", "afternoon", d.afternoonOptions || [])}
              ${activityBlock(d, "Evening", "evening", d.eveningOptions || [])}

              <div class="picture-gallery-footer">
                <div style="font-size:12px;font-weight:500;margin-bottom:4px;">Day Photos</div>
                <div class="picture-gallery-container" 
                     data-day="${d.dayIndex}" 
                     data-field="pictureNotes"
                     ondrop="handleImageDrop(event, ${d.dayIndex})" 
                     ondragover="handleDragOver(event)" 
                     ondragleave="handleDragLeave(event)"
                     onclick="document.getElementById('file-input-${d.dayIndex}').click()">
                  ${renderPictureGallery(d.pictureNotes || "", d.dayIndex)}
                </div>
                <input type="file" 
                       id="file-input-${d.dayIndex}" 
                       style="display:none" 
                       accept="image/*" 
                       multiple 
                       onchange="handleFileSelect(event, ${d.dayIndex})">
              </div>
            </div>
          </div>
        `;
      }).join("");

      const internalNotesHtml = `
        <div class="internal-notes no-print">
          <h3>Internal warnings &amp; suggestions for Lona (not printed for client)</h3>
          <ul class="warning-list">
            <li>Check realistic transfer times and adjust activities if a day is too full.</li>
            <li>Verify hotel availability &amp; category according to budget and age group.</li>
            <li>For seniors / mobility issues: reduce stairs &amp; temples, add more cafÃ©/rest time.</li>
            <li>For nightlife-oriented guests: emphasise evening bars &amp; street food, keep mornings lighter.</li>
            <li>Double-check special food requirements with restaurants (especially halal / kosher style).</li>
          </ul>
          <textarea id="lonaInternalNotes"
            placeholder="Your own notes, reminders, and checks for this specific group..."></textarea>
        </div>
      `;

      cont.innerHTML = brandHeaderHtml + headerHtml + internalNotesHtml + daysHtml;
    }

    function updateDayForCity(dayIndex, newCity) {
      const day = state.daysData[dayIndex];
      if (!day) return;
      const t = state.traveller;

      day.city = newCity;
      day.hotelCity = newCity;

      const hotels = getHotelsFor(newCity);
      day.hotelName = hotels[0] || "";

      const morningOptions = getActivitiesFor(newCity, "morning");
      const afternoonOptions = getActivitiesFor(newCity, "afternoon");
      const eveningOptions = getActivitiesFor(newCity, "evening");

      day.morningOptions = morningOptions;
      day.afternoonOptions = afternoonOptions;
      day.eveningOptions = eveningOptions;

      const prevCity = dayIndex === 0 ? null : state.daysData[dayIndex - 1].city;
      day.transfer = buildTransferText(prevCity, newCity);

      const tDays = state.traveller.numDays;
      if (dayIndex === 0 && t.arrivalTime) {
        day.transfer += (day.transfer ? " " : "") + `Airport pick-up according to arrival at ${t.arrivalTime}.`;
      }
      if (dayIndex === tDays - 1 && t.departureTime) {
        day.transfer += (day.transfer ? " " : "") + `Airport drop-off according to departure at ${t.departureTime}.`;
      }

      day.morning = morningOptions[0] || "";
      day.afternoon = afternoonOptions[0] || "";
      day.evening = eveningOptions[0] || "";

      const nextDay = state.daysData[dayIndex + 1];
      if (nextDay) {
        nextDay.transfer = buildTransferText(newCity, nextDay.city);
        if (dayIndex + 1 === tDays - 1 && t.departureTime) {
          nextDay.transfer += (nextDay.transfer ? " " : "") + `Airport drop-off according to departure at ${t.departureTime}.`;
        }
      }
    }

    $("generateBtn").addEventListener("click", () => {
      collectTravellerData();
      autoFillEndDate();
      generateDaysData();
      renderItinerary();
    });

    // Event handlers for pre-defined itinerary selectors
    const briefSelect = document.getElementById("brief-itinerary-select");
    if (briefSelect) {
      briefSelect.addEventListener("change", function() {
        const days = this.value;
        if (!days) return;

        const output = document.getElementById("itineraryArea");
        const data = briefItineraries[days];

        if (!data || !data.name) {
          output.innerHTML = `
            <div class="itinerary-header">
              <h2>Brief Itinerary â€“ ${days} Days</h2>
              <p>Brief itinerary not uploaded yet for ${days} days.</p>
            </div>
          `;
          return;
        }

        const textLines = [
          data.name,
          "",
          `Duration: ${days} days`,
          `Destinations: ${data.destinations}`,
          `Starts in: ${data.startsIn}`,
          `Ends in: ${data.endsIn}`,
          "",
          data.intro,
          "",
          "<h3>Brief Itinerary:</h3>",
          ...data.days.map(day => `<p>${day}</p>`)
        ];

        output.innerHTML = `
          <header class="brand-header">
            <div class="brand-header-left">
              <img src="vht_logo.png" alt="VHT Vietnam Holiday Tours logo" class="brand-logo">
              <div class="brand-title-block">
                <div class="brand-title">VHT â€“ Vietnam Holiday Tours</div>
                <div class="brand-subtitle">Tailor-made itinerary proposal</div>
              </div>
            </div>
          </header>
          <div class="itinerary-header">
            <h2>Brief Itinerary â€“ ${days} Days</h2>
            <section class="trip-meta-card">
              <div><strong>Tour Name:</strong> ${data.name}</div>
              <div><strong>Duration:</strong> ${days} days</div>
              <div><strong>Destinations:</strong> ${data.destinations}</div>
              <div><strong>Starts in:</strong> ${data.startsIn}</div>
              <div><strong>Ends in:</strong> ${data.endsIn}</div>
              <div><strong>Tour Type:</strong> ${data.tourType}</div>
              <div><strong>Travel Style:</strong> ${data.travelStyle}</div>
            </section>
            <div style="margin-top: 16px;">
              <p><strong>Introduction:</strong></p>
              <p>${data.intro}</p>
            </div>
            <div style="margin-top: 20px;">
              <h3>Day-by-Day Itinerary:</h3>
              ${data.days.map(day => `<p style="margin: 8px 0;">${day}</p>`).join("")}
            </div>
            <div style="margin-top: 24px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
              <button class="btn btn-primary" onclick="loadItineraryIntoGenerator(briefItineraries['${days}'], false)" style="padding: 10px 20px; font-size: 14px; font-weight: 600;">
                ðŸ“‹ Load into Generator
              </button>
              <p style="margin-top: 10px; font-size: 12px; color: #666;">
                Click to auto-fill the form fields and use this route when generating your customized itinerary.
              </p>
            </div>
          </div>
        `;
      });
    }

    const detailedSelect = document.getElementById("detailed-itinerary-select");
    if (detailedSelect) {
      detailedSelect.addEventListener("change", function() {
        const days = this.value;
        if (!days) return;

        const output = document.getElementById("itineraryArea");
        const data = detailedItineraries[days];

        if (!data || !data.name) {
          output.innerHTML = `
            <div class="itinerary-header">
              <h2>Detailed Itinerary â€“ ${days} Days</h2>
              <p>Detailed itinerary not uploaded yet for ${days} days.</p>
            </div>
          `;
          return;
        }

        output.innerHTML = `
          <header class="brand-header">
            <div class="brand-header-left">
              <img src="vht_logo.png" alt="VHT Vietnam Holiday Tours logo" class="brand-logo">
              <div class="brand-title-block">
                <div class="brand-title">VHT â€“ Vietnam Holiday Tours</div>
                <div class="brand-subtitle">Tailor-made itinerary proposal</div>
              </div>
            </div>
          </header>
          <div class="itinerary-header">
            <h2>Detailed Itinerary â€“ ${days} Days</h2>
            <section class="trip-meta-card">
              <div><strong>Tour Name:</strong> ${data.name}</div>
              <div><strong>Duration:</strong> ${days} days</div>
            </section>
            <div style="margin-top: 20px;">
              ${data.days.map(d => `
                <div class="day-card" style="margin-bottom: 16px;">
                  <h3 style="margin-top: 0; margin-bottom: 8px; color: #1363df;">Day ${d.day} â€“ ${d.title}</h3>
                  <p style="margin: 0; line-height: 1.6;">${d.details || ""}</p>
                </div>
              `).join("")}
            </div>
            <div style="margin-top: 24px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
              <button class="btn btn-primary" onclick="loadItineraryIntoGenerator(detailedItineraries['${days}'], true)" style="padding: 10px 20px; font-size: 14px; font-weight: 600;">
                ðŸ“‹ Load into Generator
              </button>
              <p style="margin-top: 10px; font-size: 12px; color: #666;">
                Click to auto-fill the form fields and use this route when generating your customized itinerary.
              </p>
            </div>
          </div>
        `;
      });
    }

    $("itineraryArea").addEventListener("input", (e) => {
      const target = e.target;
      const dayIndex = parseInt(target.getAttribute("data-day"), 10);
      if (isNaN(dayIndex)) return;

      const field = target.getAttribute("data-field");
      if (!field) return;

      const day = state.daysData[dayIndex];
      if (!day) return;

      day[field] = target.value;
    });

    $("itineraryArea").addEventListener("change", (e) => {
      const target = e.target;
      
      // Handle city-select changes and save to window.itineraryState
      if (target.matches(".city-select")) {
        const dayIndex = parseInt(target.getAttribute("data-day"), 10);
        const value = target.value;
        if (window.itineraryState && window.itineraryState.days && window.itineraryState.days[dayIndex]) {
          window.itineraryState.days[dayIndex].city = value;
          window.itineraryState.days[dayIndex].hotelCity = value;
        }
        // Also update state.daysData
        const day = state.daysData[dayIndex];
        if (day) {
          updateDayForCity(dayIndex, value);
          renderItinerary();
          return;
        }
      }
      
      const dayIndex = parseInt(target.getAttribute("data-day"), 10);
      if (isNaN(dayIndex)) return;

      const field = target.getAttribute("data-field");
      const part = target.getAttribute("data-part");
      const day = state.daysData[dayIndex];
      if (!day) return;

      if (field === "hotelName") {
        day.hotelName = target.value;
        renderItinerary();
        return;
      }

      if (field === "city") {
        const newCity = target.value;
        updateDayForCity(dayIndex, newCity);
        renderItinerary();
        return;
      }

      if (part && target.classList.contains("alt-activity-select")) {
        if (target.value) {
          day[part] = target.value;
          renderItinerary();
        }
      }
    });

    $("templateUpload").addEventListener("change", (e) => {
      const file = e.target.files && e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (ev) => {
        try {
          const data = JSON.parse(ev.target.result);
          if (data.hotelsByCity) {
            Object.keys(data.hotelsByCity).forEach(city => {
              if (!HOTEL_OPTIONS[city]) HOTEL_OPTIONS[city] = [];
              HOTEL_OPTIONS[city].push(...data.hotelsByCity[city]);
            });
          }
          if (data.activitiesByCity) {
            Object.keys(data.activitiesByCity).forEach(city => {
              if (!ACTIVITIES[city]) ACTIVITIES[city] = { morning: [], afternoon: [], evening: [] };
              const parts = data.activitiesByCity[city];
              ["morning", "afternoon", "evening"].forEach(part => {
                if (parts[part]) {
                  if (!ACTIVITIES[city][part]) ACTIVITIES[city][part] = [];
                  ACTIVITIES[city][part].push(...parts[part]);
                }
              });
            });
          }
          alert("Templates uploaded successfully. Generate the itinerary again to see new options.");
        } catch (err) {
          console.error(err);
          alert("Failed to read JSON file. Please check the format.");
        }
      };
      reader.readAsText(file);
    });

    function printItinerary() {
      if (!state.daysData || !state.daysData.length) {
        alert("Please generate an itinerary first.");
        return;
      }
      window.print();
    }

    // Add event listener for print button
    const printBtn = document.getElementById("printItineraryBtn");
    if (printBtn) {
      printBtn.addEventListener("click", () => {
        printItinerary();
      });
    }

    renderItinerary();

    // ========== FLOATING SIDEBAR HELPER FOR DAYS SELECTION ==========
    (function() {
      // ðŸ‘‰ Adjust this selector if your input has a different ID / name
      const DAYS_INPUT_SELECTOR = '#numDays, [name="numDays"]';

      const helper = document.getElementById('itinerary-sidebar-helper');
      if (!helper) return; // Exit if helper doesn't exist

      const titleEl = document.getElementById('helper-title');
      const textEl = document.getElementById('helper-text');
      const tagEl = document.getElementById('helper-tag');
      const closeBtn = helper.querySelector('.helper-close');

      function findDaysInput() {
        return document.querySelector(DAYS_INPUT_SELECTOR);
      }

      function classifyDays(days) {
        if (!days || isNaN(days)) return null;
        const n = Number(days);
        if (n <= 0) return null;
        if (n <= 14) return 'short';
        if (n <= 20) return 'extended';
        return 'long';
      }

      function updateHelper(days) {
        const mode = classifyDays(days);

        if (!mode) {
          helper.style.display = 'none';
          return;
        }

        helper.style.display = 'block';

        if (mode === 'short') {
          titleEl.textContent = 'ðŸŸ© Short / Medium itinerary';
          textEl.textContent =
            '4â€“14 days: focus on one or two regions (North / Central / South), simple logistics and no rush.';
          tagEl.innerHTML = '<span>ðŸŽ¯</span><span>Good for families & quick vacations</span>';
        } else if (mode === 'extended') {
          titleEl.textContent = 'ðŸŸ§ Extended journey';
          textEl.textContent =
            '15â€“20 days: deeper Vietnam, add more cities and a mix of culture, nature and one overnight cruise.';
          tagEl.innerHTML = '<span>ðŸ§³</span><span>Use mid-length templates or split North / South</span>';
        } else {
          titleEl.textContent = 'ðŸŸ¦ Full Vietnam / Long-haul';
          textEl.textContent =
            '21â€“30 days: ideal for using your 21-day "Symphony of Vietnam" or 30-day "Full Month" templates as a base.';
          tagEl.innerHTML = '<span>ðŸ“š</span><span>Start from 21D or 30D master itinerary</span>';
        }
      }

      function initHelper() {
        const input = findDaysInput();
        if (!input) {
          // Try again after a short delay (for apps that render later)
          setTimeout(initHelper, 800);
          return;
        }

        const handler = () => updateHelper(input.value);
        input.addEventListener('input', handler);
        input.addEventListener('change', handler);

        // Initial value (if already filled)
        if (input.value) {
          updateHelper(input.value);
        }
      }

      if (closeBtn) {
        closeBtn.addEventListener('click', () => {
          helper.style.display = 'none';
        });
      }

      // Start once DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initHelper);
      } else {
        initHelper();
      }
    })();
    // ========== END SIDEBAR HELPER ==========

    // Print button listener
    document.addEventListener('DOMContentLoaded', () => {
      const printBtn = document.getElementById('printItineraryBtn');
      if (printBtn) {
        printBtn.addEventListener('click', () => {
          window.print();
        });
      }
    });
  </script>

  <!-- ========== FLOATING SIDEBAR HELPER FOR DAYS SELECTION ========== -->
  <div id="itinerary-sidebar-helper" aria-hidden="true" class="no-print">
    <button class="helper-close" title="Hide">âœ•</button>
    <h4 id="helper-title">ðŸ§­ Itinerary suggestion</h4>
    <p id="helper-text">
      Choose number of days to see a suggestion.
    </p>
    <div class="tag" id="helper-tag">
      <span>â„¹ï¸</span><span>Waiting for days inputâ€¦</span>
    </div>
  </div>
  <!-- ========== END SIDEBAR HELPER ========== -->
</body>
</html>
